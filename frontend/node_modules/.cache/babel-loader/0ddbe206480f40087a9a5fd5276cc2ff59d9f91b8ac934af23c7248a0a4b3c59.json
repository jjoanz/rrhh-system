{"ast":null,"code":"import React,{useState,useEffect}from'react';import{BarChart,Bar,XAxis,YAxis,Tooltip,Legend,ResponsiveContainer,LineChart,Line,PieChart,Pie,Cell,AreaChart,Area}from'recharts';import{Play,Download,Save,TrendingUp,Users,Building,FileText,DollarSign,Plus,Edit,Trash2,BarChart3,Activity,PieChart as PieChartIcon}from'lucide-react';import{useAuth}from'../../../context/AuthContext';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL||'http://192.168.0.239:5000/api';// Colores para gráficos\nconst CHART_COLORS=['#3B82F6','#10B981','#F59E0B','#EF4444','#8B5CF6','#EC4899','#14B8A6','#F97316'];const ReportesVisualModule=()=>{const{getStoredToken}=useAuth();const[tipoReporte,setTipoReporte]=useState('');const[configuracion,setConfiguracion]=useState({});const[data,setData]=useState([]);const[loading,setLoading]=useState(false);const[metricas,setMetricas]=useState(null);const[chartType,setChartType]=useState('bar');const[reportesGuardados,setReportesGuardados]=useState([]);const[showSaveModal,setShowSaveModal]=useState(false);const[nombreReporte,setNombreReporte]=useState('');useEffect(()=>{console.log('🔍 Estado:',{tipoReporte,configuracion});},[tipoReporte,configuracion]);// Cargar métricas y reportes guardados al inicio\nuseEffect(()=>{cargarMetricas();cargarReportesGuardados();},[]);const cargarMetricas=async()=>{try{const response=await fetch(`${API_URL}/reportes/metricas`,{headers:{Authorization:`Bearer ${getStoredToken()}`}});const result=await response.json();if(result.success){setMetricas(result.data);}}catch(error){console.error('Error cargando métricas:',error);}};const cargarReportesGuardados=async()=>{try{const response=await fetch(`${API_URL}/reportes/guardados`,{headers:{Authorization:`Bearer ${getStoredToken()}`}});if(response.ok){const data=await response.json();setReportesGuardados(Array.isArray(data)?data:[]);}}catch(error){console.error('Error cargando reportes guardados:',error);setReportesGuardados([]);}};const TIPOS_REPORTES=[{id:'empleados',nombre:'Reporte de Empleados',descripcion:'Información detallada del personal',icono:Users,color:'blue',configuraciones:[{campo:'campos',label:'Información a mostrar',tipo:'multiselect',opciones:[{value:'nombre',label:'Nombre'},{value:'apellido',label:'Apellido'},{value:'email',label:'Email'},{value:'cargo',label:'Cargo'},{value:'salario',label:'Salario'},{value:'fechaIngreso',label:'Fecha de Ingreso'},{value:'departamento',label:'Departamento'},{value:'estado',label:'Estado'},{value:'cedula',label:'Cédula'}],default:['nombre','apellido','cargo','departamento']},{campo:'filtros.estado',label:'Estado del empleado',tipo:'select',opciones:[{value:'todos',label:'Todos'},{value:'activo',label:'Solo Activos'},{value:'inactivo',label:'Solo Inactivos'}],default:'activo'},{campo:'filtros.departamentoId',label:'Departamento',tipo:'select-departamentos',default:null},{campo:'ordenamiento.campo',label:'Ordenar por',tipo:'select',opciones:[{value:'nombre',label:'Nombre'},{value:'apellido',label:'Apellido'},{value:'fechaIngreso',label:'Fecha de Ingreso'},{value:'salario',label:'Salario'}],default:'nombre'},{campo:'ordenamiento.direccion',label:'Dirección',tipo:'select',opciones:[{value:'ASC',label:'Ascendente'},{value:'DESC',label:'Descendente'}],default:'ASC'}]},{id:'departamentos',nombre:'Reporte de Departamentos',descripcion:'Análisis por departamento',icono:Building,color:'green',configuraciones:[{campo:'incluirEstadisticas',label:'¿Incluir estadísticas de empleados?',tipo:'checkbox',default:true}]},{id:'vacantes',nombre:'Reporte de Vacantes',descripcion:'Estado de vacantes y postulaciones',icono:FileText,color:'purple',configuraciones:[{campo:'estado',label:'Estado de vacantes',tipo:'select',opciones:[{value:'Todas',label:'Todas'},{value:'Abierta',label:'Solo Abiertas'},{value:'Cerrada',label:'Solo Cerradas'}],default:'Abierta'},{campo:'incluirPostulaciones',label:'¿Incluir estadísticas de postulaciones?',tipo:'checkbox',default:true}]},{id:'nomina',nombre:'Reporte de Nómina',descripcion:'Severance, salarios y aumentos',icono:DollarSign,color:'orange',configuraciones:[{campo:'tipo',label:'Tipo de reporte',tipo:'select',opciones:[{value:'severance',label:'Cálculo de Severance'},{value:'salarios',label:'Análisis de Salarios'}],default:'severance'},{campo:'departamentoId',label:'Departamento',tipo:'select-departamentos',default:null}]},{id:'vacaciones',nombre:'Reportes de Vacaciones',descripcion:'Balance, próximos aniversarios y análisis de vacaciones',icono:FileText,color:'teal',configuraciones:[{campo:'tipoVacaciones',// ✅ IMPORTANTE: este campo\nlabel:'Tipo de reporte de vacaciones',tipo:'select',opciones:[{value:'balance_general',label:'Balance General de Vacaciones'},{value:'proximos_aniversarios',label:'Próximos Aniversarios (30 días)'},{value:'pendientes_disfrutar',label:'Vacaciones Pendientes por Disfrutar'},{value:'por_direccion',label:'Balance por Dirección'},{value:'por_departamento',label:'Balance por Departamento'},{value:'estadisticas',label:'Estadísticas Generales'},{value:'empleados_sin_balance',label:'Empleados Sin Balance'}],default:'balance_general'},{campo:'periodo',label:'Periodo de consulta',tipo:'select',opciones:[{value:'2024-2025',label:'Periodo 2024-2025 (Actual)'},{value:'2023-2024',label:'Periodo 2023-2024'},{value:'2022-2023',label:'Periodo 2022-2023'},{value:'2025-2026',label:'Periodo 2025-2026 (Próximo)'},{value:'todos',label:'Todos los periodos'}],default:'2024-2025'},{campo:'direccionId',label:'Filtrar por Dirección',tipo:'select-direcciones',default:null},{campo:'departamentoId',label:'Filtrar por Departamento',tipo:'select-departamentos',default:null},{campo:'minimosDiasPendientes',label:'Mínimo de días pendientes',tipo:'number',default:0,min:0},{campo:'ordenamiento',label:'Ordenar por',tipo:'select',opciones:[{value:'nombre',label:'Nombre'},{value:'diasPendientes',label:'Días Pendientes'},{value:'diasTotales',label:'Días Totales'},{value:'antiguedad',label:'Años de Antigüedad'}],default:'diasPendientes'}]}];const ejecutarReporte=async()=>{if(!tipoReporte){alert('Selecciona un tipo de reporte');return;}setLoading(true);try{// ✅ Construir payload correcto\nlet payload={...configuracion};// ✅ Si es vacaciones, construir payload específico\nif(tipoReporte==='vacaciones'){payload={tipoVacaciones:configuracion.tipoVacaciones||'balance_general',periodo:configuracion.periodo||'2024-2025',direccionId:configuracion.direccionId||null,departamentoId:configuracion.departamentoId||null,minimosDiasPendientes:configuracion.minimosDiasPendientes||0,ordenamiento:configuracion.ordenamiento||'diasPendientes'};}console.log('📤 Payload:',payload);const response=await fetch(`${API_URL}/reportes/${tipoReporte}`,{method:'POST',headers:{'Content-Type':'application/json',Authorization:`Bearer ${getStoredToken()}`},body:JSON.stringify(payload)});const result=await response.json();console.log('📥 Respuesta:',result);if(result.success){let datosLimpios=Array.isArray(result.data)?result.data:[];// ✅ Limpiar datos de vacaciones\nif(tipoReporte==='vacaciones'){datosLimpios=datosLimpios.map(item=>{const itemLimpio={...item};// Quitar $\nObject.keys(itemLimpio).forEach(key=>{if(typeof itemLimpio[key]==='string'&&itemLimpio[key].startsWith('$')){itemLimpio[key]=itemLimpio[key].replace('$','').trim();}});// Anios → Años\nif(itemLimpio['Anios Antiguedad']){itemLimpio['Años Antigüedad']=itemLimpio['Anios Antiguedad'];delete itemLimpio['Anios Antiguedad'];}return itemLimpio;});}setData(datosLimpios);}else{alert('Error: '+(result.error||'Error desconocido'));setData([]);}}catch(error){console.error('❌ Error:',error);alert('Error ejecutando reporte');setData([]);}finally{setLoading(false);}};const exportarReporte=async formato=>{if(!Array.isArray(data)||data.length===0){alert('No hay datos para exportar');return;}try{const response=await fetch(`${API_URL}/reportes/export`,{method:'POST',headers:{'Content-Type':'application/json',Authorization:`Bearer ${getStoredToken()}`},body:JSON.stringify({formato,data,nombre:`reporte_${tipoReporte}_${new Date().toISOString().split('T')[0]}`})});if(!response.ok){const errorText=await response.text();console.error('Error en exportación:',errorText);alert('Error al exportar el reporte');return;}const blob=await response.blob();const url=window.URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;const extensiones={'excel':'xlsx','csv':'csv','pdf':'pdf'};a.download=`reporte_${tipoReporte}_${new Date().toISOString().split('T')[0]}.${extensiones[formato]||formato}`;document.body.appendChild(a);a.click();document.body.removeChild(a);window.URL.revokeObjectURL(url);}catch(error){console.error('Error exportando:',error);alert('Error al exportar');}};const guardarReporte=async()=>{if(!nombreReporte.trim()){alert('Por favor ingresa un nombre para el reporte');return;}try{const response=await fetch(`${API_URL}/reportes/guardados`,{method:'POST',headers:{'Content-Type':'application/json',Authorization:`Bearer ${getStoredToken()}`},body:JSON.stringify({nombre:nombreReporte,origen:'personalizado',descripcion:`Reporte de ${tipoReporte}`,configuracion:{tipo:tipoReporte,config:configuracion}})});if(response.ok){alert('Reporte guardado exitosamente');setShowSaveModal(false);setNombreReporte('');cargarReportesGuardados();}else{alert('Error guardando reporte');}}catch(error){console.error('Error:',error);alert('Error al guardar reporte');}};const cargarReporteGuardado=reporte=>{if(reporte.configuracion&&reporte.configuracion.tipo){setTipoReporte(reporte.configuracion.tipo);setConfiguracion(reporte.configuracion.config||{});}};const eliminarReporteGuardado=async id=>{if(!window.confirm('¿Estás seguro de eliminar este reporte?'))return;try{const response=await fetch(`${API_URL}/reportes/guardados/${id}`,{method:'DELETE',headers:{Authorization:`Bearer ${getStoredToken()}`}});if(response.ok){alert('Reporte eliminado');cargarReportesGuardados();}}catch(error){console.error('Error:',error);}};const reporteSeleccionado=TIPOS_REPORTES.find(r=>r.id===tipoReporte);function obtenerValorConfig(config,campo){const campos=campo.split('.');let valor=config;for(const c of campos){var _valor;valor=(_valor=valor)===null||_valor===void 0?void 0:_valor[c];}return valor;}function actualizarConfiguracion(campo,valor){const campos=campo.split('.');const nuevaConfig={...configuracion};let ref=nuevaConfig;for(let i=0;i<campos.length-1;i++){if(!ref[campos[i]])ref[campos[i]]={};ref=ref[campos[i]];}ref[campos[campos.length-1]]=valor;setConfiguracion(nuevaConfig);}function formatearNombreColumna(nombre){return nombre.replace(/([A-Z])/g,' $1').replace(/_/g,' ').replace(/^./,str=>str.toUpperCase()).trim();}function formatearValor(key,value){if(value===null||value===undefined)return'-';if(key.toLowerCase().includes('fecha')&&value){return new Date(value).toLocaleDateString('es-DO');}if(key.toLowerCase().includes('salario')||key.toLowerCase().includes('preaviso')||key.toLowerCase().includes('cesantia')||key.toLowerCase().includes('vacaciones')||key.toLowerCase().includes('regalia')||key.toLowerCase().includes('total')||key.toLowerCase().includes('promedio')||key.toLowerCase().includes('maximo')||key.toLowerCase().includes('minimo')||key.toLowerCase().includes('masa')){return`$${parseFloat(value).toLocaleString('es-DO',{minimumFractionDigits:2,maximumFractionDigits:2})}`;}if(typeof value==='number'){return value.toLocaleString('es-DO');}return value;}return/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 max-w-7xl mx-auto bg-gray-50 min-h-screen\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-800 mb-2\",children:\"\\uD83D\\uDCCA Reportes RRHH\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Sistema de reporter\\xEDa visual profesional\"})]}),metricas&&/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-xl shadow-sm p-6 border-l-4 border-blue-500\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 text-sm\",children:\"Total Empleados\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold text-gray-900\",children:metricas.totalEmpleados||0})]}),/*#__PURE__*/_jsx(Users,{className:\"w-12 h-12 text-blue-500 opacity-20\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-xl shadow-sm p-6 border-l-4 border-green-500\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 text-sm\",children:\"Contrataciones (30d)\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold text-gray-900\",children:metricas.contratacionesUltimos30Dias||0})]}),/*#__PURE__*/_jsx(TrendingUp,{className:\"w-12 h-12 text-green-500 opacity-20\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-xl shadow-sm p-6 border-l-4 border-purple-500\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 text-sm\",children:\"Salario Promedio\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-3xl font-bold text-gray-900\",children:[\"$\",(metricas.salarioPromedio||0).toLocaleString()]})]}),/*#__PURE__*/_jsx(DollarSign,{className:\"w-12 h-12 text-purple-500 opacity-20\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-xl shadow-sm p-6 border-l-4 border-orange-500\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 text-sm\",children:\"Vacantes Abiertas\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold text-gray-900\",children:metricas.vacantesAbiertas||0})]}),/*#__PURE__*/_jsx(FileText,{className:\"w-12 h-12 text-orange-500 opacity-20\"})]})})]}),Array.isArray(reportesGuardados)&&reportesGuardados.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-sm p-6 mb-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold mb-4\",children:\"\\uD83D\\uDCC1 Mis Reportes Guardados\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4\",children:reportesGuardados.map(reporte=>/*#__PURE__*/_jsxs(\"div\",{className:\"border rounded-lg p-4 hover:shadow-md transition-shadow\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-2\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-gray-900\",children:reporte.nombre}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>eliminarReporteGuardado(reporte.id),className:\"text-red-500 hover:text-red-700\",children:/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4\"})})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-3\",children:reporte.descripcion}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>cargarReporteGuardado(reporte),className:\"text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Play,{className:\"w-4 h-4\"}),\"Cargar Reporte\"]})]},reporte.id))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-sm p-6 mb-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold mb-4 text-gray-800\",children:\"Selecciona el tipo de reporte\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\",children:TIPOS_REPORTES.map(tipo=>{const Icon=tipo.icono;const isSelected=tipoReporte===tipo.id;return/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setTipoReporte(tipo.id);setConfiguracion({});setData([]);},className:`p-6 rounded-xl border-2 transition-all text-left ${isSelected?'border-blue-500 bg-blue-50 shadow-lg':'border-gray-200 hover:border-gray-300 hover:shadow-md'}`,children:[/*#__PURE__*/_jsx(Icon,{className:`w-10 h-10 mb-3 ${isSelected?'text-blue-600':'text-gray-400'}`}),/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-gray-900 mb-1\",children:tipo.nombre}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:tipo.descripcion})]},tipo.id);})})]}),reporteSeleccionado&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-sm p-6 mb-6\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-xl font-semibold mb-4 text-gray-800\",children:[\"Configurar \",reporteSeleccionado.nombre]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:reporteSeleccionado.configuraciones.map((config,index)=>/*#__PURE__*/_jsx(ConfiguracionCampo,{config:config,valor:obtenerValorConfig(configuracion,config.campo),onChange:valor=>actualizarConfiguracion(config.campo,valor)},index))}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 mt-6 pt-6 border-t\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:ejecutarReporte,disabled:loading,className:\"flex-1 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-all flex items-center justify-center gap-2 font-medium shadow-lg\",children:[/*#__PURE__*/_jsx(Play,{className:\"w-5 h-5\"}),loading?'Generando...':'Generar Reporte']}),Array.isArray(data)&&data.length>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowSaveModal(true),className:\"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-all flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Save,{className:\"w-5 h-5\"}),\"Guardar\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>exportarReporte('excel'),className:\"bg-emerald-600 text-white px-6 py-3 rounded-lg hover:bg-emerald-700 transition-all flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Download,{className:\"w-5 h-5\"}),\"Excel\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>exportarReporte('pdf'),className:\"bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700 transition-all flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Download,{className:\"w-5 h-5\"}),\"PDF\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>exportarReporte('csv'),className:\"bg-orange-600 text-white px-6 py-3 rounded-lg hover:bg-orange-700 transition-all flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Download,{className:\"w-5 h-5\"}),\"CSV\"]})]})]})]}),Array.isArray(data)&&data.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-sm overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-r from-blue-600 to-purple-600 px-6 py-4\",children:/*#__PURE__*/_jsxs(\"h3\",{className:\"text-white font-semibold flex items-center gap-2\",children:[\"\\uD83D\\uDCCA Resultados (\",data.length,\" registros)\"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[data.length>0&&Object.keys(data[0]).length>=2&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4 mb-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-gray-700\",children:\"Tipo de gr\\xE1fico:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setChartType('bar'),className:`px-4 py-2 rounded-lg flex items-center gap-2 transition-all ${chartType==='bar'?'bg-blue-600 text-white shadow-md':'bg-gray-100 text-gray-600 hover:bg-gray-200'}`,children:[/*#__PURE__*/_jsx(BarChart3,{className:\"w-4 h-4\"}),\"Barras\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setChartType('line'),className:`px-4 py-2 rounded-lg flex items-center gap-2 transition-all ${chartType==='line'?'bg-blue-600 text-white shadow-md':'bg-gray-100 text-gray-600 hover:bg-gray-200'}`,children:[/*#__PURE__*/_jsx(Activity,{className:\"w-4 h-4\"}),\"L\\xEDneas\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setChartType('pie'),className:`px-4 py-2 rounded-lg flex items-center gap-2 transition-all ${chartType==='pie'?'bg-blue-600 text-white shadow-md':'bg-gray-100 text-gray-600 hover:bg-gray-200'}`,children:[/*#__PURE__*/_jsx(PieChartIcon,{className:\"w-4 h-4\"}),\"Circular\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setChartType('area'),className:`px-4 py-2 rounded-lg flex items-center gap-2 transition-all ${chartType==='area'?'bg-blue-600 text-white shadow-md':'bg-gray-100 text-gray-600 hover:bg-gray-200'}`,children:[/*#__PURE__*/_jsx(TrendingUp,{className:\"w-4 h-4\"}),\"\\xC1rea\"]})]})]}),/*#__PURE__*/_jsx(GraficoRenderer,{tipo:chartType,data:data})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"overflow-x-auto\",children:[/*#__PURE__*/_jsxs(\"table\",{className:\"w-full border-collapse\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsx(\"tr\",{className:\"bg-gray-50\",children:Object.keys(data[0]||{}).map(key=>/*#__PURE__*/_jsx(\"th\",{className:\"border-b-2 border-gray-200 px-4 py-3 text-left text-sm font-semibold text-gray-700\",children:formatearNombreColumna(key)},key))})}),/*#__PURE__*/_jsx(\"tbody\",{children:data.slice(0,100).map((row,index)=>/*#__PURE__*/_jsx(\"tr\",{className:\"hover:bg-gray-50 transition-colors\",children:Object.entries(row).map((_ref,cellIndex)=>{let[key,value]=_ref;return/*#__PURE__*/_jsx(\"td\",{className:\"border-b border-gray-100 px-4 py-3 text-sm text-gray-900\",children:formatearValor(key,value)},cellIndex);})},index))})]}),data.length>100&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500 mt-3 text-center\",children:[\"Mostrando primeros 100 de \",data.length,\" registros\"]})]})]})]}),showSaveModal&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 w-96 shadow-2xl\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold mb-4\",children:\"Guardar Reporte\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:nombreReporte,onChange:e=>setNombreReporte(e.target.value),placeholder:\"Nombre del reporte\",className:\"w-full border-2 border-gray-300 rounded-lg px-4 py-3 mb-4 focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowSaveModal(false),className:\"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400\",children:\"Cancelar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:guardarReporte,className:\"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700\",children:\"Guardar\"})]})]})})]});};// Componente auxiliar para select de direcciones\nconst SelectDirecciones=_ref2=>{let{valor,onChange,config}=_ref2;const[direcciones,setDirecciones]=useState([]);const{getStoredToken}=useAuth();useEffect(()=>{cargarDirecciones();},[]);const cargarDirecciones=async()=>{try{const response=await fetch(`${API_URL}/direcciones`,{headers:{Authorization:`Bearer ${getStoredToken()}`}});const data=await response.json();setDirecciones(Array.isArray(data)?data:[]);}catch(error){console.error('Error cargando direcciones:',error);setDirecciones([]);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-medium text-gray-700 mb-2\",children:config.label}),/*#__PURE__*/_jsxs(\"select\",{value:valor||'',onChange:e=>onChange(e.target.value||null),className:\"w-full border-2 border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Todas las direcciones\"}),direcciones.map(dir=>/*#__PURE__*/_jsx(\"option\",{value:dir.DireccionID,children:dir.Nombre},dir.DireccionID))]})]});};// Componente de Configuración de Campos\nconst ConfiguracionCampo=_ref3=>{let{config,valor,onChange}=_ref3;const[departamentos,setDepartamentos]=useState([]);const{getStoredToken}=useAuth();useEffect(()=>{if(config.tipo==='select-departamentos'){cargarDepartamentos();}},[config.tipo]);const cargarDepartamentos=async()=>{try{const response=await fetch(`${API_URL}/departamentos`,{headers:{Authorization:`Bearer ${getStoredToken()}`}});const data=await response.json();setDepartamentos(Array.isArray(data)?data:[]);}catch(error){console.error('Error cargando departamentos:',error);setDepartamentos([]);}};if(config.tipo==='multiselect'){const valoresSeleccionados=valor||config.default||[];return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-medium text-gray-700 mb-3\",children:config.label}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 md:grid-cols-3 gap-3\",children:config.opciones.map(opcion=>{const isSelected=valoresSeleccionados.includes(opcion.value);return/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const nuevosValores=isSelected?valoresSeleccionados.filter(v=>v!==opcion.value):[...valoresSeleccionados,opcion.value];onChange(nuevosValores);},className:`p-3 rounded-lg border-2 text-sm text-left transition-all ${isSelected?'border-blue-500 bg-blue-50 text-blue-700':'border-gray-200 hover:border-blue-300 text-gray-700'}`,children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{children:opcion.label}),isSelected&&/*#__PURE__*/_jsx(\"span\",{className:\"text-blue-600 font-bold\",children:\"\\u2713\"})]})},opcion.value);})}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-500 mt-2\",children:[valoresSeleccionados.length,\" seleccionado(s)\"]})]});}if(config.tipo==='select'){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-medium text-gray-700 mb-2\",children:config.label}),/*#__PURE__*/_jsx(\"select\",{value:valor||config.default,onChange:e=>onChange(e.target.value),className:\"w-full border-2 border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500\",children:config.opciones.map(opcion=>/*#__PURE__*/_jsx(\"option\",{value:opcion.value,children:opcion.label},opcion.value))})]});}if(config.tipo==='select-departamentos'){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-medium text-gray-700 mb-2\",children:config.label}),/*#__PURE__*/_jsxs(\"select\",{value:valor||'',onChange:e=>onChange(e.target.value||null),className:\"w-full border-2 border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Todos los departamentos\"}),departamentos.map(dept=>/*#__PURE__*/_jsx(\"option\",{value:dept.DepartamentoID,children:dept.Nombre},dept.DepartamentoID))]})]});}// ============================================\n// REEMPLAZAR EL BLOQUE select-direcciones\n// Busca la línea 915 donde pusiste el código\n// REEMPLAZA TODO el bloque por este:\n// ============================================\nif(config.tipo==='select-direcciones'){// ✅ SOLUCIÓN: Mover los hooks FUERA del if\nreturn/*#__PURE__*/_jsx(SelectDirecciones,{valor:valor,onChange:onChange,config:config});}// ============================================\n// AGREGAR ESTE NUEVO COMPONENTE\n// Después del componente ConfiguracionCampo\n// Justo antes de GraficoRenderer\n// ============================================\nif(config.tipo==='number'){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-medium text-gray-700 mb-2\",children:config.label}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:valor!==undefined?valor:config.default,onChange:e=>onChange(parseInt(e.target.value)||0),min:config.min||0,max:config.max,className:\"w-full border-2 border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"})]});}if(config.tipo==='checkbox'){return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:valor!==undefined?valor:config.default,onChange:e=>onChange(e.target.checked),className:\"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"}),/*#__PURE__*/_jsx(\"label\",{className:\"ml-3 font-medium text-gray-700\",children:config.label})]});}if(config.tipo==='date'){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-medium text-gray-700 mb-2\",children:config.label}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:valor||config.default||'',onChange:e=>onChange(e.target.value),className:\"w-full border-2 border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"})]});}return null;};// Componente Renderizador de Gráficos\nconst GraficoRenderer=_ref4=>{let{tipo,data}=_ref4;if(!Array.isArray(data)||data.length===0)return null;const keys=Object.keys(data[0]);if(keys.length<2)return null;const xKey=keys[0];const yKey=keys[1];// Limitar datos para mejor visualización\nconst chartData=data.slice(0,15);if(tipo==='bar'){return/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 p-6 rounded-lg\",children:/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:400,children:/*#__PURE__*/_jsxs(BarChart,{data:chartData,children:[/*#__PURE__*/_jsx(XAxis,{dataKey:xKey,angle:-45,textAnchor:\"end\",height:100,style:{fontSize:'12px'}}),/*#__PURE__*/_jsx(YAxis,{style:{fontSize:'12px'}}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Legend,{}),/*#__PURE__*/_jsx(Bar,{dataKey:yKey,fill:\"#3B82F6\",radius:[8,8,0,0]})]})})});}if(tipo==='line'){return/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 p-6 rounded-lg\",children:/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:400,children:/*#__PURE__*/_jsxs(LineChart,{data:chartData,children:[/*#__PURE__*/_jsx(XAxis,{dataKey:xKey,angle:-45,textAnchor:\"end\",height:100,style:{fontSize:'12px'}}),/*#__PURE__*/_jsx(YAxis,{style:{fontSize:'12px'}}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Legend,{}),/*#__PURE__*/_jsx(Line,{type:\"monotone\",dataKey:yKey,stroke:\"#3B82F6\",strokeWidth:3,dot:{fill:'#3B82F6',r:5},activeDot:{r:8}})]})})});}if(tipo==='pie'){return/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 p-6 rounded-lg\",children:/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:400,children:/*#__PURE__*/_jsxs(PieChart,{children:[/*#__PURE__*/_jsx(Pie,{data:chartData,dataKey:yKey,nameKey:xKey,cx:\"50%\",cy:\"50%\",outerRadius:120,label:_ref5=>{let{name,percent}=_ref5;return`${name}: ${(percent*100).toFixed(0)}%`;},labelLine:true,children:chartData.map((entry,index)=>/*#__PURE__*/_jsx(Cell,{fill:CHART_COLORS[index%CHART_COLORS.length]},`cell-${index}`))}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Legend,{})]})})});}if(tipo==='area'){return/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 p-6 rounded-lg\",children:/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:400,children:/*#__PURE__*/_jsxs(AreaChart,{data:chartData,children:[/*#__PURE__*/_jsx(XAxis,{dataKey:xKey,angle:-45,textAnchor:\"end\",height:100,style:{fontSize:'12px'}}),/*#__PURE__*/_jsx(YAxis,{style:{fontSize:'12px'}}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Legend,{}),/*#__PURE__*/_jsx(Area,{type:\"monotone\",dataKey:yKey,stroke:\"#3B82F6\",fill:\"#3B82F6\",fillOpacity:0.6,strokeWidth:2})]})})});}return null;};export default ReportesVisualModule;","map":{"version":3,"names":["React","useState","useEffect","BarChart","Bar","XAxis","YAxis","Tooltip","Legend","ResponsiveContainer","LineChart","Line","PieChart","Pie","Cell","AreaChart","Area","Play","Download","Save","TrendingUp","Users","Building","FileText","DollarSign","Plus","Edit","Trash2","BarChart3","Activity","PieChartIcon","useAuth","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","API_URL","process","env","REACT_APP_API_URL","CHART_COLORS","ReportesVisualModule","getStoredToken","tipoReporte","setTipoReporte","configuracion","setConfiguracion","data","setData","loading","setLoading","metricas","setMetricas","chartType","setChartType","reportesGuardados","setReportesGuardados","showSaveModal","setShowSaveModal","nombreReporte","setNombreReporte","console","log","cargarMetricas","cargarReportesGuardados","response","fetch","headers","Authorization","result","json","success","error","ok","Array","isArray","TIPOS_REPORTES","id","nombre","descripcion","icono","color","configuraciones","campo","label","tipo","opciones","value","default","min","ejecutarReporte","alert","payload","tipoVacaciones","periodo","direccionId","departamentoId","minimosDiasPendientes","ordenamiento","method","body","JSON","stringify","datosLimpios","map","item","itemLimpio","Object","keys","forEach","key","startsWith","replace","trim","exportarReporte","formato","length","Date","toISOString","split","errorText","text","blob","url","window","URL","createObjectURL","a","document","createElement","href","extensiones","download","appendChild","click","removeChild","revokeObjectURL","guardarReporte","origen","config","cargarReporteGuardado","reporte","eliminarReporteGuardado","confirm","reporteSeleccionado","find","r","obtenerValorConfig","campos","valor","c","_valor","actualizarConfiguracion","nuevaConfig","ref","i","formatearNombreColumna","str","toUpperCase","formatearValor","undefined","toLowerCase","includes","toLocaleDateString","parseFloat","toLocaleString","minimumFractionDigits","maximumFractionDigits","className","children","totalEmpleados","contratacionesUltimos30Dias","salarioPromedio","vacantesAbiertas","onClick","Icon","isSelected","index","ConfiguracionCampo","onChange","disabled","GraficoRenderer","slice","row","entries","_ref","cellIndex","type","e","target","placeholder","SelectDirecciones","_ref2","direcciones","setDirecciones","cargarDirecciones","dir","DireccionID","Nombre","_ref3","departamentos","setDepartamentos","cargarDepartamentos","valoresSeleccionados","opcion","nuevosValores","filter","v","dept","DepartamentoID","parseInt","max","checked","_ref4","xKey","yKey","chartData","width","height","dataKey","angle","textAnchor","style","fontSize","fill","radius","stroke","strokeWidth","dot","activeDot","nameKey","cx","cy","outerRadius","_ref5","name","percent","toFixed","labelLine","entry","fillOpacity"],"sources":["C:/Users/josemontedeoca/rrhh-system/frontend/src/components/modules/Reportes/ReportesModule.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { \r\n  BarChart, \r\n  Bar, \r\n  XAxis, \r\n  YAxis, \r\n  Tooltip, \r\n  Legend, \r\n  ResponsiveContainer,\r\n  LineChart,\r\n  Line,\r\n  PieChart,\r\n  Pie,\r\n  Cell,\r\n  AreaChart,\r\n  Area\r\n} from 'recharts';\r\nimport { \r\n  Play, \r\n  Download, \r\n  Save, \r\n  TrendingUp, \r\n  Users, \r\n  Building, \r\n  FileText, \r\n  DollarSign,\r\n  Plus,\r\n  Edit,\r\n  Trash2,\r\n  BarChart3,\r\n  Activity,\r\n  PieChart as PieChartIcon\r\n} from 'lucide-react';\r\nimport { useAuth } from '../../../context/AuthContext';\r\n\r\nconst API_URL = process.env.REACT_APP_API_URL || 'http://192.168.0.239:5000/api';\r\n\r\n// Colores para gráficos\r\nconst CHART_COLORS = ['#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6', '#EC4899', '#14B8A6', '#F97316'];\r\n\r\nconst ReportesVisualModule = () => {\r\n  const { getStoredToken } = useAuth();\r\n  \r\n  const [tipoReporte, setTipoReporte] = useState('');\r\n  const [configuracion, setConfiguracion] = useState({});\r\n  const [data, setData] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [metricas, setMetricas] = useState(null);\r\n  const [chartType, setChartType] = useState('bar');\r\n  const [reportesGuardados, setReportesGuardados] = useState([]);\r\n  const [showSaveModal, setShowSaveModal] = useState(false);\r\n  const [nombreReporte, setNombreReporte] = useState('');\r\n\r\n  useEffect(() => {\r\n    console.log('🔍 Estado:', { tipoReporte, configuracion });\r\n  }, [tipoReporte, configuracion]);\r\n\r\n\r\n  // Cargar métricas y reportes guardados al inicio\r\n  useEffect(() => {\r\n    cargarMetricas();\r\n    cargarReportesGuardados();\r\n  }, []);\r\n\r\n  const cargarMetricas = async () => {\r\n    try {\r\n      const response = await fetch(`${API_URL}/reportes/metricas`, {\r\n        headers: { Authorization: `Bearer ${getStoredToken()}` }\r\n      });\r\n      const result = await response.json();\r\n      if (result.success) {\r\n        setMetricas(result.data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error cargando métricas:', error);\r\n    }\r\n  };\r\n\r\n  const cargarReportesGuardados = async () => {\r\n    try {\r\n      const response = await fetch(`${API_URL}/reportes/guardados`, {\r\n        headers: { Authorization: `Bearer ${getStoredToken()}` }\r\n      });\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setReportesGuardados(Array.isArray(data) ? data : []);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error cargando reportes guardados:', error);\r\n      setReportesGuardados([]);\r\n    }\r\n  };\r\n\r\n  const TIPOS_REPORTES = [\r\n    {\r\n      id: 'empleados',\r\n      nombre: 'Reporte de Empleados',\r\n      descripcion: 'Información detallada del personal',\r\n      icono: Users,\r\n      color: 'blue',\r\n      configuraciones: [\r\n        {\r\n          campo: 'campos',\r\n          label: 'Información a mostrar',\r\n          tipo: 'multiselect',\r\n          opciones: [\r\n            { value: 'nombre', label: 'Nombre' },\r\n            { value: 'apellido', label: 'Apellido' },\r\n            { value: 'email', label: 'Email' },\r\n            { value: 'cargo', label: 'Cargo' },\r\n            { value: 'salario', label: 'Salario' },\r\n            { value: 'fechaIngreso', label: 'Fecha de Ingreso' },\r\n            { value: 'departamento', label: 'Departamento' },\r\n            { value: 'estado', label: 'Estado' },\r\n            { value: 'cedula', label: 'Cédula' }\r\n          ],\r\n          default: ['nombre', 'apellido', 'cargo', 'departamento']\r\n        },\r\n        {\r\n          campo: 'filtros.estado',\r\n          label: 'Estado del empleado',\r\n          tipo: 'select',\r\n          opciones: [\r\n            { value: 'todos', label: 'Todos' },\r\n            { value: 'activo', label: 'Solo Activos' },\r\n            { value: 'inactivo', label: 'Solo Inactivos' }\r\n          ],\r\n          default: 'activo'\r\n        },\r\n        {\r\n          campo: 'filtros.departamentoId',\r\n          label: 'Departamento',\r\n          tipo: 'select-departamentos',\r\n          default: null\r\n        },\r\n        {\r\n          campo: 'ordenamiento.campo',\r\n          label: 'Ordenar por',\r\n          tipo: 'select',\r\n          opciones: [\r\n            { value: 'nombre', label: 'Nombre' },\r\n            { value: 'apellido', label: 'Apellido' },\r\n            { value: 'fechaIngreso', label: 'Fecha de Ingreso' },\r\n            { value: 'salario', label: 'Salario' }\r\n          ],\r\n          default: 'nombre'\r\n        },\r\n        {\r\n          campo: 'ordenamiento.direccion',\r\n          label: 'Dirección',\r\n          tipo: 'select',\r\n          opciones: [\r\n            { value: 'ASC', label: 'Ascendente' },\r\n            { value: 'DESC', label: 'Descendente' }\r\n          ],\r\n          default: 'ASC'\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: 'departamentos',\r\n      nombre: 'Reporte de Departamentos',\r\n      descripcion: 'Análisis por departamento',\r\n      icono: Building,\r\n      color: 'green',\r\n      configuraciones: [\r\n        {\r\n          campo: 'incluirEstadisticas',\r\n          label: '¿Incluir estadísticas de empleados?',\r\n          tipo: 'checkbox',\r\n          default: true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: 'vacantes',\r\n      nombre: 'Reporte de Vacantes',\r\n      descripcion: 'Estado de vacantes y postulaciones',\r\n      icono: FileText,\r\n      color: 'purple',\r\n      configuraciones: [\r\n        {\r\n          campo: 'estado',\r\n          label: 'Estado de vacantes',\r\n          tipo: 'select',\r\n          opciones: [\r\n            { value: 'Todas', label: 'Todas' },\r\n            { value: 'Abierta', label: 'Solo Abiertas' },\r\n            { value: 'Cerrada', label: 'Solo Cerradas' }\r\n          ],\r\n          default: 'Abierta'\r\n        },\r\n        {\r\n          campo: 'incluirPostulaciones',\r\n          label: '¿Incluir estadísticas de postulaciones?',\r\n          tipo: 'checkbox',\r\n          default: true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: 'nomina',\r\n      nombre: 'Reporte de Nómina',\r\n      descripcion: 'Severance, salarios y aumentos',\r\n      icono: DollarSign,\r\n      color: 'orange',\r\n      configuraciones: [\r\n        {\r\n          campo: 'tipo',\r\n          label: 'Tipo de reporte',\r\n          tipo: 'select',\r\n          opciones: [\r\n            { value: 'severance', label: 'Cálculo de Severance' },\r\n            { value: 'salarios', label: 'Análisis de Salarios' }\r\n          ],\r\n          default: 'severance'\r\n        },\r\n        {\r\n          campo: 'departamentoId',\r\n          label: 'Departamento',\r\n          tipo: 'select-departamentos',\r\n          default: null\r\n        }\r\n      ]\r\n    },\r\n\r\n    {\r\n      id: 'vacaciones',\r\n      nombre: 'Reportes de Vacaciones',\r\n      descripcion: 'Balance, próximos aniversarios y análisis de vacaciones',\r\n      icono: FileText,\r\n      color: 'teal',\r\n      configuraciones: [\r\n        {\r\n          campo: 'tipoVacaciones',  // ✅ IMPORTANTE: este campo\r\n          label: 'Tipo de reporte de vacaciones',\r\n          tipo: 'select',\r\n          opciones: [\r\n            { value: 'balance_general', label: 'Balance General de Vacaciones' },\r\n            { value: 'proximos_aniversarios', label: 'Próximos Aniversarios (30 días)' },\r\n            { value: 'pendientes_disfrutar', label: 'Vacaciones Pendientes por Disfrutar' },\r\n            { value: 'por_direccion', label: 'Balance por Dirección' },\r\n            { value: 'por_departamento', label: 'Balance por Departamento' },\r\n            { value: 'estadisticas', label: 'Estadísticas Generales' },\r\n            { value: 'empleados_sin_balance', label: 'Empleados Sin Balance' }\r\n          ],\r\n          default: 'balance_general'\r\n        },\r\n        {\r\n          campo: 'periodo',\r\n          label: 'Periodo de consulta',\r\n          tipo: 'select',\r\n          opciones: [\r\n            { value: '2024-2025', label: 'Periodo 2024-2025 (Actual)' },\r\n            { value: '2023-2024', label: 'Periodo 2023-2024' },\r\n            { value: '2022-2023', label: 'Periodo 2022-2023' },\r\n            { value: '2025-2026', label: 'Periodo 2025-2026 (Próximo)' },\r\n            { value: 'todos', label: 'Todos los periodos' }\r\n          ],\r\n          default: '2024-2025'\r\n        },\r\n        {\r\n          campo: 'direccionId',\r\n          label: 'Filtrar por Dirección',\r\n          tipo: 'select-direcciones',\r\n          default: null\r\n        },\r\n        {\r\n          campo: 'departamentoId',\r\n          label: 'Filtrar por Departamento',\r\n          tipo: 'select-departamentos',\r\n          default: null\r\n        },\r\n        {\r\n          campo: 'minimosDiasPendientes',\r\n          label: 'Mínimo de días pendientes',\r\n          tipo: 'number',\r\n          default: 0,\r\n          min: 0\r\n        },\r\n        {\r\n          campo: 'ordenamiento',\r\n          label: 'Ordenar por',\r\n          tipo: 'select',\r\n          opciones: [\r\n            { value: 'nombre', label: 'Nombre' },\r\n            { value: 'diasPendientes', label: 'Días Pendientes' },\r\n            { value: 'diasTotales', label: 'Días Totales' },\r\n            { value: 'antiguedad', label: 'Años de Antigüedad' }\r\n          ],\r\n          default: 'diasPendientes'\r\n        }\r\n      ]\r\n    },\r\n\r\n    \r\n  ];\r\n\r\n  const ejecutarReporte = async () => {\r\n    if (!tipoReporte) {\r\n      alert('Selecciona un tipo de reporte');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      // ✅ Construir payload correcto\r\n      let payload = { ...configuracion };\r\n      \r\n      // ✅ Si es vacaciones, construir payload específico\r\n      if (tipoReporte === 'vacaciones') {\r\n        payload = {\r\n          tipoVacaciones: configuracion.tipoVacaciones || 'balance_general',\r\n          periodo: configuracion.periodo || '2024-2025',\r\n          direccionId: configuracion.direccionId || null,\r\n          departamentoId: configuracion.departamentoId || null,\r\n          minimosDiasPendientes: configuracion.minimosDiasPendientes || 0,\r\n          ordenamiento: configuracion.ordenamiento || 'diasPendientes'\r\n        };\r\n      }\r\n\r\n      console.log('📤 Payload:', payload);\r\n\r\n      const response = await fetch(`${API_URL}/reportes/${tipoReporte}`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: `Bearer ${getStoredToken()}`\r\n        },\r\n        body: JSON.stringify(payload)\r\n      });\r\n\r\n      const result = await response.json();\r\n      console.log('📥 Respuesta:', result);\r\n\r\n      if (result.success) {\r\n        let datosLimpios = Array.isArray(result.data) ? result.data : [];\r\n        \r\n        // ✅ Limpiar datos de vacaciones\r\n        if (tipoReporte === 'vacaciones') {\r\n          datosLimpios = datosLimpios.map(item => {\r\n            const itemLimpio = { ...item };\r\n            \r\n            // Quitar $\r\n            Object.keys(itemLimpio).forEach(key => {\r\n              if (typeof itemLimpio[key] === 'string' && itemLimpio[key].startsWith('$')) {\r\n                itemLimpio[key] = itemLimpio[key].replace('$', '').trim();\r\n              }\r\n            });\r\n\r\n            // Anios → Años\r\n            if (itemLimpio['Anios Antiguedad']) {\r\n              itemLimpio['Años Antigüedad'] = itemLimpio['Anios Antiguedad'];\r\n              delete itemLimpio['Anios Antiguedad'];\r\n            }\r\n\r\n            return itemLimpio;\r\n          });\r\n        }\r\n\r\n        setData(datosLimpios);\r\n      } else {\r\n        alert('Error: ' + (result.error || 'Error desconocido'));\r\n        setData([]);\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ Error:', error);\r\n      alert('Error ejecutando reporte');\r\n      setData([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const exportarReporte = async (formato) => {\r\n    if (!Array.isArray(data) || data.length === 0) {\r\n      alert('No hay datos para exportar');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(`${API_URL}/reportes/export`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: `Bearer ${getStoredToken()}`\r\n        },\r\n        body: JSON.stringify({\r\n          formato,\r\n          data,\r\n          nombre: `reporte_${tipoReporte}_${new Date().toISOString().split('T')[0]}`\r\n        })\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorText = await response.text();\r\n        console.error('Error en exportación:', errorText);\r\n        alert('Error al exportar el reporte');\r\n        return;\r\n      }\r\n\r\n      const blob = await response.blob();\r\n      const url = window.URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      \r\n      const extensiones = {\r\n        'excel': 'xlsx',\r\n        'csv': 'csv',\r\n        'pdf': 'pdf'\r\n      };\r\n      \r\n      a.download = `reporte_${tipoReporte}_${new Date().toISOString().split('T')[0]}.${extensiones[formato] || formato}`;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n      window.URL.revokeObjectURL(url);\r\n    } catch (error) {\r\n      console.error('Error exportando:', error);\r\n      alert('Error al exportar');\r\n    }\r\n  };\r\n\r\n  const guardarReporte = async () => {\r\n    if (!nombreReporte.trim()) {\r\n      alert('Por favor ingresa un nombre para el reporte');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(`${API_URL}/reportes/guardados`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: `Bearer ${getStoredToken()}`\r\n        },\r\n        body: JSON.stringify({\r\n          nombre: nombreReporte,\r\n          origen: 'personalizado',\r\n          descripcion: `Reporte de ${tipoReporte}`,\r\n          configuracion: {\r\n            tipo: tipoReporte,\r\n            config: configuracion\r\n          }\r\n        })\r\n      });\r\n\r\n      if (response.ok) {\r\n        alert('Reporte guardado exitosamente');\r\n        setShowSaveModal(false);\r\n        setNombreReporte('');\r\n        cargarReportesGuardados();\r\n      } else {\r\n        alert('Error guardando reporte');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error:', error);\r\n      alert('Error al guardar reporte');\r\n    }\r\n  };\r\n\r\n  const cargarReporteGuardado = (reporte) => {\r\n    if (reporte.configuracion && reporte.configuracion.tipo) {\r\n      setTipoReporte(reporte.configuracion.tipo);\r\n      setConfiguracion(reporte.configuracion.config || {});\r\n    }\r\n  };\r\n\r\n  const eliminarReporteGuardado = async (id) => {\r\n    if (!window.confirm('¿Estás seguro de eliminar este reporte?')) return;\r\n\r\n    try {\r\n      const response = await fetch(`${API_URL}/reportes/guardados/${id}`, {\r\n        method: 'DELETE',\r\n        headers: {\r\n          Authorization: `Bearer ${getStoredToken()}`\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        alert('Reporte eliminado');\r\n        cargarReportesGuardados();\r\n      }\r\n    } catch (error) {\r\n      console.error('Error:', error);\r\n    }\r\n  };\r\n\r\n  const reporteSeleccionado = TIPOS_REPORTES.find(r => r.id === tipoReporte);\r\n\r\n  function obtenerValorConfig(config, campo) {\r\n    const campos = campo.split('.');\r\n    let valor = config;\r\n    for (const c of campos) {\r\n      valor = valor?.[c];\r\n    }\r\n    return valor;\r\n  }\r\n\r\n  function actualizarConfiguracion(campo, valor) {\r\n    const campos = campo.split('.');\r\n    const nuevaConfig = { ...configuracion };\r\n    \r\n    let ref = nuevaConfig;\r\n    for (let i = 0; i < campos.length - 1; i++) {\r\n      if (!ref[campos[i]]) ref[campos[i]] = {};\r\n      ref = ref[campos[i]];\r\n    }\r\n    \r\n    ref[campos[campos.length - 1]] = valor;\r\n    setConfiguracion(nuevaConfig);\r\n  }\r\n\r\n  function formatearNombreColumna(nombre) {\r\n    return nombre\r\n      .replace(/([A-Z])/g, ' $1')\r\n      .replace(/_/g, ' ')\r\n      .replace(/^./, str => str.toUpperCase())\r\n      .trim();\r\n  }\r\n\r\n  function formatearValor(key, value) {\r\n    if (value === null || value === undefined) return '-';\r\n    \r\n    if (key.toLowerCase().includes('fecha') && value) {\r\n      return new Date(value).toLocaleDateString('es-DO');\r\n    }\r\n    \r\n    if (key.toLowerCase().includes('salario') || \r\n        key.toLowerCase().includes('preaviso') ||\r\n        key.toLowerCase().includes('cesantia') ||\r\n        key.toLowerCase().includes('vacaciones') ||\r\n        key.toLowerCase().includes('regalia') ||\r\n        key.toLowerCase().includes('total') ||\r\n        key.toLowerCase().includes('promedio') ||\r\n        key.toLowerCase().includes('maximo') ||\r\n        key.toLowerCase().includes('minimo') ||\r\n        key.toLowerCase().includes('masa')) {\r\n      return `$${parseFloat(value).toLocaleString('es-DO', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;\r\n    }\r\n    \r\n    if (typeof value === 'number') {\r\n      return value.toLocaleString('es-DO');\r\n    }\r\n    \r\n    return value;\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-6 max-w-7xl mx-auto bg-gray-50 min-h-screen\">\r\n      {/* Header */}\r\n      <div className=\"mb-8\">\r\n        <h1 className=\"text-3xl font-bold text-gray-800 mb-2\">📊 Reportes RRHH</h1>\r\n        <p className=\"text-gray-600\">Sistema de reportería visual profesional</p>\r\n      </div>\r\n\r\n      {/* Dashboard de Métricas */}\r\n      {metricas && (\r\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8\">\r\n          <div className=\"bg-white rounded-xl shadow-sm p-6 border-l-4 border-blue-500\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-gray-600 text-sm\">Total Empleados</p>\r\n                <p className=\"text-3xl font-bold text-gray-900\">{metricas.totalEmpleados || 0}</p>\r\n              </div>\r\n              <Users className=\"w-12 h-12 text-blue-500 opacity-20\" />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-white rounded-xl shadow-sm p-6 border-l-4 border-green-500\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-gray-600 text-sm\">Contrataciones (30d)</p>\r\n                <p className=\"text-3xl font-bold text-gray-900\">{metricas.contratacionesUltimos30Dias || 0}</p>\r\n              </div>\r\n              <TrendingUp className=\"w-12 h-12 text-green-500 opacity-20\" />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-white rounded-xl shadow-sm p-6 border-l-4 border-purple-500\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-gray-600 text-sm\">Salario Promedio</p>\r\n                <p className=\"text-3xl font-bold text-gray-900\">\r\n                  ${(metricas.salarioPromedio || 0).toLocaleString()}\r\n                </p>\r\n              </div>\r\n              <DollarSign className=\"w-12 h-12 text-purple-500 opacity-20\" />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-white rounded-xl shadow-sm p-6 border-l-4 border-orange-500\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-gray-600 text-sm\">Vacantes Abiertas</p>\r\n                <p className=\"text-3xl font-bold text-gray-900\">{metricas.vacantesAbiertas || 0}</p>\r\n              </div>\r\n              <FileText className=\"w-12 h-12 text-orange-500 opacity-20\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Reportes Guardados */}\r\n      {Array.isArray(reportesGuardados) && reportesGuardados.length > 0 && (\r\n        <div className=\"bg-white rounded-xl shadow-sm p-6 mb-6\">\r\n          <h3 className=\"text-lg font-semibold mb-4\">📁 Mis Reportes Guardados</h3>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n            {reportesGuardados.map(reporte => (\r\n              <div key={reporte.id} className=\"border rounded-lg p-4 hover:shadow-md transition-shadow\">\r\n                <div className=\"flex justify-between items-start mb-2\">\r\n                  <h4 className=\"font-medium text-gray-900\">{reporte.nombre}</h4>\r\n                  <button\r\n                    onClick={() => eliminarReporteGuardado(reporte.id)}\r\n                    className=\"text-red-500 hover:text-red-700\"\r\n                  >\r\n                    <Trash2 className=\"w-4 h-4\" />\r\n                  </button>\r\n                </div>\r\n                <p className=\"text-sm text-gray-600 mb-3\">{reporte.descripcion}</p>\r\n                <button\r\n                  onClick={() => cargarReporteGuardado(reporte)}\r\n                  className=\"text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center gap-1\"\r\n                >\r\n                  <Play className=\"w-4 h-4\" />\r\n                  Cargar Reporte\r\n                </button>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Selección de Tipo de Reporte */}\r\n      <div className=\"bg-white rounded-xl shadow-sm p-6 mb-6\">\r\n        <h2 className=\"text-xl font-semibold mb-4 text-gray-800\">Selecciona el tipo de reporte</h2>\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n          {TIPOS_REPORTES.map(tipo => {\r\n            const Icon = tipo.icono;\r\n            const isSelected = tipoReporte === tipo.id;\r\n            return (\r\n              <button\r\n                key={tipo.id}\r\n                onClick={() => {\r\n                  setTipoReporte(tipo.id);\r\n                  setConfiguracion({});\r\n                  setData([]);\r\n                }}\r\n                className={`p-6 rounded-xl border-2 transition-all text-left ${\r\n                  isSelected\r\n                    ? 'border-blue-500 bg-blue-50 shadow-lg'\r\n                    : 'border-gray-200 hover:border-gray-300 hover:shadow-md'\r\n                }`}\r\n              >\r\n                <Icon className={`w-10 h-10 mb-3 ${isSelected ? 'text-blue-600' : 'text-gray-400'}`} />\r\n                <h3 className=\"font-semibold text-gray-900 mb-1\">{tipo.nombre}</h3>\r\n                <p className=\"text-sm text-gray-600\">{tipo.descripcion}</p>\r\n              </button>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Configuración del Reporte */}\r\n      {reporteSeleccionado && (\r\n        <div className=\"bg-white rounded-xl shadow-sm p-6 mb-6\">\r\n          <h2 className=\"text-xl font-semibold mb-4 text-gray-800\">\r\n            Configurar {reporteSeleccionado.nombre}\r\n          </h2>\r\n          \r\n          <div className=\"space-y-6\">\r\n            {reporteSeleccionado.configuraciones.map((config, index) => (\r\n              <ConfiguracionCampo\r\n                key={index}\r\n                config={config}\r\n                valor={obtenerValorConfig(configuracion, config.campo)}\r\n                onChange={(valor) => actualizarConfiguracion(config.campo, valor)}\r\n              />\r\n            ))}\r\n          </div>\r\n\r\n          <div className=\"flex gap-3 mt-6 pt-6 border-t\">\r\n            <button\r\n              onClick={ejecutarReporte}\r\n              disabled={loading}\r\n              className=\"flex-1 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-all flex items-center justify-center gap-2 font-medium shadow-lg\"\r\n            >\r\n              <Play className=\"w-5 h-5\" />\r\n              {loading ? 'Generando...' : 'Generar Reporte'}\r\n            </button>\r\n            \r\n            {Array.isArray(data) && data.length > 0 && (\r\n              <>\r\n                <button\r\n                  onClick={() => setShowSaveModal(true)}\r\n                  className=\"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-all flex items-center gap-2\"\r\n                >\r\n                  <Save className=\"w-5 h-5\" />\r\n                  Guardar\r\n                </button>\r\n                <button\r\n                  onClick={() => exportarReporte('excel')}\r\n                  className=\"bg-emerald-600 text-white px-6 py-3 rounded-lg hover:bg-emerald-700 transition-all flex items-center gap-2\"\r\n                >\r\n                  <Download className=\"w-5 h-5\" />\r\n                  Excel\r\n                </button>\r\n                <button\r\n                  onClick={() => exportarReporte('pdf')}\r\n                  className=\"bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700 transition-all flex items-center gap-2\"\r\n                >\r\n                  <Download className=\"w-5 h-5\" />\r\n                  PDF\r\n                </button>\r\n                <button\r\n                  onClick={() => exportarReporte('csv')}\r\n                  className=\"bg-orange-600 text-white px-6 py-3 rounded-lg hover:bg-orange-700 transition-all flex items-center gap-2\"\r\n                >\r\n                  <Download className=\"w-5 h-5\" />\r\n                  CSV\r\n                </button>\r\n              </>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Resultados */}\r\n      {Array.isArray(data) && data.length > 0 && (\r\n        <div className=\"bg-white rounded-xl shadow-sm overflow-hidden\">\r\n          <div className=\"bg-gradient-to-r from-blue-600 to-purple-600 px-6 py-4\">\r\n            <h3 className=\"text-white font-semibold flex items-center gap-2\">\r\n              📊 Resultados ({data.length} registros)\r\n            </h3>\r\n          </div>\r\n          \r\n          <div className=\"p-6\">\r\n            {/* Selector de Tipo de Gráfico */}\r\n            {data.length > 0 && Object.keys(data[0]).length >= 2 && (\r\n              <div className=\"mb-6\">\r\n                <div className=\"flex items-center gap-4 mb-4\">\r\n                  <span className=\"text-sm font-medium text-gray-700\">Tipo de gráfico:</span>\r\n                  <div className=\"flex gap-2\">\r\n                    <button\r\n                      onClick={() => setChartType('bar')}\r\n                      className={`px-4 py-2 rounded-lg flex items-center gap-2 transition-all ${\r\n                        chartType === 'bar' \r\n                          ? 'bg-blue-600 text-white shadow-md' \r\n                          : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\r\n                      }`}\r\n                    >\r\n                      <BarChart3 className=\"w-4 h-4\" />\r\n                      Barras\r\n                    </button>\r\n                    <button\r\n                      onClick={() => setChartType('line')}\r\n                      className={`px-4 py-2 rounded-lg flex items-center gap-2 transition-all ${\r\n                        chartType === 'line' \r\n                          ? 'bg-blue-600 text-white shadow-md' \r\n                          : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\r\n                      }`}\r\n                    >\r\n                      <Activity className=\"w-4 h-4\" />\r\n                      Líneas\r\n                    </button>\r\n                    <button\r\n                      onClick={() => setChartType('pie')}\r\n                      className={`px-4 py-2 rounded-lg flex items-center gap-2 transition-all ${\r\n                        chartType === 'pie' \r\n                          ? 'bg-blue-600 text-white shadow-md' \r\n                          : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\r\n                      }`}\r\n                    >\r\n                      <PieChartIcon className=\"w-4 h-4\" />\r\n                      Circular\r\n                    </button>\r\n                    <button\r\n                      onClick={() => setChartType('area')}\r\n                      className={`px-4 py-2 rounded-lg flex items-center gap-2 transition-all ${\r\n                        chartType === 'area' \r\n                          ? 'bg-blue-600 text-white shadow-md' \r\n                          : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\r\n                      }`}\r\n                    >\r\n                      <TrendingUp className=\"w-4 h-4\" />\r\n                      Área\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n\r\n                <GraficoRenderer tipo={chartType} data={data} />\r\n              </div>\r\n            )}\r\n\r\n            {/* Tabla de datos */}\r\n            <div className=\"overflow-x-auto\">\r\n              <table className=\"w-full border-collapse\">\r\n                <thead>\r\n                  <tr className=\"bg-gray-50\">\r\n                    {Object.keys(data[0] || {}).map((key) => (\r\n                      <th key={key} className=\"border-b-2 border-gray-200 px-4 py-3 text-left text-sm font-semibold text-gray-700\">\r\n                        {formatearNombreColumna(key)}\r\n                      </th>\r\n                    ))}\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {data.slice(0, 100).map((row, index) => (\r\n                    <tr key={index} className=\"hover:bg-gray-50 transition-colors\">\r\n                      {Object.entries(row).map(([key, value], cellIndex) => (\r\n                        <td key={cellIndex} className=\"border-b border-gray-100 px-4 py-3 text-sm text-gray-900\">\r\n                          {formatearValor(key, value)}\r\n                        </td>\r\n                      ))}\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n              {data.length > 100 && (\r\n                <p className=\"text-sm text-gray-500 mt-3 text-center\">\r\n                  Mostrando primeros 100 de {data.length} registros\r\n                </p>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modal para guardar reporte */}\r\n      {showSaveModal && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white rounded-xl p-6 w-96 shadow-2xl\">\r\n            <h3 className=\"text-xl font-bold mb-4\">Guardar Reporte</h3>\r\n            <input\r\n              type=\"text\"\r\n              value={nombreReporte}\r\n              onChange={(e) => setNombreReporte(e.target.value)}\r\n              placeholder=\"Nombre del reporte\"\r\n              className=\"w-full border-2 border-gray-300 rounded-lg px-4 py-3 mb-4 focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n            />\r\n            <div className=\"flex gap-3\">\r\n              <button\r\n                onClick={() => setShowSaveModal(false)}\r\n                className=\"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400\"\r\n              >\r\n                Cancelar\r\n              </button>\r\n              <button\r\n                onClick={guardarReporte}\r\n                className=\"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700\"\r\n              >\r\n                Guardar\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n// Componente auxiliar para select de direcciones\r\nconst SelectDirecciones = ({ valor, onChange, config }) => {\r\n  const [direcciones, setDirecciones] = useState([]);\r\n  const { getStoredToken } = useAuth();\r\n\r\n  useEffect(() => {\r\n    cargarDirecciones();\r\n  }, []);\r\n\r\n  const cargarDirecciones = async () => {\r\n    try {\r\n      const response = await fetch(`${API_URL}/direcciones`, {\r\n        headers: { Authorization: `Bearer ${getStoredToken()}` }\r\n      });\r\n      const data = await response.json();\r\n      setDirecciones(Array.isArray(data) ? data : []);\r\n    } catch (error) {\r\n      console.error('Error cargando direcciones:', error);\r\n      setDirecciones([]);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <label className=\"block font-medium text-gray-700 mb-2\">{config.label}</label>\r\n      <select\r\n        value={valor || ''}\r\n        onChange={(e) => onChange(e.target.value || null)}\r\n        className=\"w-full border-2 border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n      >\r\n        <option value=\"\">Todas las direcciones</option>\r\n        {direcciones.map(dir => (\r\n          <option key={dir.DireccionID} value={dir.DireccionID}>\r\n            {dir.Nombre}\r\n          </option>\r\n        ))}\r\n      </select>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Componente de Configuración de Campos\r\nconst ConfiguracionCampo = ({ config, valor, onChange }) => {\r\n  const [departamentos, setDepartamentos] = useState([]);\r\n  const { getStoredToken } = useAuth();\r\n\r\n  useEffect(() => {\r\n    if (config.tipo === 'select-departamentos') {\r\n      cargarDepartamentos();\r\n    }\r\n  }, [config.tipo]);\r\n\r\n  \r\n\r\n  const cargarDepartamentos = async () => {\r\n    try {\r\n      const response = await fetch(`${API_URL}/departamentos`, {\r\n        headers: { Authorization: `Bearer ${getStoredToken()}` }\r\n      });\r\n      const data = await response.json();\r\n      setDepartamentos(Array.isArray(data) ? data : []);\r\n    } catch (error) {\r\n      console.error('Error cargando departamentos:', error);\r\n      setDepartamentos([]);\r\n    }\r\n  };\r\n\r\n  if (config.tipo === 'multiselect') {\r\n    const valoresSeleccionados = valor || config.default || [];\r\n    \r\n    return (\r\n      <div>\r\n        <label className=\"block font-medium text-gray-700 mb-3\">{config.label}</label>\r\n        <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3\">\r\n          {config.opciones.map(opcion => {\r\n            const isSelected = valoresSeleccionados.includes(opcion.value);\r\n            return (\r\n              <button\r\n                key={opcion.value}\r\n                onClick={() => {\r\n                  const nuevosValores = isSelected\r\n                    ? valoresSeleccionados.filter(v => v !== opcion.value)\r\n                    : [...valoresSeleccionados, opcion.value];\r\n                  onChange(nuevosValores);\r\n                }}\r\n                className={`p-3 rounded-lg border-2 text-sm text-left transition-all ${\r\n                  isSelected\r\n                    ? 'border-blue-500 bg-blue-50 text-blue-700'\r\n                    : 'border-gray-200 hover:border-blue-300 text-gray-700'\r\n                }`}\r\n              >\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span>{opcion.label}</span>\r\n                  {isSelected && <span className=\"text-blue-600 font-bold\">✓</span>}\r\n                </div>\r\n              </button>\r\n            );\r\n          })}\r\n        </div>\r\n        <p className=\"text-xs text-gray-500 mt-2\">\r\n          {valoresSeleccionados.length} seleccionado(s)\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (config.tipo === 'select') {\r\n    return (\r\n      <div>\r\n        <label className=\"block font-medium text-gray-700 mb-2\">{config.label}</label>\r\n        <select\r\n          value={valor || config.default}\r\n          onChange={(e) => onChange(e.target.value)}\r\n          className=\"w-full border-2 border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n        >\r\n          {config.opciones.map(opcion => (\r\n            <option key={opcion.value} value={opcion.value}>\r\n              {opcion.label}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (config.tipo === 'select-departamentos') {\r\n    return (\r\n      <div>\r\n        <label className=\"block font-medium text-gray-700 mb-2\">{config.label}</label>\r\n        <select\r\n          value={valor || ''}\r\n          onChange={(e) => onChange(e.target.value || null)}\r\n          className=\"w-full border-2 border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n        >\r\n          <option value=\"\">Todos los departamentos</option>\r\n          {departamentos.map(dept => (\r\n            <option key={dept.DepartamentoID} value={dept.DepartamentoID}>\r\n              {dept.Nombre}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // ============================================\r\n// REEMPLAZAR EL BLOQUE select-direcciones\r\n// Busca la línea 915 donde pusiste el código\r\n// REEMPLAZA TODO el bloque por este:\r\n// ============================================\r\n\r\n  if (config.tipo === 'select-direcciones') {\r\n    // ✅ SOLUCIÓN: Mover los hooks FUERA del if\r\n    return <SelectDirecciones valor={valor} onChange={onChange} config={config} />;\r\n  }\r\n\r\n// ============================================\r\n// AGREGAR ESTE NUEVO COMPONENTE\r\n// Después del componente ConfiguracionCampo\r\n// Justo antes de GraficoRenderer\r\n// ============================================\r\n\r\n\r\n\r\n  if (config.tipo === 'number') {\r\n    return (\r\n      <div>\r\n        <label className=\"block font-medium text-gray-700 mb-2\">{config.label}</label>\r\n        <input\r\n          type=\"number\"\r\n          value={valor !== undefined ? valor : config.default}\r\n          onChange={(e) => onChange(parseInt(e.target.value) || 0)}\r\n          min={config.min || 0}\r\n          max={config.max}\r\n          className=\"w-full border-2 border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n\r\n  if (config.tipo === 'checkbox') {\r\n    return (\r\n      <div className=\"flex items-center\">\r\n        <input\r\n          type=\"checkbox\"\r\n          checked={valor !== undefined ? valor : config.default}\r\n          onChange={(e) => onChange(e.target.checked)}\r\n          className=\"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"\r\n        />\r\n        <label className=\"ml-3 font-medium text-gray-700\">{config.label}</label>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (config.tipo === 'date') {\r\n    return (\r\n      <div>\r\n        <label className=\"block font-medium text-gray-700 mb-2\">{config.label}</label>\r\n        <input\r\n          type=\"date\"\r\n          value={valor || config.default || ''}\r\n          onChange={(e) => onChange(e.target.value)}\r\n          className=\"w-full border-2 border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return null;\r\n};\r\n\r\n\r\n// Componente Renderizador de Gráficos\r\nconst GraficoRenderer = ({ tipo, data }) => {\r\n  if (!Array.isArray(data) || data.length === 0) return null;\r\n\r\n  const keys = Object.keys(data[0]);\r\n  if (keys.length < 2) return null;\r\n\r\n  const xKey = keys[0];\r\n  const yKey = keys[1];\r\n  \r\n  // Limitar datos para mejor visualización\r\n  const chartData = data.slice(0, 15);\r\n\r\n  if (tipo === 'bar') {\r\n    return (\r\n      <div className=\"bg-gray-50 p-6 rounded-lg\">\r\n        <ResponsiveContainer width=\"100%\" height={400}>\r\n          <BarChart data={chartData}>\r\n            <XAxis \r\n              dataKey={xKey} \r\n              angle={-45}\r\n              textAnchor=\"end\"\r\n              height={100}\r\n              style={{ fontSize: '12px' }}\r\n            />\r\n            <YAxis style={{ fontSize: '12px' }} />\r\n            <Tooltip />\r\n            <Legend />\r\n            <Bar dataKey={yKey} fill=\"#3B82F6\" radius={[8, 8, 0, 0]} />\r\n          </BarChart>\r\n        </ResponsiveContainer>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (tipo === 'line') {\r\n    return (\r\n      <div className=\"bg-gray-50 p-6 rounded-lg\">\r\n        <ResponsiveContainer width=\"100%\" height={400}>\r\n          <LineChart data={chartData}>\r\n            <XAxis \r\n              dataKey={xKey} \r\n              angle={-45}\r\n              textAnchor=\"end\"\r\n              height={100}\r\n              style={{ fontSize: '12px' }}\r\n            />\r\n            <YAxis style={{ fontSize: '12px' }} />\r\n            <Tooltip />\r\n            <Legend />\r\n            <Line \r\n              type=\"monotone\" \r\n              dataKey={yKey} \r\n              stroke=\"#3B82F6\" \r\n              strokeWidth={3}\r\n              dot={{ fill: '#3B82F6', r: 5 }}\r\n              activeDot={{ r: 8 }}\r\n            />\r\n          </LineChart>\r\n        </ResponsiveContainer>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (tipo === 'pie') {\r\n    return (\r\n      <div className=\"bg-gray-50 p-6 rounded-lg\">\r\n        <ResponsiveContainer width=\"100%\" height={400}>\r\n          <PieChart>\r\n            <Pie\r\n              data={chartData}\r\n              dataKey={yKey}\r\n              nameKey={xKey}\r\n              cx=\"50%\"\r\n              cy=\"50%\"\r\n              outerRadius={120}\r\n              label={({ name, percent }) => `${name}: ${(percent * 100).toFixed(0)}%`}\r\n              labelLine={true}\r\n            >\r\n              {chartData.map((entry, index) => (\r\n                <Cell key={`cell-${index}`} fill={CHART_COLORS[index % CHART_COLORS.length]} />\r\n              ))}\r\n            </Pie>\r\n            <Tooltip />\r\n            <Legend />\r\n          </PieChart>\r\n        </ResponsiveContainer>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (tipo === 'area') {\r\n    return (\r\n      <div className=\"bg-gray-50 p-6 rounded-lg\">\r\n        <ResponsiveContainer width=\"100%\" height={400}>\r\n          <AreaChart data={chartData}>\r\n            <XAxis \r\n              dataKey={xKey} \r\n              angle={-45}\r\n              textAnchor=\"end\"\r\n              height={100}\r\n              style={{ fontSize: '12px' }}\r\n            />\r\n            <YAxis style={{ fontSize: '12px' }} />\r\n            <Tooltip />\r\n            <Legend />\r\n            <Area \r\n              type=\"monotone\" \r\n              dataKey={yKey} \r\n              stroke=\"#3B82F6\" \r\n              fill=\"#3B82F6\" \r\n              fillOpacity={0.6}\r\n              strokeWidth={2}\r\n            />\r\n          </AreaChart>\r\n        </ResponsiveContainer>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return null;\r\n};\r\n\r\nexport default ReportesVisualModule;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}