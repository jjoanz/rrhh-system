{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{BarChart,Bar,XAxis,YAxis,Tooltip,Legend,ResponsiveContainer}from\"recharts\";import{Play,Save,Plus,Database,Download,FileText,BarChart3,X}from\"lucide-react\";// Simulación del contexto de autenticación\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const useAuth=()=>({user:{id:1,name:\"Usuario Demo\"},getStoredToken:()=>\"demo-token-12345\"});const API_URL=process.env.REACT_APP_API_URL||\"http://192.168.0.239:5000/api\";// Datos de ejemplo para demostrar funcionalidad\nconst mockMetadata={Empleados:[\"EmpleadoID\",\"Nombre\",\"Apellido\",\"Email\",\"Puesto\",\"Salario\",\"FechaIngreso\",\"DepartamentoID\"],Departamentos:[\"DepartamentoID\",\"Nombre\",\"Descripcion\",\"GerenteID\"],Proyectos:[\"ProyectoID\",\"Nombre\",\"FechaInicio\",\"FechaFin\",\"Presupuesto\",\"Estado\"],Ventas:[\"VentaID\",\"ProductoID\",\"Cantidad\",\"Precio\",\"FechaVenta\",\"ClienteID\"]};// Campo seleccionable (más simple que drag & drop)\nconst SelectableField=_ref=>{let{name,table,isSelected,onToggle}=_ref;return/*#__PURE__*/_jsxs(\"div\",{onClick:()=>onToggle({name,table}),className:`flex items-center gap-2 p-2 m-1 border rounded cursor-pointer transition-all ${isSelected?\"bg-blue-100 border-blue-400 text-blue-800\":\"bg-white border-gray-300 hover:bg-gray-50\"}`,children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:isSelected,onChange:()=>{}// Manejado por onClick del div\n,className:\"pointer-events-none\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-gray-600 font-mono\",children:[table,\".\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium\",children:name})]});};// Modal simplificado para nuevo reporte\nconst NuevoReporteModal=_ref2=>{let{show,onClose,onSave,metadata}=_ref2;const[nombre,setNombre]=useState(\"\");const[origen,setOrigen]=useState(\"\");const[descripcion,setDescripcion]=useState(\"\");const handleSave=()=>{if(!nombre.trim()){alert(\"El nombre es requerido\");return;}onSave({nombre:nombre.trim(),origen,descripcion:descripcion.trim()});setNombre(\"\");setOrigen(\"\");setDescripcion(\"\");};if(!show)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg shadow-xl w-96\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold\",children:\"Nuevo Reporte\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-medium mb-1\",children:\"Nombre *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:nombre,onChange:e=>setNombre(e.target.value),className:\"w-full border p-2 rounded focus:ring-2 focus:ring-blue-500\",placeholder:\"Ej: Reporte de Ventas Mensuales\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-medium mb-1\",children:\"Tabla principal\"}),/*#__PURE__*/_jsxs(\"select\",{value:origen,onChange:e=>setOrigen(e.target.value),className:\"w-full border p-2 rounded focus:ring-2 focus:ring-blue-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Seleccionar tabla\"}),Object.keys(metadata).map(table=>/*#__PURE__*/_jsx(\"option\",{value:table,children:table},table))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-medium mb-1\",children:\"Descripci\\xF3n\"}),/*#__PURE__*/_jsx(\"textarea\",{value:descripcion,onChange:e=>setDescripcion(e.target.value),className:\"w-full border p-2 rounded focus:ring-2 focus:ring-blue-500\",rows:3,placeholder:\"Describe brevemente este reporte...\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-2 mt-6\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400\",children:\"Cancelar\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleSave,className:\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Save,{className:\"w-4 h-4\"}),\" Guardar\"]})]})]})});};// Componente principal simplificado\nconst ReportesModule=()=>{const{getStoredToken}=useAuth();const[metadata,setMetadata]=useState(mockMetadata);const[reportes,setReportes]=useState([]);const[showModal,setShowModal]=useState(false);// Campos seleccionados (más simple que drag & drop)\nconst[selectedFields,setSelectedFields]=useState([]);const[sqlQuery,setSqlQuery]=useState(\"\");const[data,setData]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState(null);// Cargar reportes guardados\nuseEffect(()=>{const fetchReportes=async()=>{try{const token=getStoredToken();const response=await fetch(`${API_URL}/reportes/guardados`,{headers:{Authorization:`Bearer ${token}`}});if(response.ok){const data=await response.json();setReportes(Array.isArray(data)?data:[]);}else{console.warn(\"Error cargando reportes:\",response.status);setReportes([]);}}catch(err){console.warn(\"Error conectando al servidor:\",err.message);setReportes([]);}};fetchReportes();},[getStoredToken]);// Generar SQL básico basado en campos seleccionados\nuseEffect(()=>{if(selectedFields.length===0){setSqlQuery(\"\");return;}// Obtener tablas únicas\nconst tables=[...new Set(selectedFields.map(f=>f.table))];// Generar SELECT\nconst selectClause=selectedFields.map(f=>`${f.table}.${f.name}`).join(\", \");// SQL básico\nlet query=`SELECT ${selectClause}\\nFROM ${tables[0]}`;// Si hay múltiples tablas, agregar JOINs básicos (esto es simplificado)\nfor(let i=1;i<tables.length;i++){query+=`\\nLEFT JOIN ${tables[i]} ON ${tables[0]}.${tables[i]}ID = ${tables[i]}.${tables[i]}ID`;}query+=\"\\nLIMIT 100\";setSqlQuery(query);},[selectedFields]);// Manejar selección de campos\nconst toggleField=field=>{const isSelected=selectedFields.some(f=>f.table===field.table&&f.name===field.name);if(isSelected){setSelectedFields(selectedFields.filter(f=>!(f.table===field.table&&f.name===field.name)));}else{setSelectedFields([...selectedFields,field]);}};// Ejecutar consulta\nconst ejecutarConsulta=async()=>{if(!sqlQuery.trim()){alert(\"No hay consulta para ejecutar\");return;}setLoading(true);setError(null);try{const response=await fetch(`${API_URL}/reportes/custom`,{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${getStoredToken()}`},body:JSON.stringify({sqlQuery})});if(!response.ok){const errorData=await response.json();throw new Error(errorData.details||`Error ${response.status}`);}const result=await response.json();setData(result.data||[]);// Datos de ejemplo si no hay respuesta del servidor\nif(!result.data||result.data.length===0){const mockData=[{Departamento:\"Ventas\",Empleados:25,Promedio:45000},{Departamento:\"IT\",Empleados:18,Promedio:55000},{Departamento:\"RRHH\",Empleados:12,Promedio:48000},{Departamento:\"Marketing\",Empleados:15,Promedio:42000}];setData(mockData);}}catch(err){console.error(\"Error ejecutando consulta:\",err);setError(err.message);// Datos de ejemplo para demostración\nconst mockData=[{Departamento:\"Ventas\",Empleados:25,Promedio:45000},{Departamento:\"IT\",Empleados:18,Promedio:55000},{Departamento:\"RRHH\",Empleados:12,Promedio:48000}];setData(mockData);}finally{setLoading(false);}};// Guardar reporte\nconst guardarReporte=async nuevoReporte=>{try{const reporteData={...nuevoReporte,configuracion:{selectedFields,sqlQuery}};const response=await fetch(`${API_URL}/reportes/guardados`,{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${getStoredToken()}`},body:JSON.stringify(reporteData)});if(!response.ok){const errorData=await response.json();throw new Error(errorData.details||`Error ${response.status}`);}const saved=await response.json();setReportes([...reportes,saved]);setShowModal(false);alert(\"Reporte guardado exitosamente\");}catch(err){console.error(\"Error guardando reporte:\",err);// Simulación para demostración\nconst nuevoId=Date.now();const reporteSimulado={id:nuevoId,...nuevoReporte,fechaCreacion:new Date().toISOString().split('T')[0],modificadoPor:\"Usuario Demo\"};setReportes([...reportes,reporteSimulado]);setShowModal(false);alert(\"Reporte guardado exitosamente (simulado)\");}};// Exportar datos\nconst exportarDatos=async formato=>{if(data.length===0){alert(\"No hay datos para exportar\");return;}try{const response=await fetch(`${API_URL}/reportes/export`,{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${getStoredToken()}`},body:JSON.stringify({formato,data,nombre:`reporte_${new Date().toISOString().split('T')[0]}`})});if(response.ok){const blob=await response.blob();const url=window.URL.createObjectURL(blob);const link=document.createElement('a');link.href=url;link.download=`reporte.${formato}`;link.click();window.URL.revokeObjectURL(url);}else{throw new Error(`Error ${response.status}`);}}catch(err){console.error(\"Error exportando:\",err);// Exportación simulada para CSV\nif(formato==='csv'){const csv=[Object.keys(data[0]).join(','),...data.map(row=>Object.values(row).join(','))].join('\\n');const blob=new Blob([csv],{type:'text/csv'});const url=URL.createObjectURL(blob);const link=document.createElement('a');link.href=url;link.download='reporte.csv';link.click();URL.revokeObjectURL(url);}}};// Limpiar selección\nconst limpiarSeleccion=()=>{setSelectedFields([]);setSqlQuery(\"\");setData([]);setError(null);};return/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 max-w-7xl mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-6\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"text-3xl font-bold flex items-center gap-3\",children:[/*#__PURE__*/_jsx(BarChart3,{className:\"w-8 h-8 text-blue-600\"}),\"Generador de Reportes\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:limpiarSeleccion,className:\"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600\",children:\"Limpiar\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowModal(true),className:\"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Plus,{className:\"w-4 h-4\"}),\" Nuevo Reporte\"]})]})]}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-red-700\",children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setError(null),className:\"text-red-500 hover:text-red-700\",children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-4 border-b\",children:/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold flex items-center gap-2\",children:[/*#__PURE__*/_jsx(FileText,{className:\"w-5 h-5\"}),\"Reportes Guardados (\",reportes.length,\")\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-sm font-medium text-gray-700\",children:\"Nombre\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-sm font-medium text-gray-700\",children:\"Origen\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-sm font-medium text-gray-700\",children:\"Descripci\\xF3n\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-sm font-medium text-gray-700\",children:\"Fecha\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-sm font-medium text-gray-700\",children:\"Acciones\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y divide-gray-200\",children:reportes.length===0?/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"5\",className:\"px-4 py-8 text-center text-gray-500\",children:\"No hay reportes guardados. Crea tu primer reporte.\"})}):reportes.map(reporte=>/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 font-medium\",children:reporte.nombre}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-gray-600\",children:reporte.origen||\"-\"}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-gray-600\",children:reporte.descripcion||\"-\"}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-gray-600\",children:reporte.fechaCreacion||\"-\"}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"text-blue-600 hover:underline text-sm\",children:\"Ejecutar\"}),/*#__PURE__*/_jsx(\"button\",{className:\"text-green-600 hover:underline text-sm\",children:\"Editar\"}),/*#__PURE__*/_jsx(\"button\",{className:\"text-red-600 hover:underline text-sm\",children:\"Eliminar\"})]})})]},reporte.id))})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 border-b\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold\",children:\"Seleccionar Campos\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mt-1\",children:\"Haz clic en los campos que deseas incluir en tu reporte\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-4 max-h-96 overflow-y-auto\",children:Object.entries(metadata).map(_ref3=>{let[table,fields]=_ref3;return/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"font-medium text-gray-800 mb-2 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Database,{className:\"w-4 h-4\"}),table]}),/*#__PURE__*/_jsx(\"div\",{className:\"ml-6 space-y-1\",children:fields.map(field=>/*#__PURE__*/_jsx(SelectableField,{name:field,table:table,isSelected:selectedFields.some(f=>f.table===table&&f.name===field),onToggle:toggleField},`${table}-${field}`))})]},table);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 border-b\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold\",children:\"Consulta SQL\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mt-1\",children:\"Se genera autom\\xE1ticamente o puedes editarla manualmente\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium mb-2\",children:\"Campos seleccionados:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-1 mb-3 min-h-[2rem] p-2 border rounded bg-gray-50\",children:selectedFields.length===0?/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-500 text-sm\",children:\"Ning\\xFAn campo seleccionado\"}):selectedFields.map((field,index)=>/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded\",children:[field.table,\".\",field.name,/*#__PURE__*/_jsx(\"button\",{onClick:()=>toggleField(field),className:\"text-blue-600 hover:text-blue-800\",children:\"\\xD7\"})]},index))})]}),/*#__PURE__*/_jsx(\"textarea\",{value:sqlQuery,onChange:e=>setSqlQuery(e.target.value),className:\"w-full border rounded p-3 font-mono text-sm\",rows:8,placeholder:\"SELECT * FROM tabla WHERE condicion...\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mt-4\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:ejecutarConsulta,disabled:loading||!sqlQuery.trim(),className:\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Play,{className:\"w-4 h-4\"}),loading?\"Ejecutando...\":\"Ejecutar\"]}),data.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-1\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>exportarDatos('csv'),className:\"bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Download,{className:\"w-4 h-4\"}),\" CSV\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>exportarDatos('excel'),className:\"bg-orange-600 text-white px-3 py-2 rounded hover:bg-orange-700 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Download,{className:\"w-4 h-4\"}),\" Excel\"]})]})]})]})]})]}),data.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-4 border-b\",children:/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold\",children:[\"Resultados (\",data.length,\" registros)\"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:300,children:/*#__PURE__*/_jsxs(BarChart,{data:data.slice(0,10),children:[/*#__PURE__*/_jsx(XAxis,{dataKey:Object.keys(data[0])[0]}),/*#__PURE__*/_jsx(YAxis,{}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Legend,{}),/*#__PURE__*/_jsx(Bar,{dataKey:Object.keys(data[0])[1],fill:\"#3B82F6\"})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"overflow-x-auto\",children:[/*#__PURE__*/_jsxs(\"table\",{className:\"w-full border\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsx(\"tr\",{children:Object.keys(data[0]).map(key=>/*#__PURE__*/_jsx(\"th\",{className:\"border px-3 py-2 text-left font-medium text-sm\",children:key},key))})}),/*#__PURE__*/_jsx(\"tbody\",{children:data.slice(0,50).map((row,index)=>/*#__PURE__*/_jsx(\"tr\",{className:\"hover:bg-gray-50\",children:Object.values(row).map((value,cellIndex)=>/*#__PURE__*/_jsx(\"td\",{className:\"border px-3 py-2 text-sm\",children:value},cellIndex))},index))})]}),data.length>50&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500 mt-2 text-center\",children:[\"Mostrando primeros 50 de \",data.length,\" registros\"]})]})]})]}),/*#__PURE__*/_jsx(NuevoReporteModal,{show:showModal,onClose:()=>setShowModal(false),onSave:guardarReporte,metadata:metadata})]});};export default ReportesModule;","map":{"version":3,"names":["React","useState","useEffect","BarChart","Bar","XAxis","YAxis","Tooltip","Legend","ResponsiveContainer","Play","Save","Plus","Database","Download","FileText","BarChart3","X","jsx","_jsx","jsxs","_jsxs","useAuth","user","id","name","getStoredToken","API_URL","process","env","REACT_APP_API_URL","mockMetadata","Empleados","Departamentos","Proyectos","Ventas","SelectableField","_ref","table","isSelected","onToggle","onClick","className","children","type","checked","onChange","NuevoReporteModal","_ref2","show","onClose","onSave","metadata","nombre","setNombre","origen","setOrigen","descripcion","setDescripcion","handleSave","trim","alert","value","e","target","placeholder","Object","keys","map","rows","ReportesModule","setMetadata","reportes","setReportes","showModal","setShowModal","selectedFields","setSelectedFields","sqlQuery","setSqlQuery","data","setData","loading","setLoading","error","setError","fetchReportes","token","response","fetch","headers","Authorization","ok","json","Array","isArray","console","warn","status","err","message","length","tables","Set","f","selectClause","join","query","i","toggleField","field","some","filter","ejecutarConsulta","method","body","JSON","stringify","errorData","Error","details","result","mockData","Departamento","Promedio","guardarReporte","nuevoReporte","reporteData","configuracion","saved","nuevoId","Date","now","reporteSimulado","fechaCreacion","toISOString","split","modificadoPor","exportarDatos","formato","blob","url","window","URL","createObjectURL","link","document","createElement","href","download","click","revokeObjectURL","csv","row","values","Blob","limpiarSeleccion","colSpan","reporte","entries","_ref3","fields","index","disabled","width","height","slice","dataKey","fill","key","cellIndex"],"sources":["C:/Users/josemontedeoca/rrhh-system/frontend/src/components/modules/Reportes/ReportesModule.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { BarChart, Bar, XAxis, YAxis, Tooltip, Legend, ResponsiveContainer } from \"recharts\";\r\nimport { Play, Save, Plus, Database, Download, FileText, BarChart3, X } from \"lucide-react\";\r\n\r\n// Simulación del contexto de autenticación\r\nconst useAuth = () => ({\r\n  user: { id: 1, name: \"Usuario Demo\" },\r\n  getStoredToken: () => \"demo-token-12345\"\r\n});\r\n\r\nconst API_URL = process.env.REACT_APP_API_URL || \"http://192.168.0.239:5000/api\";\r\n\r\n// Datos de ejemplo para demostrar funcionalidad\r\nconst mockMetadata = {\r\n  Empleados: [\"EmpleadoID\", \"Nombre\", \"Apellido\", \"Email\", \"Puesto\", \"Salario\", \"FechaIngreso\", \"DepartamentoID\"],\r\n  Departamentos: [\"DepartamentoID\", \"Nombre\", \"Descripcion\", \"GerenteID\"],\r\n  Proyectos: [\"ProyectoID\", \"Nombre\", \"FechaInicio\", \"FechaFin\", \"Presupuesto\", \"Estado\"],\r\n  Ventas: [\"VentaID\", \"ProductoID\", \"Cantidad\", \"Precio\", \"FechaVenta\", \"ClienteID\"]\r\n};\r\n\r\n// Campo seleccionable (más simple que drag & drop)\r\nconst SelectableField = ({ name, table, isSelected, onToggle }) => (\r\n  <div\r\n    onClick={() => onToggle({ name, table })}\r\n    className={`flex items-center gap-2 p-2 m-1 border rounded cursor-pointer transition-all ${\r\n      isSelected \r\n        ? \"bg-blue-100 border-blue-400 text-blue-800\" \r\n        : \"bg-white border-gray-300 hover:bg-gray-50\"\r\n    }`}\r\n  >\r\n    <input\r\n      type=\"checkbox\"\r\n      checked={isSelected}\r\n      onChange={() => {}} // Manejado por onClick del div\r\n      className=\"pointer-events-none\"\r\n    />\r\n    <span className=\"text-xs text-gray-600 font-mono\">{table}.</span>\r\n    <span className=\"text-sm font-medium\">{name}</span>\r\n  </div>\r\n);\r\n\r\n// Modal simplificado para nuevo reporte\r\nconst NuevoReporteModal = ({ show, onClose, onSave, metadata }) => {\r\n  const [nombre, setNombre] = useState(\"\");\r\n  const [origen, setOrigen] = useState(\"\");\r\n  const [descripcion, setDescripcion] = useState(\"\");\r\n\r\n  const handleSave = () => {\r\n    if (!nombre.trim()) {\r\n      alert(\"El nombre es requerido\");\r\n      return;\r\n    }\r\n    onSave({ nombre: nombre.trim(), origen, descripcion: descripcion.trim() });\r\n    setNombre(\"\");\r\n    setOrigen(\"\");\r\n    setDescripcion(\"\");\r\n  };\r\n\r\n  if (!show) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50\">\r\n      <div className=\"bg-white p-6 rounded-lg shadow-xl w-96\">\r\n        <div className=\"flex justify-between items-center mb-4\">\r\n          <h3 className=\"text-lg font-bold\">Nuevo Reporte</h3>\r\n          <button onClick={onClose} className=\"text-gray-500 hover:text-gray-700\">\r\n            <X className=\"w-5 h-5\" />\r\n          </button>\r\n        </div>\r\n        \r\n        <div className=\"space-y-4\">\r\n          <div>\r\n            <label className=\"block font-medium mb-1\">Nombre *</label>\r\n            <input\r\n              type=\"text\"\r\n              value={nombre}\r\n              onChange={(e) => setNombre(e.target.value)}\r\n              className=\"w-full border p-2 rounded focus:ring-2 focus:ring-blue-500\"\r\n              placeholder=\"Ej: Reporte de Ventas Mensuales\"\r\n            />\r\n          </div>\r\n          \r\n          <div>\r\n            <label className=\"block font-medium mb-1\">Tabla principal</label>\r\n            <select\r\n              value={origen}\r\n              onChange={(e) => setOrigen(e.target.value)}\r\n              className=\"w-full border p-2 rounded focus:ring-2 focus:ring-blue-500\"\r\n            >\r\n              <option value=\"\">Seleccionar tabla</option>\r\n              {Object.keys(metadata).map((table) => (\r\n                <option key={table} value={table}>{table}</option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n          \r\n          <div>\r\n            <label className=\"block font-medium mb-1\">Descripción</label>\r\n            <textarea\r\n              value={descripcion}\r\n              onChange={(e) => setDescripcion(e.target.value)}\r\n              className=\"w-full border p-2 rounded focus:ring-2 focus:ring-blue-500\"\r\n              rows={3}\r\n              placeholder=\"Describe brevemente este reporte...\"\r\n            />\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"flex justify-end gap-2 mt-6\">\r\n          <button onClick={onClose} className=\"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400\">\r\n            Cancelar\r\n          </button>\r\n          <button\r\n            onClick={handleSave}\r\n            className=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 flex items-center gap-2\"\r\n          >\r\n            <Save className=\"w-4 h-4\" /> Guardar\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Componente principal simplificado\r\nconst ReportesModule = () => {\r\n  const { getStoredToken } = useAuth();\r\n  const [metadata, setMetadata] = useState(mockMetadata);\r\n  const [reportes, setReportes] = useState([]);\r\n  const [showModal, setShowModal] = useState(false);\r\n  \r\n  // Campos seleccionados (más simple que drag & drop)\r\n  const [selectedFields, setSelectedFields] = useState([]);\r\n  const [sqlQuery, setSqlQuery] = useState(\"\");\r\n  const [data, setData] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  // Cargar reportes guardados\r\n  useEffect(() => {\r\n    const fetchReportes = async () => {\r\n      try {\r\n        const token = getStoredToken();\r\n        const response = await fetch(`${API_URL}/reportes/guardados`, {\r\n          headers: { Authorization: `Bearer ${token}` }\r\n        });\r\n        \r\n        if (response.ok) {\r\n          const data = await response.json();\r\n          setReportes(Array.isArray(data) ? data : []);\r\n        } else {\r\n          console.warn(\"Error cargando reportes:\", response.status);\r\n          setReportes([]);\r\n        }\r\n      } catch (err) {\r\n        console.warn(\"Error conectando al servidor:\", err.message);\r\n        setReportes([]);\r\n      }\r\n    };\r\n    \r\n    fetchReportes();\r\n  }, [getStoredToken]);\r\n\r\n  // Generar SQL básico basado en campos seleccionados\r\n  useEffect(() => {\r\n    if (selectedFields.length === 0) {\r\n      setSqlQuery(\"\");\r\n      return;\r\n    }\r\n\r\n    // Obtener tablas únicas\r\n    const tables = [...new Set(selectedFields.map(f => f.table))];\r\n    \r\n    // Generar SELECT\r\n    const selectClause = selectedFields.map(f => `${f.table}.${f.name}`).join(\", \");\r\n    \r\n    // SQL básico\r\n    let query = `SELECT ${selectClause}\\nFROM ${tables[0]}`;\r\n    \r\n    // Si hay múltiples tablas, agregar JOINs básicos (esto es simplificado)\r\n    for (let i = 1; i < tables.length; i++) {\r\n      query += `\\nLEFT JOIN ${tables[i]} ON ${tables[0]}.${tables[i]}ID = ${tables[i]}.${tables[i]}ID`;\r\n    }\r\n    \r\n    query += \"\\nLIMIT 100\";\r\n    \r\n    setSqlQuery(query);\r\n  }, [selectedFields]);\r\n\r\n  // Manejar selección de campos\r\n  const toggleField = (field) => {\r\n    const isSelected = selectedFields.some(f => f.table === field.table && f.name === field.name);\r\n    \r\n    if (isSelected) {\r\n      setSelectedFields(selectedFields.filter(f => !(f.table === field.table && f.name === field.name)));\r\n    } else {\r\n      setSelectedFields([...selectedFields, field]);\r\n    }\r\n  };\r\n\r\n  // Ejecutar consulta\r\n  const ejecutarConsulta = async () => {\r\n    if (!sqlQuery.trim()) {\r\n      alert(\"No hay consulta para ejecutar\");\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const response = await fetch(`${API_URL}/reportes/custom`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${getStoredToken()}`\r\n        },\r\n        body: JSON.stringify({ sqlQuery })\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json();\r\n        throw new Error(errorData.details || `Error ${response.status}`);\r\n      }\r\n\r\n      const result = await response.json();\r\n      setData(result.data || []);\r\n      \r\n      // Datos de ejemplo si no hay respuesta del servidor\r\n      if (!result.data || result.data.length === 0) {\r\n        const mockData = [\r\n          { Departamento: \"Ventas\", Empleados: 25, Promedio: 45000 },\r\n          { Departamento: \"IT\", Empleados: 18, Promedio: 55000 },\r\n          { Departamento: \"RRHH\", Empleados: 12, Promedio: 48000 },\r\n          { Departamento: \"Marketing\", Empleados: 15, Promedio: 42000 }\r\n        ];\r\n        setData(mockData);\r\n      }\r\n      \r\n    } catch (err) {\r\n      console.error(\"Error ejecutando consulta:\", err);\r\n      setError(err.message);\r\n      \r\n      // Datos de ejemplo para demostración\r\n      const mockData = [\r\n        { Departamento: \"Ventas\", Empleados: 25, Promedio: 45000 },\r\n        { Departamento: \"IT\", Empleados: 18, Promedio: 55000 },\r\n        { Departamento: \"RRHH\", Empleados: 12, Promedio: 48000 }\r\n      ];\r\n      setData(mockData);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Guardar reporte\r\n  const guardarReporte = async (nuevoReporte) => {\r\n    try {\r\n      const reporteData = {\r\n        ...nuevoReporte,\r\n        configuracion: {\r\n          selectedFields,\r\n          sqlQuery\r\n        }\r\n      };\r\n\r\n      const response = await fetch(`${API_URL}/reportes/guardados`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${getStoredToken()}`\r\n        },\r\n        body: JSON.stringify(reporteData)\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json();\r\n        throw new Error(errorData.details || `Error ${response.status}`);\r\n      }\r\n\r\n      const saved = await response.json();\r\n      setReportes([...reportes, saved]);\r\n      setShowModal(false);\r\n      alert(\"Reporte guardado exitosamente\");\r\n      \r\n    } catch (err) {\r\n      console.error(\"Error guardando reporte:\", err);\r\n      \r\n      // Simulación para demostración\r\n      const nuevoId = Date.now();\r\n      const reporteSimulado = {\r\n        id: nuevoId,\r\n        ...nuevoReporte,\r\n        fechaCreacion: new Date().toISOString().split('T')[0],\r\n        modificadoPor: \"Usuario Demo\"\r\n      };\r\n      \r\n      setReportes([...reportes, reporteSimulado]);\r\n      setShowModal(false);\r\n      alert(\"Reporte guardado exitosamente (simulado)\");\r\n    }\r\n  };\r\n\r\n  // Exportar datos\r\n  const exportarDatos = async (formato) => {\r\n    if (data.length === 0) {\r\n      alert(\"No hay datos para exportar\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(`${API_URL}/reportes/export`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${getStoredToken()}`\r\n        },\r\n        body: JSON.stringify({\r\n          formato,\r\n          data,\r\n          nombre: `reporte_${new Date().toISOString().split('T')[0]}`\r\n        })\r\n      });\r\n\r\n      if (response.ok) {\r\n        const blob = await response.blob();\r\n        const url = window.URL.createObjectURL(blob);\r\n        const link = document.createElement('a');\r\n        link.href = url;\r\n        link.download = `reporte.${formato}`;\r\n        link.click();\r\n        window.URL.revokeObjectURL(url);\r\n      } else {\r\n        throw new Error(`Error ${response.status}`);\r\n      }\r\n      \r\n    } catch (err) {\r\n      console.error(\"Error exportando:\", err);\r\n      \r\n      // Exportación simulada para CSV\r\n      if (formato === 'csv') {\r\n        const csv = [\r\n          Object.keys(data[0]).join(','),\r\n          ...data.map(row => Object.values(row).join(','))\r\n        ].join('\\n');\r\n        \r\n        const blob = new Blob([csv], { type: 'text/csv' });\r\n        const url = URL.createObjectURL(blob);\r\n        const link = document.createElement('a');\r\n        link.href = url;\r\n        link.download = 'reporte.csv';\r\n        link.click();\r\n        URL.revokeObjectURL(url);\r\n      }\r\n    }\r\n  };\r\n\r\n  // Limpiar selección\r\n  const limpiarSeleccion = () => {\r\n    setSelectedFields([]);\r\n    setSqlQuery(\"\");\r\n    setData([]);\r\n    setError(null);\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6 max-w-7xl mx-auto\">\r\n      {/* Header */}\r\n      <div className=\"flex justify-between items-center mb-6\">\r\n        <h1 className=\"text-3xl font-bold flex items-center gap-3\">\r\n          <BarChart3 className=\"w-8 h-8 text-blue-600\" />\r\n          Generador de Reportes\r\n        </h1>\r\n        <div className=\"flex gap-2\">\r\n          <button\r\n            onClick={limpiarSeleccion}\r\n            className=\"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600\"\r\n          >\r\n            Limpiar\r\n          </button>\r\n          <button\r\n            onClick={() => setShowModal(true)}\r\n            className=\"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 flex items-center gap-2\"\r\n          >\r\n            <Plus className=\"w-4 h-4\" /> Nuevo Reporte\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Mensajes de estado */}\r\n      {error && (\r\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex justify-between items-center\">\r\n          <span className=\"text-red-700\">{error}</span>\r\n          <button onClick={() => setError(null)} className=\"text-red-500 hover:text-red-700\">×</button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Reportes guardados */}\r\n      <div className=\"bg-white rounded-lg shadow-sm mb-6\">\r\n        <div className=\"p-4 border-b\">\r\n          <h3 className=\"text-lg font-semibold flex items-center gap-2\">\r\n            <FileText className=\"w-5 h-5\" />\r\n            Reportes Guardados ({reportes.length})\r\n          </h3>\r\n        </div>\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"w-full\">\r\n            <thead className=\"bg-gray-50\">\r\n              <tr>\r\n                <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-700\">Nombre</th>\r\n                <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-700\">Origen</th>\r\n                <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-700\">Descripción</th>\r\n                <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-700\">Fecha</th>\r\n                <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-700\">Acciones</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody className=\"divide-y divide-gray-200\">\r\n              {reportes.length === 0 ? (\r\n                <tr>\r\n                  <td colSpan=\"5\" className=\"px-4 py-8 text-center text-gray-500\">\r\n                    No hay reportes guardados. Crea tu primer reporte.\r\n                  </td>\r\n                </tr>\r\n              ) : (\r\n                reportes.map((reporte) => (\r\n                  <tr key={reporte.id} className=\"hover:bg-gray-50\">\r\n                    <td className=\"px-4 py-3 font-medium\">{reporte.nombre}</td>\r\n                    <td className=\"px-4 py-3 text-gray-600\">{reporte.origen || \"-\"}</td>\r\n                    <td className=\"px-4 py-3 text-gray-600\">{reporte.descripcion || \"-\"}</td>\r\n                    <td className=\"px-4 py-3 text-gray-600\">{reporte.fechaCreacion || \"-\"}</td>\r\n                    <td className=\"px-4 py-3\">\r\n                      <div className=\"flex gap-2\">\r\n                        <button className=\"text-blue-600 hover:underline text-sm\">Ejecutar</button>\r\n                        <button className=\"text-green-600 hover:underline text-sm\">Editar</button>\r\n                        <button className=\"text-red-600 hover:underline text-sm\">Eliminar</button>\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                ))\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Constructor de reporte simplificado */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6\">\r\n        {/* Selección de campos */}\r\n        <div className=\"bg-white rounded-lg shadow-sm\">\r\n          <div className=\"p-4 border-b\">\r\n            <h3 className=\"text-lg font-semibold\">Seleccionar Campos</h3>\r\n            <p className=\"text-sm text-gray-600 mt-1\">\r\n              Haz clic en los campos que deseas incluir en tu reporte\r\n            </p>\r\n          </div>\r\n          <div className=\"p-4 max-h-96 overflow-y-auto\">\r\n            {Object.entries(metadata).map(([table, fields]) => (\r\n              <div key={table} className=\"mb-4\">\r\n                <h4 className=\"font-medium text-gray-800 mb-2 flex items-center gap-2\">\r\n                  <Database className=\"w-4 h-4\" />\r\n                  {table}\r\n                </h4>\r\n                <div className=\"ml-6 space-y-1\">\r\n                  {fields.map((field) => (\r\n                    <SelectableField\r\n                      key={`${table}-${field}`}\r\n                      name={field}\r\n                      table={table}\r\n                      isSelected={selectedFields.some(f => f.table === table && f.name === field)}\r\n                      onToggle={toggleField}\r\n                    />\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Editor SQL */}\r\n        <div className=\"bg-white rounded-lg shadow-sm\">\r\n          <div className=\"p-4 border-b\">\r\n            <h3 className=\"text-lg font-semibold\">Consulta SQL</h3>\r\n            <p className=\"text-sm text-gray-600 mt-1\">\r\n              Se genera automáticamente o puedes editarla manualmente\r\n            </p>\r\n          </div>\r\n          <div className=\"p-4\">\r\n            <div className=\"mb-4\">\r\n              <label className=\"block text-sm font-medium mb-2\">Campos seleccionados:</label>\r\n              <div className=\"flex flex-wrap gap-1 mb-3 min-h-[2rem] p-2 border rounded bg-gray-50\">\r\n                {selectedFields.length === 0 ? (\r\n                  <span className=\"text-gray-500 text-sm\">Ningún campo seleccionado</span>\r\n                ) : (\r\n                  selectedFields.map((field, index) => (\r\n                    <span\r\n                      key={index}\r\n                      className=\"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded\"\r\n                    >\r\n                      {field.table}.{field.name}\r\n                      <button\r\n                        onClick={() => toggleField(field)}\r\n                        className=\"text-blue-600 hover:text-blue-800\"\r\n                      >\r\n                        ×\r\n                      </button>\r\n                    </span>\r\n                  ))\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            <textarea\r\n              value={sqlQuery}\r\n              onChange={(e) => setSqlQuery(e.target.value)}\r\n              className=\"w-full border rounded p-3 font-mono text-sm\"\r\n              rows={8}\r\n              placeholder=\"SELECT * FROM tabla WHERE condicion...\"\r\n            />\r\n\r\n            <div className=\"flex gap-2 mt-4\">\r\n              <button\r\n                onClick={ejecutarConsulta}\r\n                disabled={loading || !sqlQuery.trim()}\r\n                className=\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2\"\r\n              >\r\n                <Play className=\"w-4 h-4\" />\r\n                {loading ? \"Ejecutando...\" : \"Ejecutar\"}\r\n              </button>\r\n\r\n              {data.length > 0 && (\r\n                <div className=\"flex gap-1\">\r\n                  <button\r\n                    onClick={() => exportarDatos('csv')}\r\n                    className=\"bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700 flex items-center gap-1\"\r\n                  >\r\n                    <Download className=\"w-4 h-4\" /> CSV\r\n                  </button>\r\n                  <button\r\n                    onClick={() => exportarDatos('excel')}\r\n                    className=\"bg-orange-600 text-white px-3 py-2 rounded hover:bg-orange-700 flex items-center gap-1\"\r\n                  >\r\n                    <Download className=\"w-4 h-4\" /> Excel\r\n                  </button>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Resultados */}\r\n      {data.length > 0 && (\r\n        <div className=\"bg-white rounded-lg shadow-sm\">\r\n          <div className=\"p-4 border-b\">\r\n            <h3 className=\"text-lg font-semibold\">\r\n              Resultados ({data.length} registros)\r\n            </h3>\r\n          </div>\r\n          \r\n          <div className=\"p-4\">\r\n            {/* Gráfico */}\r\n            <div className=\"mb-6\">\r\n              <ResponsiveContainer width=\"100%\" height={300}>\r\n                <BarChart data={data.slice(0, 10)}>\r\n                  <XAxis dataKey={Object.keys(data[0])[0]} />\r\n                  <YAxis />\r\n                  <Tooltip />\r\n                  <Legend />\r\n                  <Bar dataKey={Object.keys(data[0])[1]} fill=\"#3B82F6\" />\r\n                </BarChart>\r\n              </ResponsiveContainer>\r\n            </div>\r\n\r\n            {/* Tabla */}\r\n            <div className=\"overflow-x-auto\">\r\n              <table className=\"w-full border\">\r\n                <thead className=\"bg-gray-50\">\r\n                  <tr>\r\n                    {Object.keys(data[0]).map((key) => (\r\n                      <th key={key} className=\"border px-3 py-2 text-left font-medium text-sm\">\r\n                        {key}\r\n                      </th>\r\n                    ))}\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {data.slice(0, 50).map((row, index) => (\r\n                    <tr key={index} className=\"hover:bg-gray-50\">\r\n                      {Object.values(row).map((value, cellIndex) => (\r\n                        <td key={cellIndex} className=\"border px-3 py-2 text-sm\">\r\n                          {value}\r\n                        </td>\r\n                      ))}\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n              {data.length > 50 && (\r\n                <p className=\"text-sm text-gray-500 mt-2 text-center\">\r\n                  Mostrando primeros 50 de {data.length} registros\r\n                </p>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modal */}\r\n      <NuevoReporteModal\r\n        show={showModal}\r\n        onClose={() => setShowModal(false)}\r\n        onSave={guardarReporte}\r\n        metadata={metadata}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ReportesModule;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}