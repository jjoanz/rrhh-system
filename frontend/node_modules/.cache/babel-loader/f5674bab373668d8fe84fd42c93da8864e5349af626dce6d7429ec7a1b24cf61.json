{"ast":null,"code":"// src/modules/ReportesModule.jsx - Con funcionalidad de exportación\nimport React,{useState,useEffect}from\"react\";import{DndProvider,useDrag,useDrop}from\"react-dnd\";import{HTML5Backend}from\"react-dnd-html5-backend\";import{BarChart,Bar,XAxis,YAxis,Tooltip,Legend,ResponsiveContainer,LineChart,Line,PieChart,Pie}from\"recharts\";import{Play,Save,Plus,Database,Download,Filter,FileText,BarChart3,GripVertical}from\"lucide-react\";import{useAuth}from\"../../../context/AuthContext\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL||\"http://192.168.0.239:5000/api\";// Componente para campos arrastrables\nconst DraggableField=_ref=>{let{name,table,type=\"text\"}=_ref;const[{isDragging},drag]=useDrag(()=>({type:\"FIELD\",item:{name,table,type},collect:monitor=>({isDragging:!!monitor.isDragging()})}));return/*#__PURE__*/_jsxs(\"div\",{ref:drag,className:`flex items-center gap-2 p-2 m-1 border rounded-lg shadow-sm cursor-move bg-white hover:bg-gray-50 transition-all ${isDragging?\"opacity-50 scale-95\":\"opacity-100\"}`,title:`${table}.${name} (${type})`,children:[/*#__PURE__*/_jsx(GripVertical,{className:\"w-4 h-4 text-gray-400\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-gray-600 font-mono\",children:[table,\".\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium\",children:name})]});};// DropZone para filas, columnas y métricas\nconst DropZone=_ref2=>{let{title,fields,onDrop,onRemove,icon}=_ref2;const[{isOver},drop]=useDrop(()=>({accept:\"FIELD\",drop:item=>onDrop(item),collect:monitor=>({isOver:!!monitor.isOver()})}));return/*#__PURE__*/_jsxs(\"div\",{ref:drop,className:`min-h-[100px] p-3 rounded-lg border-2 border-dashed transition-all ${isOver?\"bg-blue-50 border-blue-400\":\"border-gray-300 bg-gray-50\"}`,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-3\",children:[icon,/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-gray-700\",children:title}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-gray-500\",children:[\"(\",fields.length,\")\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:fields.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400 italic\",children:\"Arrastra campos aqu\\xED\"}):fields.map((field,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 px-3 py-1 bg-blue-100 border border-blue-200 rounded-full text-sm\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"font-mono text-xs text-gray-600\",children:[field.table,\".\"]}),/*#__PURE__*/_jsx(\"span\",{children:field.name}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>onRemove(index),className:\"text-red-500 hover:text-red-700 ml-1\",type:\"button\",\"aria-label\":\"Quitar campo\",children:\"\\xD7\"})]},`${field.table}-${field.name}-${index}`))})]});};// Modal para crear un nuevo reporte\nconst NuevoReporteModal=_ref3=>{let{show,onClose,onSave,metadata}=_ref3;const[formData,setFormData]=useState({nombre:\"\",origen:\"\",descripcion:\"\"});const handleSave=()=>{if(!formData.nombre.trim()||!formData.origen){alert(\"Nombre y origen son requeridos\");return;}onSave(formData);setFormData({nombre:\"\",origen:\"\",descripcion:\"\"});};if(!show)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg shadow-xl w-96\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-4\",children:[/*#__PURE__*/_jsx(Plus,{className:\"w-5 h-5 text-green-600\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold\",children:\"Nuevo Reporte\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-medium mb-1\",children:\"Nombre *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.nombre,onChange:e=>setFormData({...formData,nombre:e.target.value}),className:\"w-full border p-2 rounded\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-medium mb-1\",children:\"Origen *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.origen,onChange:e=>setFormData({...formData,origen:e.target.value}),className:\"w-full border p-2 rounded\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Seleccionar\"}),Object.keys(metadata).map(table=>/*#__PURE__*/_jsx(\"option\",{value:table,children:table},table))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-medium mb-1\",children:\"Descripci\\xF3n\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.descripcion,onChange:e=>setFormData({...formData,descripcion:e.target.value}),className:\"w-full border p-2 rounded\",rows:3})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-2 mt-6\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"px-4 py-2 bg-gray-300 rounded\",type:\"button\",children:\"Cancelar\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleSave,className:\"px-4 py-2 bg-blue-600 text-white rounded flex items-center gap-2\",type:\"button\",children:[/*#__PURE__*/_jsx(Save,{className:\"w-4 h-4\"}),\" Crear\"]})]})]})});};// Componente para exportación\nconst ExportButtons=_ref4=>{let{data,onExport,loading}=_ref4;const[showMenu,setShowMenu]=useState(false);const formats=[{key:'excel',label:'Excel (.xlsx)',icon:'📊'},{key:'csv',label:'CSV (.csv)',icon:'📄'},{key:'pdf',label:'PDF (.pdf)',icon:'📋'},{key:'json',label:'JSON (.json)',icon:'🔧'}];return/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowMenu(!showMenu),disabled:data.length===0||loading,className:\"bg-green-600 text-white px-4 py-2 rounded flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed\",type:\"button\",children:[/*#__PURE__*/_jsx(Download,{className:\"w-4 h-4\"}),\"Exportar\"]}),showMenu&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute right-0 mt-2 w-48 bg-white border rounded-lg shadow-lg z-10\",children:/*#__PURE__*/_jsx(\"div\",{className:\"py-1\",children:formats.map(format=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{onExport(format.key);setShowMenu(false);},className:\"w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center gap-2\",type:\"button\",children:[/*#__PURE__*/_jsx(\"span\",{children:format.icon}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:format.label})]},format.key))})})]});};// Módulo principal de reportes\nconst ReportesModule=()=>{const{user,getStoredToken}=useAuth();const[metadata,setMetadata]=useState({});const[reportes,setReportes]=useState([]);const[showModal,setShowModal]=useState(false);const[rows,setRows]=useState([]);const[columns,setColumns]=useState([]);const[metrics,setMetrics]=useState([]);const[sqlQuery,setSqlQuery]=useState(\"\");const[customSql,setCustomSql]=useState(\"\");const[data,setData]=useState([]);const[chartType,setChartType]=useState(\"bar\");const[loading,setLoading]=useState(false);const[exportLoading,setExportLoading]=useState(false);const[error,setError]=useState(null);// CARGAR METADATA Y REPORTES GUARDADOS\nuseEffect(()=>{const fetchData=async()=>{try{const token=getStoredToken();if(!token){setError(\"No hay token de autenticación\");return;}const headers={'Authorization':`Bearer ${token}`,'Content-Type':'application/json'};const[metaRes,repRes]=await Promise.all([fetch(`${API_URL}/reportes/metadata`,{headers}),fetch(`${API_URL}/reportes/guardados`,{headers})]);if(!metaRes.ok){throw new Error(`Error metadata: ${metaRes.status}`);}if(!repRes.ok){throw new Error(`Error reportes: ${repRes.status}`);}const metaData=await metaRes.json();const repData=await repRes.json();setMetadata(metaData.simplified||metaData);if(Array.isArray(repData)){setReportes(repData);}else{console.warn(\"Respuesta de reportes no es un array:\",repData);setReportes([]);}setError(null);}catch(err){console.error(\"Error cargando datos:\",err);setError(err.message);}};fetchData();},[getStoredToken]);// Generar SQL dinámico\nuseEffect(()=>{if(rows.length===0&&columns.length===0&&metrics.length===0){setSqlQuery(\"\");return;}const allFields=[...rows,...columns,...metrics];const tables=[...new Set(allFields.map(f=>f.table))];const selectFields=allFields.map(f=>`${f.table}.${f.name}`).join(\", \");let query=`SELECT ${selectFields} FROM ${tables.join(\", \")}`;if(rows.length||columns.length){query+=` GROUP BY ${[...rows,...columns].map(f=>`${f.table}.${f.name}`).join(\", \")}`;}setSqlQuery(query);},[rows,columns,metrics]);// EJECUTAR REPORTE\nconst ejecutarReporte=async()=>{const query=customSql||sqlQuery;if(!query.trim()){alert(\"No hay consulta para ejecutar\");return;}setLoading(true);setError(null);try{const res=await fetch(`${API_URL}/reportes/custom`,{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${getStoredToken()}`},body:JSON.stringify({sqlQuery:query})});if(!res.ok){const errorData=await res.json();throw new Error(errorData.details||`Error ${res.status}`);}const result=await res.json();setData(result.data||result);}catch(err){console.error(\"Error ejecutando reporte:\",err);setError(err.message);}finally{setLoading(false);}};// EXPORTAR REPORTE\nconst exportarReporte=async formato=>{if(data.length===0){alert(\"No hay datos para exportar\");return;}setExportLoading(true);try{const res=await fetch(`${API_URL}/reportes/export`,{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${getStoredToken()}`},body:JSON.stringify({formato,data,nombre:`reporte_${new Date().toISOString().split('T')[0]}`})});if(!res.ok){const errorData=await res.json();throw new Error(errorData.details||`Error ${res.status}`);}// Descargar archivo\nconst blob=await res.blob();const url=window.URL.createObjectURL(blob);const link=document.createElement('a');link.href=url;// Determinar extensión del archivo\nconst extensions={excel:'xlsx',csv:'csv',pdf:'pdf',json:'json'};link.download=`reporte_${new Date().toISOString().split('T')[0]}.${extensions[formato]}`;document.body.appendChild(link);link.click();document.body.removeChild(link);window.URL.revokeObjectURL(url);console.log(`Archivo ${formato} descargado exitosamente`);}catch(err){console.error(\"Error exportando reporte:\",err);alert(\"Error al exportar: \"+err.message);}finally{setExportLoading(false);}};// GUARDAR REPORTE\nconst guardarReporte=async nuevo=>{try{const res=await fetch(`${API_URL}/reportes/guardados`,{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${getStoredToken()}`},body:JSON.stringify({...nuevo,configuracion:{rows,columns,metrics,sqlQuery:customSql||sqlQuery}})});if(!res.ok){const errorData=await res.json();throw new Error(errorData.details||`Error ${res.status}`);}const saved=await res.json();setReportes([...reportes,saved]);setShowModal(false);alert(\"Reporte guardado exitosamente\");}catch(err){console.error(\"Error guardando reporte:\",err);alert(\"Error guardando reporte: \"+err.message);}};// Funciones helper para drag & drop\nconst addFieldToArray=(array,setter)=>field=>{const exists=array.some(f=>f.table===field.table&&f.name===field.name);if(!exists){setter([...array,field]);}};const removeFieldFromArray=(array,setter)=>index=>{setter(array.filter((_,i)=>i!==index));};// Renderizar gráfico según tipo\nconst renderChart=()=>{if(data.length===0)return null;const keys=Object.keys(data[0]||{});if(keys.length<2)return null;switch(chartType){case\"line\":return/*#__PURE__*/_jsxs(LineChart,{data:data,width:600,height:300,children:[/*#__PURE__*/_jsx(XAxis,{dataKey:keys[0]}),/*#__PURE__*/_jsx(YAxis,{}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Legend,{}),/*#__PURE__*/_jsx(Line,{dataKey:keys[1],stroke:\"#8884d8\"})]});case\"pie\":return/*#__PURE__*/_jsxs(PieChart,{width:600,height:300,children:[/*#__PURE__*/_jsx(Pie,{data:data,dataKey:keys[1],nameKey:keys[0],label:true}),/*#__PURE__*/_jsx(Tooltip,{})]});default:return/*#__PURE__*/_jsxs(BarChart,{data:data,width:600,height:300,children:[/*#__PURE__*/_jsx(XAxis,{dataKey:keys[0]}),/*#__PURE__*/_jsx(YAxis,{}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Legend,{}),/*#__PURE__*/_jsx(Bar,{dataKey:keys[1],fill:\"#8884d8\"})]});}};return/*#__PURE__*/_jsx(DndProvider,{backend:HTML5Backend,children:/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-6\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"text-2xl font-bold flex items-center gap-2\",children:[/*#__PURE__*/_jsx(BarChart3,{className:\"w-7 h-7 text-blue-600\"}),\" Generador de Reportes\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowModal(true),className:\"bg-green-600 text-white px-4 py-2 rounded flex items-center gap-2\",type:\"button\",children:[/*#__PURE__*/_jsx(Plus,{className:\"w-4 h-4\"}),\" Nuevo Reporte\"]})]}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-red-700\",children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setError(null),className:\"text-red-500 hover:text-red-700\",children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 border-b flex items-center gap-2\",children:[/*#__PURE__*/_jsx(FileText,{className:\"w-5 h-5 text-gray-600\"}),\"Reportes Guardados (\",Array.isArray(reportes)?reportes.length:0,\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full text-sm\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"p-2 text-left\",children:\"Nombre\"}),/*#__PURE__*/_jsx(\"th\",{className:\"p-2 text-left\",children:\"Origen\"}),/*#__PURE__*/_jsx(\"th\",{className:\"p-2 text-left\",children:\"Descripci\\xF3n\"}),/*#__PURE__*/_jsx(\"th\",{className:\"p-2 text-left\",children:\"Acciones\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:Array.isArray(reportes)&&reportes.length>0?reportes.map(r=>/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:r.nombre}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:r.origen}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:r.descripcion||\"-\"}),/*#__PURE__*/_jsxs(\"td\",{className:\"p-2 flex gap-1\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"text-blue-600 hover:underline\",type:\"button\",children:\"Ver\"}),/*#__PURE__*/_jsx(\"button\",{className:\"text-green-600 hover:underline\",type:\"button\",children:\"Editar\"}),/*#__PURE__*/_jsx(\"button\",{className:\"text-red-600 hover:underline\",type:\"button\",children:\"Eliminar\"})]})]},r.id)):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"4\",className:\"p-4 text-center text-gray-500\",children:\"No hay reportes guardados\"})})})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"font-semibold mb-2 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Database,{className:\"w-5 h-5\"}),\" Editor SQL\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium mb-1\",children:\"SQL Generado autom\\xE1ticamente:\"}),/*#__PURE__*/_jsx(\"textarea\",{value:sqlQuery,readOnly:true,className:\"w-full border p-2 text-sm font-mono bg-gray-50\",rows:3,placeholder:\"Se genera autom\\xE1ticamente al arrastrar campos...\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium mb-1\",children:\"SQL Personalizado:\"}),/*#__PURE__*/_jsx(\"textarea\",{value:customSql,onChange:e=>setCustomSql(e.target.value),className:\"w-full border p-2 text-sm font-mono\",rows:3,placeholder:\"O escribe tu consulta personalizada aqu\\xED...\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:ejecutarReporte,disabled:loading,className:\"bg-blue-600 text-white px-4 py-2 rounded flex items-center gap-2 disabled:opacity-50\",type:\"button\",children:[/*#__PURE__*/_jsx(Play,{className:\"w-4 h-4\"}),loading?\"Ejecutando...\":\"Ejecutar\"]}),/*#__PURE__*/_jsx(ExportButtons,{data:data,onExport:exportarReporte,loading:exportLoading})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-4\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"font-semibold mb-2 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(GripVertical,{className:\"w-5 h-5\"}),\" Campos Disponibles\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"max-h-96 overflow-y-auto\",children:Object.keys(metadata).length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm\",children:\"Cargando campos...\"}):Object.entries(metadata).map(_ref5=>{let[table,fields]=_ref5;return/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-gray-700 mb-2\",children:table}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-1\",children:Array.isArray(fields)?fields.map(field=>/*#__PURE__*/_jsx(DraggableField,{table:table,name:field},`${table}-${field}`)):null})]},table);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-2 space-y-4\",children:[/*#__PURE__*/_jsx(DropZone,{title:\"Filas\",fields:rows,onDrop:addFieldToArray(rows,setRows),onRemove:removeFieldFromArray(rows,setRows),icon:/*#__PURE__*/_jsx(Filter,{className:\"w-4 h-4 text-blue-600\"})}),/*#__PURE__*/_jsx(DropZone,{title:\"Columnas\",fields:columns,onDrop:addFieldToArray(columns,setColumns),onRemove:removeFieldFromArray(columns,setColumns),icon:/*#__PURE__*/_jsx(BarChart3,{className:\"w-4 h-4 text-green-600\"})}),/*#__PURE__*/_jsx(DropZone,{title:\"M\\xE9tricas\",fields:metrics,onDrop:addFieldToArray(metrics,setMetrics),onRemove:removeFieldFromArray(metrics,setMetrics),icon:/*#__PURE__*/_jsx(Database,{className:\"w-4 h-4 text-purple-600\"})})]})]}),data.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-4 mt-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"font-semibold\",children:[\"Resultados (\",data.length,\" registros)\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 items-center\",children:[/*#__PURE__*/_jsxs(\"select\",{value:chartType,onChange:e=>setChartType(e.target.value),className:\"border p-1 rounded text-sm\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"bar\",children:\"Gr\\xE1fico de Barras\"}),/*#__PURE__*/_jsx(\"option\",{value:\"line\",children:\"Gr\\xE1fico de L\\xEDneas\"}),/*#__PURE__*/_jsx(\"option\",{value:\"pie\",children:\"Gr\\xE1fico Circular\"})]}),/*#__PURE__*/_jsx(ExportButtons,{data:data,onExport:exportarReporte,loading:exportLoading})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:300,children:renderChart()})}),/*#__PURE__*/_jsxs(\"div\",{className:\"overflow-x-auto\",children:[/*#__PURE__*/_jsxs(\"table\",{className:\"w-full text-sm border\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsx(\"tr\",{children:Object.keys(data[0]||{}).map(key=>/*#__PURE__*/_jsx(\"th\",{className:\"border p-2 text-left font-medium\",children:key},key))})}),/*#__PURE__*/_jsx(\"tbody\",{children:data.slice(0,50).map((row,index)=>/*#__PURE__*/_jsx(\"tr\",{className:\"hover:bg-gray-50\",children:Object.values(row).map((value,cellIndex)=>/*#__PURE__*/_jsx(\"td\",{className:\"border p-2\",children:value},cellIndex))},index))})]}),data.length>50&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500 mt-2 text-center\",children:[\"Mostrando primeros 50 de \",data.length,\" registros\"]})]})]}),/*#__PURE__*/_jsx(NuevoReporteModal,{show:showModal,onClose:()=>setShowModal(false),onSave:guardarReporte,metadata:metadata})]})});};export default ReportesModule;","map":{"version":3,"names":["React","useState","useEffect","DndProvider","useDrag","useDrop","HTML5Backend","BarChart","Bar","XAxis","YAxis","Tooltip","Legend","ResponsiveContainer","LineChart","Line","PieChart","Pie","Play","Save","Plus","Database","Download","Filter","FileText","BarChart3","GripVertical","useAuth","jsx","_jsx","jsxs","_jsxs","API_URL","process","env","REACT_APP_API_URL","DraggableField","_ref","name","table","type","isDragging","drag","item","collect","monitor","ref","className","title","children","DropZone","_ref2","fields","onDrop","onRemove","icon","isOver","drop","accept","length","map","field","index","onClick","NuevoReporteModal","_ref3","show","onClose","onSave","metadata","formData","setFormData","nombre","origen","descripcion","handleSave","trim","alert","value","onChange","e","target","Object","keys","rows","ExportButtons","_ref4","data","onExport","loading","showMenu","setShowMenu","formats","key","label","disabled","format","ReportesModule","user","getStoredToken","setMetadata","reportes","setReportes","showModal","setShowModal","setRows","columns","setColumns","metrics","setMetrics","sqlQuery","setSqlQuery","customSql","setCustomSql","setData","chartType","setChartType","setLoading","exportLoading","setExportLoading","error","setError","fetchData","token","headers","metaRes","repRes","Promise","all","fetch","ok","Error","status","metaData","json","repData","simplified","Array","isArray","console","warn","err","message","allFields","tables","Set","f","selectFields","join","query","ejecutarReporte","res","method","Authorization","body","JSON","stringify","errorData","details","result","exportarReporte","formato","Date","toISOString","split","blob","url","window","URL","createObjectURL","link","document","createElement","href","extensions","excel","csv","pdf","download","appendChild","click","removeChild","revokeObjectURL","log","guardarReporte","nuevo","configuracion","saved","addFieldToArray","array","setter","exists","some","removeFieldFromArray","filter","_","i","renderChart","width","height","dataKey","stroke","nameKey","fill","backend","r","id","colSpan","readOnly","placeholder","entries","_ref5","slice","row","values","cellIndex"],"sources":["C:/Users/josemontedeoca/rrhh-system/frontend/src/components/modules/Reportes/ReportesModule.jsx"],"sourcesContent":["// src/modules/ReportesModule.jsx - Con funcionalidad de exportación\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { DndProvider, useDrag, useDrop } from \"react-dnd\";\r\nimport { HTML5Backend } from \"react-dnd-html5-backend\";\r\nimport {\r\n  BarChart, Bar, XAxis, YAxis, Tooltip, Legend,\r\n  ResponsiveContainer, LineChart, Line, PieChart, Pie\r\n} from \"recharts\";\r\nimport {\r\n  Play, Save, Plus, Database, Download,\r\n  Filter, FileText, BarChart3, GripVertical\r\n} from \"lucide-react\";\r\nimport { useAuth } from \"../../../context/AuthContext\";\r\n\r\nconst API_URL = process.env.REACT_APP_API_URL || \"http://192.168.0.239:5000/api\";\r\n\r\n// Componente para campos arrastrables\r\nconst DraggableField = ({ name, table, type = \"text\" }) => {\r\n  const [{ isDragging }, drag] = useDrag(() => ({\r\n    type: \"FIELD\",\r\n    item: { name, table, type },\r\n    collect: (monitor) => ({ isDragging: !!monitor.isDragging() }),\r\n  }));\r\n  return (\r\n    <div\r\n      ref={drag}\r\n      className={`flex items-center gap-2 p-2 m-1 border rounded-lg shadow-sm cursor-move bg-white hover:bg-gray-50 transition-all ${\r\n        isDragging ? \"opacity-50 scale-95\" : \"opacity-100\"\r\n      }`}\r\n      title={`${table}.${name} (${type})`}\r\n    >\r\n      <GripVertical className=\"w-4 h-4 text-gray-400\" />\r\n      <span className=\"text-xs text-gray-600 font-mono\">{table}.</span>\r\n      <span className=\"text-sm font-medium\">{name}</span>\r\n    </div>\r\n  );\r\n};\r\n\r\n// DropZone para filas, columnas y métricas\r\nconst DropZone = ({ title, fields, onDrop, onRemove, icon }) => {\r\n  const [{ isOver }, drop] = useDrop(() => ({\r\n    accept: \"FIELD\",\r\n    drop: (item) => onDrop(item),\r\n    collect: (monitor) => ({ isOver: !!monitor.isOver() }),\r\n  }));\r\n  return (\r\n    <div\r\n      ref={drop}\r\n      className={`min-h-[100px] p-3 rounded-lg border-2 border-dashed transition-all ${\r\n        isOver ? \"bg-blue-50 border-blue-400\" : \"border-gray-300 bg-gray-50\"\r\n      }`}\r\n    >\r\n      <div className=\"flex items-center gap-2 mb-3\">\r\n        {icon}\r\n        <h4 className=\"font-semibold text-gray-700\">{title}</h4>\r\n        <span className=\"text-xs text-gray-500\">({fields.length})</span>\r\n      </div>\r\n      <div className=\"flex flex-wrap gap-2\">\r\n        {fields.length === 0 ? (\r\n          <p className=\"text-sm text-gray-400 italic\">Arrastra campos aquí</p>\r\n        ) : (\r\n          fields.map((field, index) => (\r\n            <div\r\n              key={`${field.table}-${field.name}-${index}`}\r\n              className=\"flex items-center gap-2 px-3 py-1 bg-blue-100 border border-blue-200 rounded-full text-sm\"\r\n            >\r\n              <span className=\"font-mono text-xs text-gray-600\">{field.table}.</span>\r\n              <span>{field.name}</span>\r\n              <button\r\n                onClick={() => onRemove(index)}\r\n                className=\"text-red-500 hover:text-red-700 ml-1\"\r\n                type=\"button\"\r\n                aria-label=\"Quitar campo\"\r\n              >\r\n                ×\r\n              </button>\r\n            </div>\r\n          ))\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Modal para crear un nuevo reporte\r\nconst NuevoReporteModal = ({ show, onClose, onSave, metadata }) => {\r\n  const [formData, setFormData] = useState({\r\n    nombre: \"\",\r\n    origen: \"\",\r\n    descripcion: \"\",\r\n  });\r\n\r\n  const handleSave = () => {\r\n    if (!formData.nombre.trim() || !formData.origen) {\r\n      alert(\"Nombre y origen son requeridos\");\r\n      return;\r\n    }\r\n    onSave(formData);\r\n    setFormData({ nombre: \"\", origen: \"\", descripcion: \"\" });\r\n  };\r\n\r\n  if (!show) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50\">\r\n      <div className=\"bg-white p-6 rounded-lg shadow-xl w-96\">\r\n        <div className=\"flex items-center gap-2 mb-4\">\r\n          <Plus className=\"w-5 h-5 text-green-600\" />\r\n          <h3 className=\"text-lg font-bold\">Nuevo Reporte</h3>\r\n        </div>\r\n        <div className=\"space-y-4\">\r\n          <div>\r\n            <label className=\"block font-medium mb-1\">Nombre *</label>\r\n            <input\r\n              type=\"text\"\r\n              value={formData.nombre}\r\n              onChange={(e) => setFormData({ ...formData, nombre: e.target.value })}\r\n              className=\"w-full border p-2 rounded\"\r\n            />\r\n          </div>\r\n          <div>\r\n            <label className=\"block font-medium mb-1\">Origen *</label>\r\n            <select\r\n              value={formData.origen}\r\n              onChange={(e) => setFormData({ ...formData, origen: e.target.value })}\r\n              className=\"w-full border p-2 rounded\"\r\n            >\r\n              <option value=\"\">Seleccionar</option>\r\n              {Object.keys(metadata).map((table) => (\r\n                <option key={table} value={table}>{table}</option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n          <div>\r\n            <label className=\"block font-medium mb-1\">Descripción</label>\r\n            <textarea\r\n              value={formData.descripcion}\r\n              onChange={(e) => setFormData({ ...formData, descripcion: e.target.value })}\r\n              className=\"w-full border p-2 rounded\"\r\n              rows={3}\r\n            />\r\n          </div>\r\n        </div>\r\n        <div className=\"flex justify-end gap-2 mt-6\">\r\n          <button onClick={onClose} className=\"px-4 py-2 bg-gray-300 rounded\" type=\"button\">\r\n            Cancelar\r\n          </button>\r\n          <button\r\n            onClick={handleSave}\r\n            className=\"px-4 py-2 bg-blue-600 text-white rounded flex items-center gap-2\"\r\n            type=\"button\"\r\n          >\r\n            <Save className=\"w-4 h-4\" /> Crear\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Componente para exportación\r\nconst ExportButtons = ({ data, onExport, loading }) => {\r\n  const [showMenu, setShowMenu] = useState(false);\r\n  \r\n  const formats = [\r\n    { key: 'excel', label: 'Excel (.xlsx)', icon: '📊' },\r\n    { key: 'csv', label: 'CSV (.csv)', icon: '📄' },\r\n    { key: 'pdf', label: 'PDF (.pdf)', icon: '📋' },\r\n    { key: 'json', label: 'JSON (.json)', icon: '🔧' }\r\n  ];\r\n\r\n  return (\r\n    <div className=\"relative\">\r\n      <button\r\n        onClick={() => setShowMenu(!showMenu)}\r\n        disabled={data.length === 0 || loading}\r\n        className=\"bg-green-600 text-white px-4 py-2 rounded flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n        type=\"button\"\r\n      >\r\n        <Download className=\"w-4 h-4\" />\r\n        Exportar\r\n      </button>\r\n\r\n      {showMenu && (\r\n        <div className=\"absolute right-0 mt-2 w-48 bg-white border rounded-lg shadow-lg z-10\">\r\n          <div className=\"py-1\">\r\n            {formats.map((format) => (\r\n              <button\r\n                key={format.key}\r\n                onClick={() => {\r\n                  onExport(format.key);\r\n                  setShowMenu(false);\r\n                }}\r\n                className=\"w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center gap-2\"\r\n                type=\"button\"\r\n              >\r\n                <span>{format.icon}</span>\r\n                <span className=\"text-sm\">{format.label}</span>\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n// Módulo principal de reportes\r\nconst ReportesModule = () => {\r\n  const { user, getStoredToken } = useAuth();\r\n  const [metadata, setMetadata] = useState({});\r\n  const [reportes, setReportes] = useState([]);\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [rows, setRows] = useState([]);\r\n  const [columns, setColumns] = useState([]);\r\n  const [metrics, setMetrics] = useState([]);\r\n  const [sqlQuery, setSqlQuery] = useState(\"\");\r\n  const [customSql, setCustomSql] = useState(\"\");\r\n  const [data, setData] = useState([]);\r\n  const [chartType, setChartType] = useState(\"bar\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [exportLoading, setExportLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  // CARGAR METADATA Y REPORTES GUARDADOS\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const token = getStoredToken();\r\n        if (!token) {\r\n          setError(\"No hay token de autenticación\");\r\n          return;\r\n        }\r\n\r\n        const headers = { \r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        };\r\n\r\n        const [metaRes, repRes] = await Promise.all([\r\n          fetch(`${API_URL}/reportes/metadata`, { headers }),\r\n          fetch(`${API_URL}/reportes/guardados`, { headers })\r\n        ]);\r\n\r\n        if (!metaRes.ok) {\r\n          throw new Error(`Error metadata: ${metaRes.status}`);\r\n        }\r\n        if (!repRes.ok) {\r\n          throw new Error(`Error reportes: ${repRes.status}`);\r\n        }\r\n\r\n        const metaData = await metaRes.json();\r\n        const repData = await repRes.json();\r\n\r\n        setMetadata(metaData.simplified || metaData);\r\n\r\n        if (Array.isArray(repData)) {\r\n          setReportes(repData);\r\n        } else {\r\n          console.warn(\"Respuesta de reportes no es un array:\", repData);\r\n          setReportes([]);\r\n        }\r\n\r\n        setError(null);\r\n      } catch (err) {\r\n        console.error(\"Error cargando datos:\", err);\r\n        setError(err.message);\r\n      }\r\n    };\r\n    fetchData();\r\n  }, [getStoredToken]);\r\n\r\n  // Generar SQL dinámico\r\n  useEffect(() => {\r\n    if (rows.length === 0 && columns.length === 0 && metrics.length === 0) {\r\n      setSqlQuery(\"\");\r\n      return;\r\n    }\r\n    const allFields = [...rows, ...columns, ...metrics];\r\n    const tables = [...new Set(allFields.map((f) => f.table))];\r\n    const selectFields = allFields.map((f) => `${f.table}.${f.name}`).join(\", \");\r\n    let query = `SELECT ${selectFields} FROM ${tables.join(\", \")}`;\r\n    if (rows.length || columns.length) {\r\n      query += ` GROUP BY ${[...rows, ...columns].map((f) => `${f.table}.${f.name}`).join(\", \")}`;\r\n    }\r\n    setSqlQuery(query);\r\n  }, [rows, columns, metrics]);\r\n\r\n  // EJECUTAR REPORTE\r\n  const ejecutarReporte = async () => {\r\n    const query = customSql || sqlQuery;\r\n    if (!query.trim()) {\r\n      alert(\"No hay consulta para ejecutar\");\r\n      return;\r\n    }\r\n    \r\n    setLoading(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      const res = await fetch(`${API_URL}/reportes/custom`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${getStoredToken()}`,\r\n        },\r\n        body: JSON.stringify({ sqlQuery: query }),\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const errorData = await res.json();\r\n        throw new Error(errorData.details || `Error ${res.status}`);\r\n      }\r\n\r\n      const result = await res.json();\r\n      setData(result.data || result);\r\n    } catch (err) {\r\n      console.error(\"Error ejecutando reporte:\", err);\r\n      setError(err.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // EXPORTAR REPORTE\r\n  const exportarReporte = async (formato) => {\r\n    if (data.length === 0) {\r\n      alert(\"No hay datos para exportar\");\r\n      return;\r\n    }\r\n\r\n    setExportLoading(true);\r\n    \r\n    try {\r\n      const res = await fetch(`${API_URL}/reportes/export`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${getStoredToken()}`,\r\n        },\r\n        body: JSON.stringify({\r\n          formato,\r\n          data,\r\n          nombre: `reporte_${new Date().toISOString().split('T')[0]}`\r\n        }),\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const errorData = await res.json();\r\n        throw new Error(errorData.details || `Error ${res.status}`);\r\n      }\r\n\r\n      // Descargar archivo\r\n      const blob = await res.blob();\r\n      const url = window.URL.createObjectURL(blob);\r\n      const link = document.createElement('a');\r\n      link.href = url;\r\n      \r\n      // Determinar extensión del archivo\r\n      const extensions = {\r\n        excel: 'xlsx',\r\n        csv: 'csv', \r\n        pdf: 'pdf',\r\n        json: 'json'\r\n      };\r\n      \r\n      link.download = `reporte_${new Date().toISOString().split('T')[0]}.${extensions[formato]}`;\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      document.body.removeChild(link);\r\n      window.URL.revokeObjectURL(url);\r\n      \r\n      console.log(`Archivo ${formato} descargado exitosamente`);\r\n      \r\n    } catch (err) {\r\n      console.error(\"Error exportando reporte:\", err);\r\n      alert(\"Error al exportar: \" + err.message);\r\n    } finally {\r\n      setExportLoading(false);\r\n    }\r\n  };\r\n\r\n  // GUARDAR REPORTE\r\n  const guardarReporte = async (nuevo) => {\r\n    try {\r\n      const res = await fetch(`${API_URL}/reportes/guardados`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${getStoredToken()}`,\r\n        },\r\n        body: JSON.stringify({\r\n          ...nuevo,\r\n          configuracion: { rows, columns, metrics, sqlQuery: customSql || sqlQuery },\r\n        }),\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const errorData = await res.json();\r\n        throw new Error(errorData.details || `Error ${res.status}`);\r\n      }\r\n\r\n      const saved = await res.json();\r\n      setReportes([...reportes, saved]);\r\n      setShowModal(false);\r\n      alert(\"Reporte guardado exitosamente\");\r\n    } catch (err) {\r\n      console.error(\"Error guardando reporte:\", err);\r\n      alert(\"Error guardando reporte: \" + err.message);\r\n    }\r\n  };\r\n\r\n  // Funciones helper para drag & drop\r\n  const addFieldToArray = (array, setter) => (field) => {\r\n    const exists = array.some(f => f.table === field.table && f.name === field.name);\r\n    if (!exists) {\r\n      setter([...array, field]);\r\n    }\r\n  };\r\n\r\n  const removeFieldFromArray = (array, setter) => (index) => {\r\n    setter(array.filter((_, i) => i !== index));\r\n  };\r\n\r\n  // Renderizar gráfico según tipo\r\n  const renderChart = () => {\r\n    if (data.length === 0) return null;\r\n    const keys = Object.keys(data[0] || {});\r\n    if (keys.length < 2) return null;\r\n    \r\n    switch (chartType) {\r\n      case \"line\":\r\n        return (\r\n          <LineChart data={data} width={600} height={300}>\r\n            <XAxis dataKey={keys[0]} />\r\n            <YAxis />\r\n            <Tooltip />\r\n            <Legend />\r\n            <Line dataKey={keys[1]} stroke=\"#8884d8\" />\r\n          </LineChart>\r\n        );\r\n      case \"pie\":\r\n        return (\r\n          <PieChart width={600} height={300}>\r\n            <Pie data={data} dataKey={keys[1]} nameKey={keys[0]} label />\r\n            <Tooltip />\r\n          </PieChart>\r\n        );\r\n      default:\r\n        return (\r\n          <BarChart data={data} width={600} height={300}>\r\n            <XAxis dataKey={keys[0]} />\r\n            <YAxis />\r\n            <Tooltip />\r\n            <Legend />\r\n            <Bar dataKey={keys[1]} fill=\"#8884d8\" />\r\n          </BarChart>\r\n        );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <DndProvider backend={HTML5Backend}>\r\n      <div className=\"p-6\">\r\n        {/* Header */}\r\n        <div className=\"flex justify-between items-center mb-6\">\r\n          <h1 className=\"text-2xl font-bold flex items-center gap-2\">\r\n            <BarChart3 className=\"w-7 h-7 text-blue-600\" /> Generador de Reportes\r\n          </h1>\r\n          <button\r\n            onClick={() => setShowModal(true)}\r\n            className=\"bg-green-600 text-white px-4 py-2 rounded flex items-center gap-2\"\r\n            type=\"button\"\r\n          >\r\n            <Plus className=\"w-4 h-4\" /> Nuevo Reporte\r\n          </button>\r\n        </div>\r\n\r\n        {/* MOSTRAR ERRORES */}\r\n        {error && (\r\n          <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex items-center justify-between\">\r\n            <span className=\"text-red-700\">{error}</span>\r\n            <button onClick={() => setError(null)} className=\"text-red-500 hover:text-red-700\">×</button>\r\n          </div>\r\n        )}\r\n\r\n        {/* Tabla de reportes guardados */}\r\n        <div className=\"bg-white rounded-lg shadow mb-6\">\r\n          <div className=\"p-4 border-b flex items-center gap-2\">\r\n            <FileText className=\"w-5 h-5 text-gray-600\" /> \r\n            Reportes Guardados ({Array.isArray(reportes) ? reportes.length : 0})\r\n          </div>\r\n          <div className=\"overflow-x-auto\">\r\n            <table className=\"w-full text-sm\">\r\n              <thead className=\"bg-gray-50\">\r\n                <tr>\r\n                  <th className=\"p-2 text-left\">Nombre</th>\r\n                  <th className=\"p-2 text-left\">Origen</th>\r\n                  <th className=\"p-2 text-left\">Descripción</th>\r\n                  <th className=\"p-2 text-left\">Acciones</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {Array.isArray(reportes) && reportes.length > 0 ? (\r\n                  reportes.map((r) => (\r\n                    <tr key={r.id} className=\"hover:bg-gray-50\">\r\n                      <td className=\"p-2\">{r.nombre}</td>\r\n                      <td className=\"p-2\">{r.origen}</td>\r\n                      <td className=\"p-2\">{r.descripcion || \"-\"}</td>\r\n                      <td className=\"p-2 flex gap-1\">\r\n                        <button className=\"text-blue-600 hover:underline\" type=\"button\">Ver</button>\r\n                        <button className=\"text-green-600 hover:underline\" type=\"button\">Editar</button>\r\n                        <button className=\"text-red-600 hover:underline\" type=\"button\">Eliminar</button>\r\n                      </td>\r\n                    </tr>\r\n                  ))\r\n                ) : (\r\n                  <tr>\r\n                    <td colSpan=\"4\" className=\"p-4 text-center text-gray-500\">\r\n                      No hay reportes guardados\r\n                    </td>\r\n                  </tr>\r\n                )}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Editor SQL */}\r\n        <div className=\"bg-white rounded-lg shadow p-4 mb-6\">\r\n          <h3 className=\"font-semibold mb-2 flex items-center gap-2\">\r\n            <Database className=\"w-5 h-5\" /> Editor SQL\r\n          </h3>\r\n          <div className=\"mb-2\">\r\n            <label className=\"block text-sm font-medium mb-1\">SQL Generado automáticamente:</label>\r\n            <textarea\r\n              value={sqlQuery}\r\n              readOnly\r\n              className=\"w-full border p-2 text-sm font-mono bg-gray-50\"\r\n              rows={3}\r\n              placeholder=\"Se genera automáticamente al arrastrar campos...\"\r\n            />\r\n          </div>\r\n          <div className=\"mb-4\">\r\n            <label className=\"block text-sm font-medium mb-1\">SQL Personalizado:</label>\r\n            <textarea\r\n              value={customSql}\r\n              onChange={(e) => setCustomSql(e.target.value)}\r\n              className=\"w-full border p-2 text-sm font-mono\"\r\n              rows={3}\r\n              placeholder=\"O escribe tu consulta personalizada aquí...\"\r\n            />\r\n          </div>\r\n          <div className=\"flex gap-2\">\r\n            <button\r\n              onClick={ejecutarReporte}\r\n              disabled={loading}\r\n              className=\"bg-blue-600 text-white px-4 py-2 rounded flex items-center gap-2 disabled:opacity-50\"\r\n              type=\"button\"\r\n            >\r\n              <Play className=\"w-4 h-4\" /> \r\n              {loading ? \"Ejecutando...\" : \"Ejecutar\"}\r\n            </button>\r\n            \r\n            {/* Botón de exportación */}\r\n            <ExportButtons \r\n              data={data} \r\n              onExport={exportarReporte} \r\n              loading={exportLoading} \r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Campos disponibles y DropZones */}\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n          <div className=\"bg-white rounded-lg shadow p-4\">\r\n            <h3 className=\"font-semibold mb-2 flex items-center gap-2\">\r\n              <GripVertical className=\"w-5 h-5\" /> Campos Disponibles\r\n            </h3>\r\n            <div className=\"max-h-96 overflow-y-auto\">\r\n              {Object.keys(metadata).length === 0 ? (\r\n                <p className=\"text-gray-500 text-sm\">Cargando campos...</p>\r\n              ) : (\r\n                Object.entries(metadata).map(([table, fields]) => (\r\n                  <div key={table} className=\"mb-4\">\r\n                    <h4 className=\"font-medium text-gray-700 mb-2\">{table}</h4>\r\n                    <div className=\"space-y-1\">\r\n                      {Array.isArray(fields) ? fields.map((field) => (\r\n                        <DraggableField key={`${table}-${field}`} table={table} name={field} />\r\n                      )) : null}\r\n                    </div>\r\n                  </div>\r\n                ))\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"lg:col-span-2 space-y-4\">\r\n            <DropZone \r\n              title=\"Filas\" \r\n              fields={rows} \r\n              onDrop={addFieldToArray(rows, setRows)} \r\n              onRemove={removeFieldFromArray(rows, setRows)} \r\n              icon={<Filter className=\"w-4 h-4 text-blue-600\" />} \r\n            />\r\n            <DropZone \r\n              title=\"Columnas\" \r\n              fields={columns} \r\n              onDrop={addFieldToArray(columns, setColumns)} \r\n              onRemove={removeFieldFromArray(columns, setColumns)} \r\n              icon={<BarChart3 className=\"w-4 h-4 text-green-600\" />} \r\n            />\r\n            <DropZone \r\n              title=\"Métricas\" \r\n              fields={metrics} \r\n              onDrop={addFieldToArray(metrics, setMetrics)} \r\n              onRemove={removeFieldFromArray(metrics, setMetrics)} \r\n              icon={<Database className=\"w-4 h-4 text-purple-600\" />} \r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Resultados */}\r\n        {data.length > 0 && (\r\n          <div className=\"bg-white rounded-lg shadow p-4 mt-6\">\r\n            <div className=\"flex justify-between items-center mb-4\">\r\n              <h3 className=\"font-semibold\">Resultados ({data.length} registros)</h3>\r\n              <div className=\"flex gap-2 items-center\">\r\n                <select \r\n                  value={chartType} \r\n                  onChange={(e) => setChartType(e.target.value)} \r\n                  className=\"border p-1 rounded text-sm\"\r\n                >\r\n                  <option value=\"bar\">Gráfico de Barras</option>\r\n                  <option value=\"line\">Gráfico de Líneas</option>\r\n                  <option value=\"pie\">Gráfico Circular</option>\r\n                </select>\r\n                \r\n                <ExportButtons \r\n                  data={data} \r\n                  onExport={exportarReporte} \r\n                  loading={exportLoading} \r\n                />\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Gráfico */}\r\n            <div className=\"mb-6\">\r\n              <ResponsiveContainer width=\"100%\" height={300}>\r\n                {renderChart()}\r\n              </ResponsiveContainer>\r\n            </div>\r\n\r\n            {/* Tabla de datos */}\r\n            <div className=\"overflow-x-auto\">\r\n              <table className=\"w-full text-sm border\">\r\n                <thead className=\"bg-gray-50\">\r\n                  <tr>\r\n                    {Object.keys(data[0] || {}).map((key) => (\r\n                      <th key={key} className=\"border p-2 text-left font-medium\">{key}</th>\r\n                    ))}\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {data.slice(0, 50).map((row, index) => (\r\n                    <tr key={index} className=\"hover:bg-gray-50\">\r\n                      {Object.values(row).map((value, cellIndex) => (\r\n                        <td key={cellIndex} className=\"border p-2\">\r\n                          {value}\r\n                        </td>\r\n                      ))}\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n              {data.length > 50 && (\r\n                <p className=\"text-sm text-gray-500 mt-2 text-center\">\r\n                  Mostrando primeros 50 de {data.length} registros\r\n                </p>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Modal */}\r\n        <NuevoReporteModal \r\n          show={showModal} \r\n          onClose={() => setShowModal(false)} \r\n          onSave={guardarReporte} \r\n          metadata={metadata} \r\n        />\r\n      </div>\r\n    </DndProvider>\r\n  );\r\n};\r\n\r\nexport default ReportesModule;\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}