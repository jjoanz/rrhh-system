{"ast":null,"code":"// src/components/modules/Reportes/ReportesModule.jsx\nimport React,{useState,useEffect,useMemo}from\"react\";import axios from\"axios\";import{DndProvider,useDrag,useDrop}from\"react-dnd\";import{HTML5Backend}from\"react-dnd-html5-backend\";import{BarChart,Bar,XAxis,YAxis,Tooltip,Legend,ResponsiveContainer}from\"recharts\";import{useAuth}from\"../../../context/AuthContext\";// ------------------ CONFIG ------------------\nimport{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL||\"http://192.168.0.239:5000/api\";const apiClient=axios.create({baseURL:API_URL,timeout:10000});const setupAxiosInterceptors=(getStoredToken,logout)=>{apiClient.interceptors.request.use(config=>{const token=getStoredToken===null||getStoredToken===void 0?void 0:getStoredToken();if(token)config.headers.Authorization=`Bearer ${token}`;return config;});apiClient.interceptors.response.use(res=>res,err=>{var _err$response;if(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status)===401)logout===null||logout===void 0?void 0:logout();return Promise.reject(err);});};// ------------------ DRAG & DROP ------------------\nconst DraggableCard=_ref=>{let{name,table}=_ref;const[{isDragging},drag]=useDrag(()=>({type:\"FIELD\",item:{name,table},collect:monitor=>({isDragging:!!monitor.isDragging()})}));return/*#__PURE__*/_jsxs(\"div\",{ref:drag,className:`p-2 m-1 border rounded shadow cursor-move bg-white text-sm ${isDragging?\"opacity-50\":\"opacity-100\"}`,children:[table,\".\",name]});};const DropZoneCards=_ref2=>{let{title,fields,onDrop}=_ref2;const[{isOver},drop]=useDrop(()=>({accept:\"FIELD\",drop:item=>onDrop(item),collect:monitor=>({isOver:!!monitor.isOver()})}));return/*#__PURE__*/_jsxs(\"div\",{ref:drop,className:`min-h-[80px] p-2 rounded border mb-4 ${isOver?\"bg-green-100\":\"bg-gray-50\"}`,children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold mb-2\",children:title}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap\",children:fields.map((f,i)=>/*#__PURE__*/_jsxs(\"span\",{className:\"px-2 py-1 m-1 bg-blue-200 rounded\",children:[f.table,\".\",f.name]},i))})]});};// ------------------ MODAL NUEVO REPORTE ------------------\nconst NuevoReporteModal=_ref3=>{let{show,onClose,onGuardar,metadata}=_ref3;const[nombre,setNombre]=useState(\"\");const[origen,setOrigen]=useState(\"\");const[predeterminado,setPredeterminado]=useState(false);const[eliminarDuplicados,setEliminarDuplicados]=useState(false);if(!show)return null;const fuentes=Object.keys(metadata);return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-start pt-20 z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded shadow w-96\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold mb-4\",children:\"Nuevo Reporte\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-semibold mb-1\",children:\"Nombre\"}),/*#__PURE__*/_jsx(\"input\",{value:nombre,onChange:e=>setNombre(e.target.value),className:\"w-full border p-2 rounded\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-semibold mb-1\",children:\"Origen del informe\"}),/*#__PURE__*/_jsxs(\"select\",{value:origen,onChange:e=>setOrigen(e.target.value),className:\"w-full border p-2 rounded\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Seleccionar\"}),fuentes.map(f=>/*#__PURE__*/_jsx(\"option\",{value:f,children:f},f))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:predeterminado,onChange:()=>setPredeterminado(!predeterminado)}),\" Incluir configuraci\\xF3n predeterminada\"]}),/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2 mt-1\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:eliminarDuplicados,onChange:()=>setEliminarDuplicados(!eliminarDuplicados)}),\" Eliminar filas duplicadas\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-2 mt-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"px-4 py-1 bg-gray-300 rounded\",children:\"Cancelar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>onGuardar({nombre,origen,predeterminado,eliminarDuplicados}),className:\"px-4 py-1 bg-blue-500 text-white rounded\",children:\"Guardar\"})]})]})});};// ------------------ MODULO PRINCIPAL ------------------\nconst ReportesModule=()=>{const{user,getStoredToken,logout}=useAuth();const[metadata,setMetadata]=useState({});const[rows,setRows]=useState([]);const[cols,setCols]=useState([]);const[metrics,setMetrics]=useState([]);const[data,setData]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState(null);const[reportesGuardados,setReportesGuardados]=useState([]);const[showNuevoModal,setShowNuevoModal]=useState(false);const[sqlQuery,setSqlQuery]=useState(\"\");useEffect(()=>setupAxiosInterceptors(getStoredToken,logout),[getStoredToken,logout]);useEffect(()=>{if(!user)return;const loadData=async()=>{try{setLoading(true);const resMeta=await apiClient.get(\"/reportes/metadata\");setMetadata(resMeta.data);const resReportes=await apiClient.get(\"/reportes/guardados\");setReportesGuardados(resReportes.data);}catch(err){var _err$response2,_err$response2$data;setError(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.message)||\"Error cargando datos\");}finally{setLoading(false);}};loadData();},[user]);const addUnique=(arr,item)=>!arr.find(f=>f.table===item.table&&f.name===item.name)?[...arr,item]:arr;const generarSQL=()=>{if(!rows.length||!metrics.length)return\"\";const tablas=Array.from(new Set([...rows,...cols,...metrics].map(f=>f.table)));const select=[...rows,...cols,...metrics].map(f=>`${f.table}.${f.name}`);return`SELECT ${select.join(\", \")} FROM ${tablas.join(\", \")} /* relaciones automáticas */`;};const ejecutarReporte=async()=>{const query=generarSQL();if(!query)return setError(\"Selecciona al menos una fila y una métrica\");try{setLoading(true);const res=await apiClient.post(\"/reportes/custom\",{sqlQuery:query});setData(res.data);}catch{setError(\"Error al ejecutar reporte dinámico\");}finally{setLoading(false);}};const guardarReporte=async nuevo=>{if(!nuevo.nombre||!nuevo.origen)return setError(\"Nombre y origen son requeridos\");try{setLoading(true);const res=await apiClient.post(\"/reportes/guardados\",nuevo);setReportesGuardados([...reportesGuardados,res.data]);setShowNuevoModal(false);}catch{setError(\"Error guardando reporte\");}finally{setLoading(false);}};const exportar=async formato=>{try{setLoading(true);const res=await apiClient.post(\"/reportes/export\",{formato,data},{responseType:\"blob\"});const url=window.URL.createObjectURL(new Blob([res.data]));const link=document.createElement(\"a\");link.href=url;link.download=`reporte.${formato}`;document.body.appendChild(link);link.click();document.body.removeChild(link);window.URL.revokeObjectURL(url);}catch{setError(\"Error exportando el reporte\");}finally{setLoading(false);}};const memoMetadata=useMemo(()=>Object.entries(metadata),[metadata]);return/*#__PURE__*/_jsx(DndProvider,{backend:HTML5Backend,children:/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold mb-4\",children:\"Reportes Visuales\"}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded\",children:[error,\" \",/*#__PURE__*/_jsx(\"button\",{onClick:()=>setError(null),children:\"\\xD7\"})]}),loading&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 bg-blue-100 border border-blue-400 text-blue-700 rounded\",children:\"Cargando...\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6 flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold\",children:\"Reportes Guardados\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowNuevoModal(true),className:\"px-4 py-1 bg-green-500 text-white rounded\",children:\"Nuevo Reporte\"})]}),/*#__PURE__*/_jsxs(\"table\",{className:\"table-auto border-collapse border border-gray-400 w-full mb-6\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-200\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"border px-2 py-1\",children:\"Nombre\"}),/*#__PURE__*/_jsx(\"th\",{className:\"border px-2 py-1\",children:\"Origen\"}),/*#__PURE__*/_jsx(\"th\",{className:\"border px-2 py-1\",children:\"Creaci\\xF3n\"}),/*#__PURE__*/_jsx(\"th\",{className:\"border px-2 py-1\",children:\"Modificaci\\xF3n\"}),/*#__PURE__*/_jsx(\"th\",{className:\"border px-2 py-1\",children:\"Modificado por\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:reportesGuardados.map((r,i)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"border px-2 py-1\",children:r.nombre}),/*#__PURE__*/_jsx(\"td\",{className:\"border px-2 py-1\",children:r.origen}),/*#__PURE__*/_jsx(\"td\",{className:\"border px-2 py-1\",children:r.fechaCreacion}),/*#__PURE__*/_jsx(\"td\",{className:\"border px-2 py-1\",children:r.fechaModificacion}),/*#__PURE__*/_jsx(\"td\",{className:\"border px-2 py-1\",children:r.modificadoPor})]},i))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-4\",children:[/*#__PURE__*/_jsx(\"textarea\",{rows:16,className:\"border w-1/3 p-2 h-[400px] resize-none\",placeholder:\"SQL generado autom\\xE1ticamente...\",value:generarSQL(),readOnly:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 grid grid-cols-1 gap-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"border p-2 rounded h-[400px] overflow-auto\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold mb-2\",children:\"Campos disponibles\"}),memoMetadata.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Cargando...\"}):memoMetadata.map(_ref4=>{let[table,fields]=_ref4;return/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-bold\",children:table}),fields.map(f=>/*#__PURE__*/_jsx(DraggableCard,{table:table,name:f},f))]},table);})]}),/*#__PURE__*/_jsx(DropZoneCards,{title:\"Filas\",fields:rows,onDrop:item=>setRows(addUnique(rows,item))}),/*#__PURE__*/_jsx(DropZoneCards,{title:\"Columnas\",fields:cols,onDrop:item=>setCols(addUnique(cols,item))}),/*#__PURE__*/_jsx(DropZoneCards,{title:\"M\\xE9tricas\",fields:metrics,onDrop:item=>setMetrics(addUnique(metrics,item))}),/*#__PURE__*/_jsx(\"button\",{onClick:ejecutarReporte,className:\"px-4 py-2 bg-blue-600 text-white rounded\",children:\"Generar Reporte\"})]})]}),data.length>0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>exportar(\"csv\"),className:\"px-4 py-1 bg-gray-600 text-white rounded\",children:\"CSV\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>exportar(\"excel\"),className:\"px-4 py-1 bg-yellow-600 text-white rounded\",children:\"Excel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>exportar(\"pdf\"),className:\"px-4 py-1 bg-red-600 text-white rounded\",children:\"PDF\"})]}),/*#__PURE__*/_jsxs(\"table\",{className:\"table-auto border-collapse border border-gray-400 w-full mb-6\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsx(\"tr\",{children:Object.keys(data[0]).map(k=>/*#__PURE__*/_jsx(\"th\",{className:\"border px-2 py-1\",children:k},k))})}),/*#__PURE__*/_jsx(\"tbody\",{children:data.map((r,i)=>/*#__PURE__*/_jsx(\"tr\",{children:Object.values(r).map((v,j)=>/*#__PURE__*/_jsx(\"td\",{className:\"border px-2 py-1\",children:v},j))},i))})]}),/*#__PURE__*/_jsx(\"div\",{style:{width:\"100%\",height:400},children:/*#__PURE__*/_jsx(ResponsiveContainer,{children:/*#__PURE__*/_jsxs(BarChart,{data:data,children:[/*#__PURE__*/_jsx(XAxis,{dataKey:Object.keys(data[0])[0]}),/*#__PURE__*/_jsx(YAxis,{}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Legend,{}),/*#__PURE__*/_jsx(Bar,{dataKey:Object.keys(data[0])[1],fill:\"#8884d8\"})]})})})]}),/*#__PURE__*/_jsx(NuevoReporteModal,{show:showNuevoModal,onClose:()=>setShowNuevoModal(false),onGuardar:guardarReporte,metadata:metadata})]})});};export default ReportesModule;","map":{"version":3,"names":["React","useState","useEffect","useMemo","axios","DndProvider","useDrag","useDrop","HTML5Backend","BarChart","Bar","XAxis","YAxis","Tooltip","Legend","ResponsiveContainer","useAuth","jsxs","_jsxs","jsx","_jsx","API_URL","process","env","REACT_APP_API_URL","apiClient","create","baseURL","timeout","setupAxiosInterceptors","getStoredToken","logout","interceptors","request","use","config","token","headers","Authorization","response","res","err","_err$response","status","Promise","reject","DraggableCard","_ref","name","table","isDragging","drag","type","item","collect","monitor","ref","className","children","DropZoneCards","_ref2","title","fields","onDrop","isOver","drop","accept","map","f","i","NuevoReporteModal","_ref3","show","onClose","onGuardar","metadata","nombre","setNombre","origen","setOrigen","predeterminado","setPredeterminado","eliminarDuplicados","setEliminarDuplicados","fuentes","Object","keys","value","onChange","e","target","checked","onClick","ReportesModule","user","setMetadata","rows","setRows","cols","setCols","metrics","setMetrics","data","setData","loading","setLoading","error","setError","reportesGuardados","setReportesGuardados","showNuevoModal","setShowNuevoModal","sqlQuery","setSqlQuery","loadData","resMeta","get","resReportes","_err$response2","_err$response2$data","message","addUnique","arr","find","generarSQL","length","tablas","Array","from","Set","select","join","ejecutarReporte","query","post","guardarReporte","nuevo","exportar","formato","responseType","url","window","URL","createObjectURL","Blob","link","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","memoMetadata","entries","backend","r","fechaCreacion","fechaModificacion","modificadoPor","placeholder","readOnly","_ref4","k","values","v","j","style","width","height","dataKey","fill"],"sources":["C:/Users/josemontedeoca/rrhh-system/frontend/src/components/modules/Reportes/ReportesModule.jsx"],"sourcesContent":["// src/components/modules/Reportes/ReportesModule.jsx\r\nimport React, { useState, useEffect, useMemo } from \"react\";\r\nimport axios from \"axios\";\r\nimport { DndProvider, useDrag, useDrop } from \"react-dnd\";\r\nimport { HTML5Backend } from \"react-dnd-html5-backend\";\r\nimport { BarChart, Bar, XAxis, YAxis, Tooltip, Legend, ResponsiveContainer } from \"recharts\";\r\nimport { useAuth } from \"../../../context/AuthContext\";\r\n\r\n// ------------------ CONFIG ------------------\r\nconst API_URL = process.env.REACT_APP_API_URL || \"http://192.168.0.239:5000/api\";\r\nconst apiClient = axios.create({ baseURL: API_URL, timeout: 10000 });\r\nconst setupAxiosInterceptors = (getStoredToken, logout) => {\r\n  apiClient.interceptors.request.use((config) => {\r\n    const token = getStoredToken?.();\r\n    if (token) config.headers.Authorization = `Bearer ${token}`;\r\n    return config;\r\n  });\r\n  apiClient.interceptors.response.use(\r\n    (res) => res,\r\n    (err) => { if (err.response?.status === 401) logout?.(); return Promise.reject(err); }\r\n  );\r\n};\r\n\r\n// ------------------ DRAG & DROP ------------------\r\nconst DraggableCard = ({ name, table }) => {\r\n  const [{ isDragging }, drag] = useDrag(() => ({\r\n    type: \"FIELD\",\r\n    item: { name, table },\r\n    collect: (monitor) => ({ isDragging: !!monitor.isDragging() }),\r\n  }));\r\n  return (\r\n    <div\r\n      ref={drag}\r\n      className={`p-2 m-1 border rounded shadow cursor-move bg-white text-sm ${\r\n        isDragging ? \"opacity-50\" : \"opacity-100\"\r\n      }`}\r\n    >\r\n      {table}.{name}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst DropZoneCards = ({ title, fields, onDrop }) => {\r\n  const [{ isOver }, drop] = useDrop(() => ({\r\n    accept: \"FIELD\",\r\n    drop: (item) => onDrop(item),\r\n    collect: (monitor) => ({ isOver: !!monitor.isOver() }),\r\n  }));\r\n  return (\r\n    <div\r\n      ref={drop}\r\n      className={`min-h-[80px] p-2 rounded border mb-4 ${\r\n        isOver ? \"bg-green-100\" : \"bg-gray-50\"\r\n      }`}\r\n    >\r\n      <h4 className=\"font-semibold mb-2\">{title}</h4>\r\n      <div className=\"flex flex-wrap\">{fields.map((f, i) => (\r\n        <span key={i} className=\"px-2 py-1 m-1 bg-blue-200 rounded\">{f.table}.{f.name}</span>\r\n      ))}</div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// ------------------ MODAL NUEVO REPORTE ------------------\r\nconst NuevoReporteModal = ({ show, onClose, onGuardar, metadata }) => {\r\n  const [nombre, setNombre] = useState(\"\");\r\n  const [origen, setOrigen] = useState(\"\");\r\n  const [predeterminado, setPredeterminado] = useState(false);\r\n  const [eliminarDuplicados, setEliminarDuplicados] = useState(false);\r\n  if (!show) return null;\r\n\r\n  const fuentes = Object.keys(metadata);\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-start pt-20 z-50\">\r\n      <div className=\"bg-white p-6 rounded shadow w-96\">\r\n        <h3 className=\"text-lg font-bold mb-4\">Nuevo Reporte</h3>\r\n        <div className=\"mb-2\">\r\n          <label className=\"block font-semibold mb-1\">Nombre</label>\r\n          <input value={nombre} onChange={(e) => setNombre(e.target.value)} className=\"w-full border p-2 rounded\"/>\r\n        </div>\r\n        <div className=\"mb-2\">\r\n          <label className=\"block font-semibold mb-1\">Origen del informe</label>\r\n          <select value={origen} onChange={(e) => setOrigen(e.target.value)} className=\"w-full border p-2 rounded\">\r\n            <option value=\"\">Seleccionar</option>\r\n            {fuentes.map(f => <option key={f} value={f}>{f}</option>)}\r\n          </select>\r\n        </div>\r\n        <div className=\"mb-2\">\r\n          <label className=\"flex items-center gap-2\">\r\n            <input type=\"checkbox\" checked={predeterminado} onChange={() => setPredeterminado(!predeterminado)}/> Incluir configuración predeterminada\r\n          </label>\r\n          <label className=\"flex items-center gap-2 mt-1\">\r\n            <input type=\"checkbox\" checked={eliminarDuplicados} onChange={() => setEliminarDuplicados(!eliminarDuplicados)}/> Eliminar filas duplicadas\r\n          </label>\r\n        </div>\r\n        <div className=\"flex justify-end gap-2 mt-4\">\r\n          <button onClick={onClose} className=\"px-4 py-1 bg-gray-300 rounded\">Cancelar</button>\r\n          <button onClick={() => onGuardar({ nombre, origen, predeterminado, eliminarDuplicados })} className=\"px-4 py-1 bg-blue-500 text-white rounded\">Guardar</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// ------------------ MODULO PRINCIPAL ------------------\r\nconst ReportesModule = () => {\r\n  const { user, getStoredToken, logout } = useAuth();\r\n  const [metadata, setMetadata] = useState({});\r\n  const [rows, setRows] = useState([]);\r\n  const [cols, setCols] = useState([]);\r\n  const [metrics, setMetrics] = useState([]);\r\n  const [data, setData] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [reportesGuardados, setReportesGuardados] = useState([]);\r\n  const [showNuevoModal, setShowNuevoModal] = useState(false);\r\n  const [sqlQuery, setSqlQuery] = useState(\"\");\r\n\r\n  useEffect(() => setupAxiosInterceptors(getStoredToken, logout), [getStoredToken, logout]);\r\n\r\n  useEffect(() => {\r\n    if (!user) return;\r\n    const loadData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const resMeta = await apiClient.get(\"/reportes/metadata\");\r\n        setMetadata(resMeta.data);\r\n        const resReportes = await apiClient.get(\"/reportes/guardados\");\r\n        setReportesGuardados(resReportes.data);\r\n      } catch (err) {\r\n        setError(err.response?.data?.message || \"Error cargando datos\");\r\n      } finally { setLoading(false); }\r\n    };\r\n    loadData();\r\n  }, [user]);\r\n\r\n  const addUnique = (arr, item) => (!arr.find(f => f.table === item.table && f.name === item.name) ? [...arr, item] : arr);\r\n\r\n  const generarSQL = () => {\r\n    if (!rows.length || !metrics.length) return \"\";\r\n    const tablas = Array.from(new Set([...rows, ...cols, ...metrics].map(f => f.table)));\r\n    const select = [...rows, ...cols, ...metrics].map(f => `${f.table}.${f.name}`);\r\n    return `SELECT ${select.join(\", \")} FROM ${tablas.join(\", \")} /* relaciones automáticas */`;\r\n  };\r\n\r\n  const ejecutarReporte = async () => {\r\n    const query = generarSQL();\r\n    if (!query) return setError(\"Selecciona al menos una fila y una métrica\");\r\n    try {\r\n      setLoading(true);\r\n      const res = await apiClient.post(\"/reportes/custom\", { sqlQuery: query });\r\n      setData(res.data);\r\n    } catch { setError(\"Error al ejecutar reporte dinámico\"); } finally { setLoading(false); }\r\n  };\r\n\r\n  const guardarReporte = async (nuevo) => {\r\n    if (!nuevo.nombre || !nuevo.origen) return setError(\"Nombre y origen son requeridos\");\r\n    try {\r\n      setLoading(true);\r\n      const res = await apiClient.post(\"/reportes/guardados\", nuevo);\r\n      setReportesGuardados([...reportesGuardados, res.data]);\r\n      setShowNuevoModal(false);\r\n    } catch { setError(\"Error guardando reporte\"); } finally { setLoading(false); }\r\n  };\r\n\r\n  const exportar = async (formato) => {\r\n    try {\r\n      setLoading(true);\r\n      const res = await apiClient.post(\"/reportes/export\", { formato, data }, { responseType: \"blob\" });\r\n      const url = window.URL.createObjectURL(new Blob([res.data]));\r\n      const link = document.createElement(\"a\");\r\n      link.href = url;\r\n      link.download = `reporte.${formato}`;\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      document.body.removeChild(link);\r\n      window.URL.revokeObjectURL(url);\r\n    } catch { setError(\"Error exportando el reporte\"); } finally { setLoading(false); }\r\n  };\r\n\r\n  const memoMetadata = useMemo(() => Object.entries(metadata), [metadata]);\r\n\r\n  return (\r\n    <DndProvider backend={HTML5Backend}>\r\n      <div className=\"p-6\">\r\n        <h2 className=\"text-2xl font-bold mb-4\">Reportes Visuales</h2>\r\n\r\n        {error && <div className=\"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded\">{error} <button onClick={() => setError(null)}>×</button></div>}\r\n        {loading && <div className=\"mb-4 p-3 bg-blue-100 border border-blue-400 text-blue-700 rounded\">Cargando...</div>}\r\n\r\n        {/* Lista reportes guardados */}\r\n        <div className=\"mb-6 flex justify-between items-center\">\r\n          <h3 className=\"font-semibold\">Reportes Guardados</h3>\r\n          <button onClick={() => setShowNuevoModal(true)} className=\"px-4 py-1 bg-green-500 text-white rounded\">Nuevo Reporte</button>\r\n        </div>\r\n        <table className=\"table-auto border-collapse border border-gray-400 w-full mb-6\">\r\n          <thead className=\"bg-gray-200\">\r\n            <tr>\r\n              <th className=\"border px-2 py-1\">Nombre</th>\r\n              <th className=\"border px-2 py-1\">Origen</th>\r\n              <th className=\"border px-2 py-1\">Creación</th>\r\n              <th className=\"border px-2 py-1\">Modificación</th>\r\n              <th className=\"border px-2 py-1\">Modificado por</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {reportesGuardados.map((r,i) => (\r\n              <tr key={i}>\r\n                <td className=\"border px-2 py-1\">{r.nombre}</td>\r\n                <td className=\"border px-2 py-1\">{r.origen}</td>\r\n                <td className=\"border px-2 py-1\">{r.fechaCreacion}</td>\r\n                <td className=\"border px-2 py-1\">{r.fechaModificacion}</td>\r\n                <td className=\"border px-2 py-1\">{r.modificadoPor}</td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n\r\n        {/* SQL + Constructor visual */}\r\n        <div className=\"flex gap-4\">\r\n          <textarea\r\n            rows={16}\r\n            className=\"border w-1/3 p-2 h-[400px] resize-none\"\r\n            placeholder=\"SQL generado automáticamente...\"\r\n            value={generarSQL()}\r\n            readOnly\r\n          />\r\n          <div className=\"flex-1 grid grid-cols-1 gap-2\">\r\n            <div className=\"border p-2 rounded h-[400px] overflow-auto\">\r\n              <h4 className=\"font-semibold mb-2\">Campos disponibles</h4>\r\n              {memoMetadata.length === 0 ? <p className=\"text-gray-500\">Cargando...</p>\r\n                : memoMetadata.map(([table, fields]) => (\r\n                  <div key={table} className=\"mb-2\">\r\n                    <h4 className=\"font-bold\">{table}</h4>\r\n                    {fields.map(f => <DraggableCard key={f} table={table} name={f} />)}\r\n                  </div>\r\n                ))\r\n              }\r\n            </div>\r\n\r\n            <DropZoneCards title=\"Filas\" fields={rows} onDrop={(item) => setRows(addUnique(rows,item))} />\r\n            <DropZoneCards title=\"Columnas\" fields={cols} onDrop={(item) => setCols(addUnique(cols,item))} />\r\n            <DropZoneCards title=\"Métricas\" fields={metrics} onDrop={(item) => setMetrics(addUnique(metrics,item))} />\r\n\r\n            <button onClick={ejecutarReporte} className=\"px-4 py-2 bg-blue-600 text-white rounded\">Generar Reporte</button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Resultados */}\r\n        {data.length > 0 && (\r\n          <div>\r\n            <div className=\"mb-4 flex gap-2\">\r\n              <button onClick={() => exportar(\"csv\")} className=\"px-4 py-1 bg-gray-600 text-white rounded\">CSV</button>\r\n              <button onClick={() => exportar(\"excel\")} className=\"px-4 py-1 bg-yellow-600 text-white rounded\">Excel</button>\r\n              <button onClick={() => exportar(\"pdf\")} className=\"px-4 py-1 bg-red-600 text-white rounded\">PDF</button>\r\n            </div>\r\n\r\n            <table className=\"table-auto border-collapse border border-gray-400 w-full mb-6\">\r\n              <thead>\r\n                <tr>{Object.keys(data[0]).map(k => <th key={k} className=\"border px-2 py-1\">{k}</th>)}</tr>\r\n              </thead>\r\n              <tbody>{data.map((r,i) => <tr key={i}>{Object.values(r).map((v,j) => <td key={j} className=\"border px-2 py-1\">{v}</td>)}</tr>)}</tbody>\r\n            </table>\r\n\r\n            <div style={{ width:\"100%\", height:400 }}>\r\n              <ResponsiveContainer>\r\n                <BarChart data={data}>\r\n                  <XAxis dataKey={Object.keys(data[0])[0]} />\r\n                  <YAxis />\r\n                  <Tooltip />\r\n                  <Legend />\r\n                  <Bar dataKey={Object.keys(data[0])[1]} fill=\"#8884d8\" />\r\n                </BarChart>\r\n              </ResponsiveContainer>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <NuevoReporteModal show={showNuevoModal} onClose={() => setShowNuevoModal(false)} onGuardar={guardarReporte} metadata={metadata} />\r\n      </div>\r\n    </DndProvider>\r\n  );\r\n};\r\n\r\nexport default ReportesModule;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}