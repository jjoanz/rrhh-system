{"ast":null,"code":"// src/components/modules/Reportes/ReportesModule.jsx\nimport React,{useState,useEffect,useMemo}from\"react\";import axios from\"axios\";import{DndProvider,useDrag,useDrop}from\"react-dnd\";import{HTML5Backend}from\"react-dnd-html5-backend\";import{BarChart,Bar,XAxis,YAxis,Tooltip,Legend,ResponsiveContainer}from\"recharts\";import{useAuth}from\"../../../context/AuthContext\";// ------------------ CONFIG ------------------\nimport{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL||\"http://192.168.0.239:5000/api\";const apiClient=axios.create({baseURL:API_URL,timeout:10000});const setupAxiosInterceptors=(getStoredToken,logout)=>{apiClient.interceptors.request.use(config=>{const token=getStoredToken===null||getStoredToken===void 0?void 0:getStoredToken();if(token)config.headers.Authorization=`Bearer ${token}`;return config;});apiClient.interceptors.response.use(res=>res,err=>{var _err$response;if(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status)===401)logout===null||logout===void 0?void 0:logout();return Promise.reject(err);});};// ------------------ DRAG & DROP ------------------\nconst DraggableField=_ref=>{let{name,table}=_ref;const[{isDragging},drag]=useDrag(()=>({type:\"FIELD\",item:{name,table},collect:monitor=>({isDragging:!!monitor.isDragging()})}));return/*#__PURE__*/_jsxs(\"div\",{ref:drag,className:\"p-1 m-1 border bg-white shadow rounded cursor-pointer text-sm\",style:{opacity:isDragging?0.5:1},children:[table,\".\",name]});};const DropZone=_ref2=>{let{title,fields,onDrop}=_ref2;const[{isOver},drop]=useDrop(()=>({accept:\"FIELD\",drop:item=>onDrop(item),collect:monitor=>({isOver:!!monitor.isOver()})}));return/*#__PURE__*/_jsxs(\"div\",{ref:drop,className:`p-2 border rounded min-h-[60px] mb-4 ${isOver?\"bg-green-100\":\"bg-gray-50\"}`,children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold mb-2\",children:title}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap\",children:fields.map((f,i)=>/*#__PURE__*/_jsxs(\"span\",{className:\"px-2 py-1 m-1 bg-blue-200 text-xs rounded\",children:[f.table,\".\",f.name]},i))})]});};// ------------------ MODAL NUEVO REPORTE ------------------\nconst NuevoReporteModal=_ref3=>{let{show,onClose,onGuardar,metadata}=_ref3;const[nombre,setNombre]=useState(\"\");const[origen,setOrigen]=useState(\"\");const[predeterminado,setPredeterminado]=useState(false);const[eliminarDuplicados,setEliminarDuplicados]=useState(false);if(!show)return null;const fuentes=Object.keys(metadata);return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-start pt-20 z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded shadow w-96\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold mb-4\",children:\"Nuevo Reporte\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-semibold mb-1\",children:\"Nombre\"}),/*#__PURE__*/_jsx(\"input\",{value:nombre,onChange:e=>setNombre(e.target.value),className:\"w-full border p-2 rounded\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-semibold mb-1\",children:\"Origen del informe\"}),/*#__PURE__*/_jsxs(\"select\",{value:origen,onChange:e=>setOrigen(e.target.value),className:\"w-full border p-2 rounded\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Seleccionar\"}),fuentes.map(f=>/*#__PURE__*/_jsx(\"option\",{value:f,children:f},f))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:predeterminado,onChange:()=>setPredeterminado(!predeterminado)}),\"Incluir configuraci\\xF3n predeterminada\"]}),/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2 mt-1\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:eliminarDuplicados,onChange:()=>setEliminarDuplicados(!eliminarDuplicados)}),\"Eliminar filas duplicadas\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-2 mt-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"px-4 py-1 bg-gray-300 rounded\",children:\"Cancelar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>onGuardar({nombre,origen,predeterminado,eliminarDuplicados}),className:\"px-4 py-1 bg-blue-500 text-white rounded\",children:\"Guardar\"})]})]})});};// ------------------ MODULO PRINCIPAL ------------------\nconst ReportesModule=()=>{const{user,getStoredToken,logout}=useAuth();const[metadata,setMetadata]=useState({});const[rows,setRows]=useState([]);const[cols,setCols]=useState([]);const[metrics,setMetrics]=useState([]);const[data,setData]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState(null);const[reportesGuardados,setReportesGuardados]=useState([]);const[showNuevoModal,setShowNuevoModal]=useState(false);const[sqlQuery,setSqlQuery]=useState(\"\");useEffect(()=>setupAxiosInterceptors(getStoredToken,logout),[getStoredToken,logout]);// Cargar metadata y reportes guardados\nuseEffect(()=>{if(!user)return;const loadData=async()=>{try{setLoading(true);const resMeta=await apiClient.get(\"/reportes/metadata\");setMetadata(resMeta.data);const resReportes=await apiClient.get(\"/reportes/guardados\");setReportesGuardados(resReportes.data);}catch(err){var _err$response2,_err$response2$data;setError(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.message)||\"Error cargando datos\");}finally{setLoading(false);}};loadData();},[user]);const addUnique=(arr,item)=>!arr.find(f=>f.table===item.table&&f.name===item.name)?[...arr,item]:arr;const generarSQL=()=>{if(!rows.length||!metrics.length)return\"\";const tablas=Array.from(new Set([...rows,...cols,...metrics].map(f=>f.table)));const select=[...rows,...cols,...metrics].map(f=>`${f.table}.${f.name}`);return`SELECT ${select.join(\", \")} FROM ${tablas.join(\", \")} /* relaciones automáticas */`;};const ejecutarReporte=async()=>{const query=generarSQL();if(!query)return setError(\"Selecciona al menos una fila y una métrica\");try{setLoading(true);const res=await apiClient.post(\"/reportes/custom\",{sqlQuery:query});setData(res.data);}catch{setError(\"Error al ejecutar reporte dinámico\");}finally{setLoading(false);}};const guardarReporte=async nuevo=>{if(!nuevo.nombre||!nuevo.origen)return setError(\"Nombre y origen son requeridos\");try{setLoading(true);const res=await apiClient.post(\"/reportes/guardados\",nuevo);setReportesGuardados([...reportesGuardados,res.data]);setShowNuevoModal(false);}catch{setError(\"Error guardando reporte\");}finally{setLoading(false);}};const memoMetadata=useMemo(()=>Object.entries(metadata),[metadata]);return/*#__PURE__*/_jsx(DndProvider,{backend:HTML5Backend,children:/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold mb-4\",children:\"Informes Personalizados\"}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded\",children:[error,\" \",/*#__PURE__*/_jsx(\"button\",{onClick:()=>setError(null),children:\"\\xD7\"})]}),loading&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 bg-blue-100 border border-blue-400 text-blue-700 rounded\",children:\"Cargando...\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-2\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold\",children:\"Reportes Guardados\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowNuevoModal(true),className:\"px-4 py-1 bg-green-500 text-white rounded\",children:\"Nuevo Reporte\"})]}),/*#__PURE__*/_jsxs(\"table\",{className:\"table-auto border-collapse border border-gray-400 w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"bg-gray-200\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"border px-2 py-1\",children:\"Nombre\"}),/*#__PURE__*/_jsx(\"th\",{className:\"border px-2 py-1\",children:\"Origen\"}),/*#__PURE__*/_jsx(\"th\",{className:\"border px-2 py-1\",children:\"Creaci\\xF3n\"}),/*#__PURE__*/_jsx(\"th\",{className:\"border px-2 py-1\",children:\"Modificaci\\xF3n\"}),/*#__PURE__*/_jsx(\"th\",{className:\"border px-2 py-1\",children:\"Modificado por\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:reportesGuardados.map((r,i)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"border px-2 py-1\",children:r.nombre}),/*#__PURE__*/_jsx(\"td\",{className:\"border px-2 py-1\",children:r.origen}),/*#__PURE__*/_jsx(\"td\",{className:\"border px-2 py-1\",children:r.fechaCreacion}),/*#__PURE__*/_jsx(\"td\",{className:\"border px-2 py-1\",children:r.fechaModificacion}),/*#__PURE__*/_jsx(\"td\",{className:\"border px-2 py-1\",children:r.modificadoPor})]},i))})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6 flex gap-4\",children:[/*#__PURE__*/_jsx(\"textarea\",{rows:12,className:\"border w-1/3 p-2 h-[400px] resize-none\",placeholder:\"Escribe tu consulta SQL...\",value:sqlQuery,onChange:e=>setSqlQuery(e.target.value)}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 grid grid-cols-1 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"border p-2 rounded h-[400px] overflow-auto\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold mb-2\",children:\"Campos disponibles\"}),memoMetadata.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Cargando...\"}):memoMetadata.map(_ref4=>{let[table,fields]=_ref4;return/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-bold\",children:table}),fields.map(field=>/*#__PURE__*/_jsx(DraggableField,{table:table,name:field},field))]},table);})]}),/*#__PURE__*/_jsx(DropZone,{title:\"Filas\",fields:rows,onDrop:item=>setRows(addUnique(rows,item))}),/*#__PURE__*/_jsx(DropZone,{title:\"Columnas\",fields:cols,onDrop:item=>setCols(addUnique(cols,item))}),/*#__PURE__*/_jsx(DropZone,{title:\"M\\xE9tricas\",fields:metrics,onDrop:item=>setMetrics(addUnique(metrics,item))}),/*#__PURE__*/_jsx(\"button\",{onClick:ejecutarReporte,className:\"px-4 py-2 bg-blue-600 text-white rounded\",children:\"Generar Reporte\"})]})]}),data.length>0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>exportar(\"csv\"),className:\"px-4 py-1 bg-gray-600 text-white rounded\",children:\"CSV\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>exportar(\"excel\"),className:\"px-4 py-1 bg-yellow-600 text-white rounded\",children:\"Excel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>exportar(\"pdf\"),className:\"px-4 py-1 bg-red-600 text-white rounded\",children:\"PDF\"})]}),/*#__PURE__*/_jsxs(\"table\",{className:\"table-auto border-collapse border border-gray-400 w-full mb-6\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsx(\"tr\",{children:Object.keys(data[0]).map(k=>/*#__PURE__*/_jsx(\"th\",{className:\"border px-2 py-1\",children:k},k))})}),/*#__PURE__*/_jsx(\"tbody\",{children:data.map((r,i)=>/*#__PURE__*/_jsx(\"tr\",{children:Object.values(r).map((v,j)=>/*#__PURE__*/_jsx(\"td\",{className:\"border px-2 py-1\",children:v},j))},i))})]}),/*#__PURE__*/_jsx(\"div\",{style:{width:\"100%\",height:400},children:/*#__PURE__*/_jsx(ResponsiveContainer,{children:/*#__PURE__*/_jsxs(BarChart,{data:data,children:[/*#__PURE__*/_jsx(XAxis,{dataKey:Object.keys(data[0])[0]}),/*#__PURE__*/_jsx(YAxis,{}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Legend,{}),/*#__PURE__*/_jsx(Bar,{dataKey:Object.keys(data[0])[1],fill:\"#8884d8\"})]})})})]}),/*#__PURE__*/_jsx(NuevoReporteModal,{show:showNuevoModal,onClose:()=>setShowNuevoModal(false),onGuardar:guardarReporte,metadata:metadata})]})});};export default ReportesModule;","map":{"version":3,"names":["React","useState","useEffect","useMemo","axios","DndProvider","useDrag","useDrop","HTML5Backend","BarChart","Bar","XAxis","YAxis","Tooltip","Legend","ResponsiveContainer","useAuth","jsxs","_jsxs","jsx","_jsx","API_URL","process","env","REACT_APP_API_URL","apiClient","create","baseURL","timeout","setupAxiosInterceptors","getStoredToken","logout","interceptors","request","use","config","token","headers","Authorization","response","res","err","_err$response","status","Promise","reject","DraggableField","_ref","name","table","isDragging","drag","type","item","collect","monitor","ref","className","style","opacity","children","DropZone","_ref2","title","fields","onDrop","isOver","drop","accept","map","f","i","NuevoReporteModal","_ref3","show","onClose","onGuardar","metadata","nombre","setNombre","origen","setOrigen","predeterminado","setPredeterminado","eliminarDuplicados","setEliminarDuplicados","fuentes","Object","keys","value","onChange","e","target","checked","onClick","ReportesModule","user","setMetadata","rows","setRows","cols","setCols","metrics","setMetrics","data","setData","loading","setLoading","error","setError","reportesGuardados","setReportesGuardados","showNuevoModal","setShowNuevoModal","sqlQuery","setSqlQuery","loadData","resMeta","get","resReportes","_err$response2","_err$response2$data","message","addUnique","arr","find","generarSQL","length","tablas","Array","from","Set","select","join","ejecutarReporte","query","post","guardarReporte","nuevo","memoMetadata","entries","backend","r","fechaCreacion","fechaModificacion","modificadoPor","placeholder","_ref4","field","exportar","k","values","v","j","width","height","dataKey","fill"],"sources":["C:/Users/josemontedeoca/rrhh-system/frontend/src/components/modules/Reportes/ReportesModule.jsx"],"sourcesContent":["// src/components/modules/Reportes/ReportesModule.jsx\r\nimport React, { useState, useEffect, useMemo } from \"react\";\r\nimport axios from \"axios\";\r\nimport { DndProvider, useDrag, useDrop } from \"react-dnd\";\r\nimport { HTML5Backend } from \"react-dnd-html5-backend\";\r\nimport { BarChart, Bar, XAxis, YAxis, Tooltip, Legend, ResponsiveContainer } from \"recharts\";\r\nimport { useAuth } from \"../../../context/AuthContext\";\r\n\r\n// ------------------ CONFIG ------------------\r\nconst API_URL = process.env.REACT_APP_API_URL || \"http://192.168.0.239:5000/api\";\r\nconst apiClient = axios.create({ baseURL: API_URL, timeout: 10000 });\r\nconst setupAxiosInterceptors = (getStoredToken, logout) => {\r\n  apiClient.interceptors.request.use((config) => {\r\n    const token = getStoredToken?.();\r\n    if (token) config.headers.Authorization = `Bearer ${token}`;\r\n    return config;\r\n  });\r\n  apiClient.interceptors.response.use(\r\n    (res) => res,\r\n    (err) => { if (err.response?.status === 401) logout?.(); return Promise.reject(err); }\r\n  );\r\n};\r\n\r\n// ------------------ DRAG & DROP ------------------\r\nconst DraggableField = ({ name, table }) => {\r\n  const [{ isDragging }, drag] = useDrag(() => ({\r\n    type: \"FIELD\",\r\n    item: { name, table },\r\n    collect: (monitor) => ({ isDragging: !!monitor.isDragging() }),\r\n  }));\r\n  return (\r\n    <div\r\n      ref={drag}\r\n      className=\"p-1 m-1 border bg-white shadow rounded cursor-pointer text-sm\"\r\n      style={{ opacity: isDragging ? 0.5 : 1 }}\r\n    >\r\n      {table}.{name}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst DropZone = ({ title, fields, onDrop }) => {\r\n  const [{ isOver }, drop] = useDrop(() => ({\r\n    accept: \"FIELD\",\r\n    drop: (item) => onDrop(item),\r\n    collect: (monitor) => ({ isOver: !!monitor.isOver() }),\r\n  }));\r\n  return (\r\n    <div\r\n      ref={drop}\r\n      className={`p-2 border rounded min-h-[60px] mb-4 ${isOver ? \"bg-green-100\" : \"bg-gray-50\"}`}\r\n    >\r\n      <h4 className=\"font-semibold mb-2\">{title}</h4>\r\n      <div className=\"flex flex-wrap\">\r\n        {fields.map((f, i) => (\r\n          <span key={i} className=\"px-2 py-1 m-1 bg-blue-200 text-xs rounded\">{f.table}.{f.name}</span>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// ------------------ MODAL NUEVO REPORTE ------------------\r\nconst NuevoReporteModal = ({ show, onClose, onGuardar, metadata }) => {\r\n  const [nombre, setNombre] = useState(\"\");\r\n  const [origen, setOrigen] = useState(\"\");\r\n  const [predeterminado, setPredeterminado] = useState(false);\r\n  const [eliminarDuplicados, setEliminarDuplicados] = useState(false);\r\n\r\n  if (!show) return null;\r\n\r\n  const fuentes = Object.keys(metadata);\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-start pt-20 z-50\">\r\n      <div className=\"bg-white p-6 rounded shadow w-96\">\r\n        <h3 className=\"text-lg font-bold mb-4\">Nuevo Reporte</h3>\r\n        <div className=\"mb-2\">\r\n          <label className=\"block font-semibold mb-1\">Nombre</label>\r\n          <input value={nombre} onChange={(e) => setNombre(e.target.value)} className=\"w-full border p-2 rounded\" />\r\n        </div>\r\n        <div className=\"mb-2\">\r\n          <label className=\"block font-semibold mb-1\">Origen del informe</label>\r\n          <select value={origen} onChange={(e) => setOrigen(e.target.value)} className=\"w-full border p-2 rounded\">\r\n            <option value=\"\">Seleccionar</option>\r\n            {fuentes.map((f) => <option key={f} value={f}>{f}</option>)}\r\n          </select>\r\n        </div>\r\n        <div className=\"mb-2\">\r\n          <label className=\"flex items-center gap-2\">\r\n            <input type=\"checkbox\" checked={predeterminado} onChange={() => setPredeterminado(!predeterminado)} />\r\n            Incluir configuración predeterminada\r\n          </label>\r\n          <label className=\"flex items-center gap-2 mt-1\">\r\n            <input type=\"checkbox\" checked={eliminarDuplicados} onChange={() => setEliminarDuplicados(!eliminarDuplicados)} />\r\n            Eliminar filas duplicadas\r\n          </label>\r\n        </div>\r\n        <div className=\"flex justify-end gap-2 mt-4\">\r\n          <button onClick={onClose} className=\"px-4 py-1 bg-gray-300 rounded\">Cancelar</button>\r\n          <button onClick={() => onGuardar({ nombre, origen, predeterminado, eliminarDuplicados })} className=\"px-4 py-1 bg-blue-500 text-white rounded\">Guardar</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// ------------------ MODULO PRINCIPAL ------------------\r\nconst ReportesModule = () => {\r\n  const { user, getStoredToken, logout } = useAuth();\r\n  const [metadata, setMetadata] = useState({});\r\n  const [rows, setRows] = useState([]);\r\n  const [cols, setCols] = useState([]);\r\n  const [metrics, setMetrics] = useState([]);\r\n  const [data, setData] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  const [reportesGuardados, setReportesGuardados] = useState([]);\r\n  const [showNuevoModal, setShowNuevoModal] = useState(false);\r\n  const [sqlQuery, setSqlQuery] = useState(\"\");\r\n\r\n  useEffect(() => setupAxiosInterceptors(getStoredToken, logout), [getStoredToken, logout]);\r\n\r\n  // Cargar metadata y reportes guardados\r\n  useEffect(() => {\r\n    if (!user) return;\r\n    const loadData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const resMeta = await apiClient.get(\"/reportes/metadata\");\r\n        setMetadata(resMeta.data);\r\n        const resReportes = await apiClient.get(\"/reportes/guardados\");\r\n        setReportesGuardados(resReportes.data);\r\n      } catch (err) {\r\n        setError(err.response?.data?.message || \"Error cargando datos\");\r\n      } finally { setLoading(false); }\r\n    };\r\n    loadData();\r\n  }, [user]);\r\n\r\n  const addUnique = (arr, item) => (!arr.find((f) => f.table === item.table && f.name === item.name) ? [...arr, item] : arr);\r\n\r\n  const generarSQL = () => {\r\n    if (!rows.length || !metrics.length) return \"\";\r\n    const tablas = Array.from(new Set([...rows, ...cols, ...metrics].map((f) => f.table)));\r\n    const select = [...rows, ...cols, ...metrics].map((f) => `${f.table}.${f.name}`);\r\n    return `SELECT ${select.join(\", \")} FROM ${tablas.join(\", \")} /* relaciones automáticas */`;\r\n  };\r\n\r\n  const ejecutarReporte = async () => {\r\n    const query = generarSQL();\r\n    if (!query) return setError(\"Selecciona al menos una fila y una métrica\");\r\n    try {\r\n      setLoading(true);\r\n      const res = await apiClient.post(\"/reportes/custom\", { sqlQuery: query });\r\n      setData(res.data);\r\n    } catch {\r\n      setError(\"Error al ejecutar reporte dinámico\");\r\n    } finally { setLoading(false); }\r\n  };\r\n\r\n  const guardarReporte = async (nuevo) => {\r\n    if (!nuevo.nombre || !nuevo.origen) return setError(\"Nombre y origen son requeridos\");\r\n    try {\r\n      setLoading(true);\r\n      const res = await apiClient.post(\"/reportes/guardados\", nuevo);\r\n      setReportesGuardados([...reportesGuardados, res.data]);\r\n      setShowNuevoModal(false);\r\n    } catch {\r\n      setError(\"Error guardando reporte\");\r\n    } finally { setLoading(false); }\r\n  };\r\n\r\n  const memoMetadata = useMemo(() => Object.entries(metadata), [metadata]);\r\n\r\n  return (\r\n    <DndProvider backend={HTML5Backend}>\r\n      <div className=\"p-6\">\r\n        <h2 className=\"text-2xl font-bold mb-4\">Informes Personalizados</h2>\r\n\r\n        {error && <div className=\"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded\">{error} <button onClick={() => setError(null)}>×</button></div>}\r\n        {loading && <div className=\"mb-4 p-3 bg-blue-100 border border-blue-400 text-blue-700 rounded\">Cargando...</div>}\r\n\r\n        {/* ------------------ Lista de reportes guardados ------------------ */}\r\n        <div className=\"mb-6\">\r\n          <div className=\"flex justify-between items-center mb-2\">\r\n            <h3 className=\"font-semibold\">Reportes Guardados</h3>\r\n            <button onClick={() => setShowNuevoModal(true)} className=\"px-4 py-1 bg-green-500 text-white rounded\">Nuevo Reporte</button>\r\n          </div>\r\n          <table className=\"table-auto border-collapse border border-gray-400 w-full\">\r\n            <thead>\r\n              <tr className=\"bg-gray-200\">\r\n                <th className=\"border px-2 py-1\">Nombre</th>\r\n                <th className=\"border px-2 py-1\">Origen</th>\r\n                <th className=\"border px-2 py-1\">Creación</th>\r\n                <th className=\"border px-2 py-1\">Modificación</th>\r\n                <th className=\"border px-2 py-1\">Modificado por</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {reportesGuardados.map((r, i) => (\r\n                <tr key={i}>\r\n                  <td className=\"border px-2 py-1\">{r.nombre}</td>\r\n                  <td className=\"border px-2 py-1\">{r.origen}</td>\r\n                  <td className=\"border px-2 py-1\">{r.fechaCreacion}</td>\r\n                  <td className=\"border px-2 py-1\">{r.fechaModificacion}</td>\r\n                  <td className=\"border px-2 py-1\">{r.modificadoPor}</td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n\r\n        {/* ------------------ SQL Editor ------------------ */}\r\n        <div className=\"mb-6 flex gap-4\">\r\n          <textarea\r\n            rows={12}\r\n            className=\"border w-1/3 p-2 h-[400px] resize-none\"\r\n            placeholder=\"Escribe tu consulta SQL...\"\r\n            value={sqlQuery}\r\n            onChange={(e) => setSqlQuery(e.target.value)}\r\n          />\r\n          {/* ------------------ Drag & Drop Constructor ------------------ */}\r\n          <div className=\"flex-1 grid grid-cols-1 gap-4\">\r\n            <div className=\"border p-2 rounded h-[400px] overflow-auto\">\r\n              <h4 className=\"font-semibold mb-2\">Campos disponibles</h4>\r\n              {memoMetadata.length === 0\r\n                ? <p className=\"text-gray-500\">Cargando...</p>\r\n                : memoMetadata.map(([table, fields]) => (\r\n                    <div key={table} className=\"mb-2\">\r\n                      <h4 className=\"font-bold\">{table}</h4>\r\n                      {fields.map((field) => <DraggableField key={field} table={table} name={field} />)}\r\n                    </div>\r\n                  ))}\r\n            </div>\r\n\r\n            <DropZone title=\"Filas\" fields={rows} onDrop={(item) => setRows(addUnique(rows, item))} />\r\n            <DropZone title=\"Columnas\" fields={cols} onDrop={(item) => setCols(addUnique(cols, item))} />\r\n            <DropZone title=\"Métricas\" fields={metrics} onDrop={(item) => setMetrics(addUnique(metrics, item))} />\r\n\r\n            <button onClick={ejecutarReporte} className=\"px-4 py-2 bg-blue-600 text-white rounded\">Generar Reporte</button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* ------------------ Resultados ------------------ */}\r\n        {data.length > 0 && (\r\n          <div>\r\n            <div className=\"mb-4 flex gap-2\">\r\n              <button onClick={() => exportar(\"csv\")} className=\"px-4 py-1 bg-gray-600 text-white rounded\">CSV</button>\r\n              <button onClick={() => exportar(\"excel\")} className=\"px-4 py-1 bg-yellow-600 text-white rounded\">Excel</button>\r\n              <button onClick={() => exportar(\"pdf\")} className=\"px-4 py-1 bg-red-600 text-white rounded\">PDF</button>\r\n            </div>\r\n\r\n            <table className=\"table-auto border-collapse border border-gray-400 w-full mb-6\">\r\n              <thead>\r\n                <tr>{Object.keys(data[0]).map((k) => <th key={k} className=\"border px-2 py-1\">{k}</th>)}</tr>\r\n              </thead>\r\n              <tbody>\r\n                {data.map((r, i) => <tr key={i}>{Object.values(r).map((v, j) => <td key={j} className=\"border px-2 py-1\">{v}</td>)}</tr>)}\r\n              </tbody>\r\n            </table>\r\n\r\n            <div style={{ width: \"100%\", height: 400 }}>\r\n              <ResponsiveContainer>\r\n                <BarChart data={data}>\r\n                  <XAxis dataKey={Object.keys(data[0])[0]} />\r\n                  <YAxis />\r\n                  <Tooltip />\r\n                  <Legend />\r\n                  <Bar dataKey={Object.keys(data[0])[1]} fill=\"#8884d8\" />\r\n                </BarChart>\r\n              </ResponsiveContainer>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Modal Nuevo Reporte */}\r\n        <NuevoReporteModal show={showNuevoModal} onClose={() => setShowNuevoModal(false)} onGuardar={guardarReporte} metadata={metadata} />\r\n      </div>\r\n    </DndProvider>\r\n  );\r\n};\r\n\r\nexport default ReportesModule;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}