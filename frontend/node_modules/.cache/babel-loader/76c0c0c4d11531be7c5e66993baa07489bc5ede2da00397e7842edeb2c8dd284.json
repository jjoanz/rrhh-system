{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{BarChart,Bar,XAxis,YAxis,Tooltip,Legend,ResponsiveContainer,LineChart,Line,PieChart,Pie,Cell,AreaChart,Area}from\"recharts\";import{Play,Save,Plus,Database,Download,FileText,BarChart3,X,Users,Building,Edit3,Trash2,TrendingUp}from\"lucide-react\";import{useAuth}from\"../../../context/AuthContext\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL||\"http://192.168.0.239:5000/api\";// Colores para gráficos\nconst CHART_COLORS=['#3B82F6','#EF4444','#10B981','#F59E0B','#8B5CF6','#EC4899','#14B8A6','#F97316'];// Plantillas predefinidas para RRHH\nconst PLANTILLAS_RRHH=[{id:\"empleados_activos\",nombre:\"Empleados Activos\",descripcion:\"Lista de todos los empleados activos\",sql:\"SELECT e.Nombre, e.Apellido, e.Email, e.Cargo as Puesto, d.Nombre as Departamento FROM Empleados e LEFT JOIN Departamentos d ON e.DepartamentoID = d.DepartamentoID WHERE e.Estado = 1\"},{id:\"empleados_por_departamento\",nombre:\"Empleados por Departamento\",descripcion:\"Cantidad de empleados por departamento\",sql:\"SELECT d.Nombre as Departamento, COUNT(e.EmpleadoID) as Total_Empleados FROM Departamentos d LEFT JOIN Empleados e ON d.DepartamentoID = e.DepartamentoID WHERE e.Estado = 1 GROUP BY d.Nombre ORDER BY Total_Empleados DESC\"},{id:\"contrataciones_recientes\",nombre:\"Contrataciones Recientes\",descripcion:\"Empleados contratados en los últimos 90 días\",sql:\"SELECT e.Nombre, e.Apellido, e.Email, e.Cargo as Puesto, e.FechaIngreso, d.Nombre as Departamento FROM Empleados e LEFT JOIN Departamentos d ON e.DepartamentoID = d.DepartamentoID WHERE e.FechaIngreso >= DATEADD(day, -90, GETDATE()) ORDER BY e.FechaIngreso DESC\"},{id:\"salarios_promedio\",nombre:\"Salarios Promedio por Departamento\",descripcion:\"Salario promedio por departamento\",sql:\"SELECT d.Nombre as Departamento, AVG(CAST(e.Salario AS FLOAT)) as Salario_Promedio, COUNT(e.EmpleadoID) as Cantidad_Empleados FROM Departamentos d LEFT JOIN Empleados e ON d.DepartamentoID = e.DepartamentoID WHERE e.Estado = 1 GROUP BY d.Nombre ORDER BY Salario_Promedio DESC\"},{id:\"Severance\",nombre:\"Reporte Severance\",descripcion:\"Detalle de Preaviso, Cesantía, Vacaciones, Regalía y Total por empleado\",sql:`\n      SELECT \n          ROW_NUMBER() OVER (ORDER BY e.Cedula) AS No,\n          e.Nombre + ' ' + e.Apellido AS [Colaborador (a)],\n          e.Cedula,\n          e.Cargo AS Puesto, \n          FORMAT(e.FechaIngreso, 'dd-MMM-yy', 'es-DO') AS [Fecha de Ingreso],\n          e.Salario,\n          CASE \n              WHEN DATEDIFF(MONTH, e.FechaIngreso, GETDATE()) < 3 THEN 0\n              WHEN DATEDIFF(MONTH, e.FechaIngreso, GETDATE()) < 6 THEN ROUND((e.Salario / 30) * 7, 2)\n              WHEN DATEDIFF(MONTH, e.FechaIngreso, GETDATE()) < 12 THEN ROUND((e.Salario / 30) * 14, 2)\n              ELSE ROUND((e.Salario / 30) * 28, 2)\n          END AS Preaviso,\n          CASE \n              WHEN DATEDIFF(MONTH, e.FechaIngreso, GETDATE()) < 3 THEN 0\n              WHEN DATEDIFF(MONTH, e.FechaIngreso, GETDATE()) BETWEEN 3 AND 5 \n                  THEN ROUND((e.Salario / 30) * 6 * DATEDIFF(YEAR, e.FechaIngreso, GETDATE()), 2)\n              WHEN DATEDIFF(YEAR, e.FechaIngreso, GETDATE()) < 1 \n                  THEN ROUND((e.Salario / 30) * 13, 2)\n              WHEN DATEDIFF(YEAR, e.FechaIngreso, GETDATE()) BETWEEN 1 AND 5 \n                  THEN ROUND((e.Salario / 30) * 21 * DATEDIFF(YEAR, e.FechaIngreso, GETDATE()), 2)\n              ELSE ROUND((e.Salario / 30) * 23 * DATEDIFF(YEAR, e.FechaIngreso, GETDATE()), 2)\n          END AS Cesantia,\n          ROUND((e.Salario / 30) * 14, 2) AS Vacaciones,\n          ROUND(e.Salario * 0.6667, 2) AS Regalia,\n          (\n              CASE \n                  WHEN DATEDIFF(MONTH, e.FechaIngreso, GETDATE()) < 3 THEN 0\n                  WHEN DATEDIFF(MONTH, e.FechaIngreso, GETDATE()) < 6 THEN ROUND((e.Salario / 30) * 7, 2)\n                  WHEN DATEDIFF(MONTH, e.FechaIngreso, GETDATE()) < 12 THEN ROUND((e.Salario / 30) * 14, 2)\n                  ELSE ROUND((e.Salario / 30) * 28, 2)\n              END \n              +\n              CASE \n                  WHEN DATEDIFF(MONTH, e.FechaIngreso, GETDATE()) < 3 THEN 0\n                  WHEN DATEDIFF(MONTH, e.FechaIngreso, GETDATE()) BETWEEN 3 AND 5 \n                      THEN ROUND((e.Salario / 30) * 6 * DATEDIFF(YEAR, e.FechaIngreso, GETDATE()), 2)\n                  WHEN DATEDIFF(YEAR, e.FechaIngreso, GETDATE()) < 1 \n                      THEN ROUND((e.Salario / 30) * 13, 2)\n                  WHEN DATEDIFF(YEAR, e.FechaIngreso, GETDATE()) BETWEEN 1 AND 5 \n                      THEN ROUND((e.Salario / 30) * 21 * DATEDIFF(YEAR, e.FechaIngreso, GETDATE()), 2)\n                  ELSE ROUND((e.Salario / 30) * 23 * DATEDIFF(YEAR, e.FechaIngreso, GETDATE()), 2)\n              END \n              + ROUND((e.Salario / 30) * 14, 2)\n              + ROUND(e.Salario * 0.6667, 2)\n          ) AS Total\n      FROM dbo.Empleados e\n      WHERE e.Estado = 1\n      ORDER BY e.Cedula;\n    `}];// Modal de confirmación para eliminar\nconst ConfirmDeleteModal=_ref=>{let{show,onClose,onConfirm,reporteName}=_ref;if(!show)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg shadow-xl w-96\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(Trash2,{className:\"w-6 h-6 text-red-600\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"Eliminar Reporte\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"Esta acci\\xF3n no se puede deshacer\"})]})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-700 mb-6\",children:[\"\\xBFEst\\xE1s seguro de que deseas eliminar el reporte \",/*#__PURE__*/_jsxs(\"strong\",{children:[\"\\\"\",reporteName,\"\\\"\"]}),\"?\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors\",children:\"Cancelar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onConfirm,className:\"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors\",children:\"Eliminar\"})]})]})});};// Modal para crear/editar reporte\nconst ReporteModal=_ref2=>{let{show,onClose,onSave,editingReport=null}=_ref2;const[formData,setFormData]=React.useState({nombre:\"\",descripcion:\"\",plantilla:\"\",sqlPersonalizado:\"\"});const[usarPlantilla,setUsarPlantilla]=React.useState(true);// Cargar datos del reporte si estamos editando\nuseEffect(()=>{if(editingReport){var _editingReport$config,_editingReport$config2,_editingReport$config3;setFormData({nombre:editingReport.nombre||\"\",descripcion:editingReport.descripcion||\"\",plantilla:((_editingReport$config=editingReport.configuracion)===null||_editingReport$config===void 0?void 0:_editingReport$config.plantillaId)||\"\",sqlPersonalizado:((_editingReport$config2=editingReport.configuracion)===null||_editingReport$config2===void 0?void 0:_editingReport$config2.sqlQuery)||\"\"});setUsarPlantilla(((_editingReport$config3=editingReport.configuracion)===null||_editingReport$config3===void 0?void 0:_editingReport$config3.tipo)===\"plantilla\");}else{resetForm();}},[editingReport]);const handleSave=()=>{if(!formData.nombre.trim()){alert(\"El nombre del reporte es obligatorio\");return;}let sqlFinal=\"\";if(usarPlantilla&&formData.plantilla){const plantilla=PLANTILLAS_RRHH.find(p=>p.id===formData.plantilla);sqlFinal=plantilla?plantilla.sql:\"\";}else{sqlFinal=formData.sqlPersonalizado;}if(!sqlFinal.trim()){alert(\"Debe seleccionar una plantilla o escribir SQL personalizado\");return;}const reporte={id:editingReport===null||editingReport===void 0?void 0:editingReport.id,nombre:formData.nombre.trim(),descripcion:formData.descripcion.trim(),origen:\"personalizado\",configuracion:{tipo:usarPlantilla?\"plantilla\":\"personalizado\",plantillaId:formData.plantilla,sqlQuery:sqlFinal}};onSave(reporte);resetForm();};const resetForm=()=>{setFormData({nombre:\"\",descripcion:\"\",plantilla:\"\",sqlPersonalizado:\"\"});setUsarPlantilla(true);};const handleClose=()=>{resetForm();onClose();};if(!show)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg shadow-xl w-[600px] max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800\",children:editingReport?\"Editar Reporte\":\"Crear Nuevo Reporte\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleClose,className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(X,{className:\"w-6 h-6\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-medium mb-2 text-gray-700\",children:\"Nombre del Reporte *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.nombre,onChange:e=>setFormData(prev=>({...prev,nombre:e.target.value})),className:\"w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\",placeholder:\"Ej: Reporte Mensual de Empleados\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-medium mb-2 text-gray-700\",children:\"Descripci\\xF3n\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.descripcion,onChange:e=>setFormData(prev=>({...prev,descripcion:e.target.value})),className:\"w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\",rows:3,placeholder:\"Describe brevemente este reporte...\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-t pt-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-medium mb-3 text-gray-700\",children:\"Tipo de Reporte\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-4\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",checked:usarPlantilla,onChange:()=>setUsarPlantilla(true),className:\"mr-2\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Usar plantilla predefinida\"})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",checked:!usarPlantilla,onChange:()=>setUsarPlantilla(false),className:\"mr-2\"}),/*#__PURE__*/_jsx(\"span\",{children:\"SQL personalizado\"})]})]})]}),usarPlantilla&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-medium mb-2 text-gray-700\",children:\"Seleccionar Plantilla *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.plantilla,onChange:e=>setFormData(prev=>({...prev,plantilla:e.target.value})),className:\"w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- Seleccione una plantilla --\"}),PLANTILLAS_RRHH.map(plantilla=>/*#__PURE__*/_jsxs(\"option\",{value:plantilla.id,children:[plantilla.nombre,\" - \",plantilla.descripcion]},plantilla.id))]})]}),!usarPlantilla&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-medium mb-2 text-gray-700\",children:\"Consulta SQL *\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.sqlPersonalizado,onChange:e=>setFormData(prev=>({...prev,sqlPersonalizado:e.target.value})),className:\"w-full border border-gray-300 p-3 rounded-lg font-mono text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\",rows:6,placeholder:\"SELECT columna1, columna2 FROM tabla WHERE condicion...\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-3 mt-6 pt-4 border-t\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleClose,className:\"px-6 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors\",children:\"Cancelar\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleSave,className:\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Save,{className:\"w-4 h-4\"}),editingReport?\"Actualizar\":\"Crear\",\" Reporte\"]})]})]})});};// Componente para selector de tipo de gráfico\nconst ChartTypeSelector=_ref3=>{let{currentType,onTypeChange,data}=_ref3;const chartTypes=[{id:'bar',name:'Barras',icon:BarChart3},{id:'line',name:'Líneas',icon:TrendingUp},{id:'pie',name:'Circular',icon:Users},{id:'area',name:'Área',icon:Building}];if(!data||data.length===0||Object.keys(data[0]).length<2){return null;}return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-gray-700\",children:\"Tipo de gr\\xE1fico:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-1\",children:chartTypes.map(type=>{const Icon=type.icon;return/*#__PURE__*/_jsxs(\"button\",{onClick:()=>onTypeChange(type.id),className:`px-3 py-1 rounded-md text-sm font-medium transition-colors flex items-center gap-1 ${currentType===type.id?'bg-blue-100 text-blue-700 border border-blue-300':'bg-gray-100 text-gray-600 hover:bg-gray-200'}`,children:[/*#__PURE__*/_jsx(Icon,{className:\"w-3 h-3\"}),type.name]},type.id);})})]});};// Componente para renderizar gráficos\nconst ChartRenderer=_ref4=>{let{type,data,height=300}=_ref4;if(!data||data.length===0)return null;const keys=Object.keys(data[0]);const xKey=keys[0];const yKey=keys[1];const chartData=data.slice(0,10);// Limitar a 10 elementos para mejor visualización\nconst renderPieChart=()=>/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:height,children:/*#__PURE__*/_jsxs(PieChart,{children:[/*#__PURE__*/_jsx(Pie,{data:chartData,dataKey:yKey,nameKey:xKey,cx:\"50%\",cy:\"50%\",outerRadius:80,label:_ref5=>{let{name,percent}=_ref5;return`${name} (${(percent*100).toFixed(0)}%)`;},children:chartData.map((entry,index)=>/*#__PURE__*/_jsx(Cell,{fill:CHART_COLORS[index%CHART_COLORS.length]},`cell-${index}`))}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Legend,{})]})});switch(type){case'line':return/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:height,children:/*#__PURE__*/_jsxs(LineChart,{data:chartData,children:[/*#__PURE__*/_jsx(XAxis,{dataKey:xKey}),/*#__PURE__*/_jsx(YAxis,{}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Legend,{}),/*#__PURE__*/_jsx(Line,{type:\"monotone\",dataKey:yKey,stroke:\"#3B82F6\",strokeWidth:2})]})});case'pie':return renderPieChart();case'area':return/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:height,children:/*#__PURE__*/_jsxs(AreaChart,{data:chartData,children:[/*#__PURE__*/_jsx(XAxis,{dataKey:xKey}),/*#__PURE__*/_jsx(YAxis,{}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Legend,{}),/*#__PURE__*/_jsx(Area,{type:\"monotone\",dataKey:yKey,stroke:\"#3B82F6\",fill:\"#3B82F6\",fillOpacity:0.6})]})});default:// bar\nreturn/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:height,children:/*#__PURE__*/_jsxs(BarChart,{data:chartData,children:[/*#__PURE__*/_jsx(XAxis,{dataKey:xKey}),/*#__PURE__*/_jsx(YAxis,{}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Legend,{}),/*#__PURE__*/_jsx(Bar,{dataKey:yKey,fill:\"#3B82F6\"})]})});}};// Componente principal\nconst ReportesModule=()=>{const{getStoredToken}=useAuth();// Estados principales\nconst[reportes,setReportes]=useState([]);const[showModal,setShowModal]=useState(false);const[showDeleteModal,setShowDeleteModal]=useState(false);const[editingReport,setEditingReport]=useState(null);const[deletingReport,setDeletingReport]=useState(null);const[sqlQuery,setSqlQuery]=useState(\"\");const[data,setData]=useState([]);const[loading,setLoading]=useState(false);const[exportLoading,setExportLoading]=useState(false);const[error,setError]=useState(null);const[chartType,setChartType]=useState('bar');// Cargar reportes guardados\nuseEffect(()=>{cargarReportes();},[]);const cargarReportes=async()=>{try{const token=getStoredToken();if(!token)return;const response=await fetch(`${API_URL}/reportes/guardados`,{headers:{Authorization:`Bearer ${token}`,'Content-Type':'application/json'}});if(response.ok){const data=await response.json();setReportes(Array.isArray(data)?data:[]);}else if(response.status!==403){console.warn(\"Error cargando reportes:\",response.status);}}catch(err){console.warn(\"Error conectando:\",err.message);}};// Ejecutar consulta\nconst ejecutarConsulta=async function(){let sql=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;const queryToExecute=sql||sqlQuery;if(!queryToExecute.trim()){alert(\"Escriba una consulta SQL o seleccione una plantilla\");return;}setLoading(true);setError(null);try{const response=await fetch(`${API_URL}/reportes/custom`,{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${getStoredToken()}`},body:JSON.stringify({sqlQuery:queryToExecute})});if(response.ok){const result=await response.json();setData(result.data||[]);}else{const errorData=await response.json();throw new Error(errorData.details||`Error ${response.status}`);}}catch(err){setError(err.message);console.error(\"Error ejecutando consulta:\",err);}finally{setLoading(false);}};// Guardar/actualizar reporte\nconst guardarReporte=async reporteData=>{try{const isEdit=!!reporteData.id;const method=isEdit?\"PUT\":\"POST\";const endpoint=isEdit?`${API_URL}/reportes/guardados/${reporteData.id}`:`${API_URL}/reportes/guardados`;const response=await fetch(endpoint,{method,headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${getStoredToken()}`},body:JSON.stringify(reporteData)});if(response.ok){const saved=await response.json();if(isEdit){setReportes(prev=>prev.map(r=>r.id===saved.id?saved:r));alert(\"Reporte actualizado exitosamente\");}else{setReportes(prev=>[...prev,saved]);alert(\"Reporte guardado exitosamente\");}setShowModal(false);setEditingReport(null);}else{const errorData=await response.json();throw new Error(errorData.details||`Error ${response.status}`);}}catch(err){console.error(\"Error guardando reporte:\",err);alert(\"Error guardando reporte: \"+err.message);}};// Eliminar reporte\nconst eliminarReporte=async reporteId=>{try{const response=await fetch(`${API_URL}/reportes/guardados/${reporteId}`,{method:\"DELETE\",headers:{Authorization:`Bearer ${getStoredToken()}`}});if(response.ok){setReportes(prev=>prev.filter(r=>r.id!==reporteId));alert(\"Reporte eliminado exitosamente\");setShowDeleteModal(false);setDeletingReport(null);}else{const errorData=await response.json();throw new Error(errorData.details||`Error ${response.status}`);}}catch(err){console.error(\"Error eliminando reporte:\",err);alert(\"Error eliminando reporte: \"+err.message);}};// Ejecutar plantilla rápida\nconst ejecutarPlantilla=plantillaId=>{const plantilla=PLANTILLAS_RRHH.find(p=>p.id===plantillaId);if(plantilla){setSqlQuery(plantilla.sql);ejecutarConsulta(plantilla.sql);}};// Exportar datos (incluyendo PDF)\nconst exportarDatos=async formato=>{if(data.length===0){alert(\"No hay datos para exportar\");return;}setExportLoading(true);try{const response=await fetch(`${API_URL}/reportes/export`,{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${getStoredToken()}`},body:JSON.stringify({formato,data,nombre:`reporte_rrhh_${new Date().toISOString().split('T')[0]}`})});if(response.ok){const blob=await response.blob();const url=window.URL.createObjectURL(blob);const link=document.createElement('a');link.href=url;const extensions={excel:'xlsx',csv:'csv',pdf:'pdf',json:'json'};link.download=`reporte_rrhh_${new Date().toISOString().split('T')[0]}.${extensions[formato]}`;document.body.appendChild(link);link.click();document.body.removeChild(link);window.URL.revokeObjectURL(url);}else{throw new Error(`Error ${response.status}`);}}catch(err){console.error(\"Error exportando:\",err);alert(\"Error al exportar: \"+err.message);}finally{setExportLoading(false);}};// Cargar reporte guardado\nconst cargarReporte=reporte=>{if(reporte.configuracion&&reporte.configuracion.sqlQuery){setSqlQuery(reporte.configuracion.sqlQuery);ejecutarConsulta(reporte.configuracion.sqlQuery);}};// Manejar edición\nconst handleEditReport=reporte=>{setEditingReport(reporte);setShowModal(true);};// Manejar eliminación\nconst handleDeleteReport=reporte=>{setDeletingReport(reporte);setShowDeleteModal(true);};return/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 max-w-7xl mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"text-3xl font-bold flex items-center gap-3 text-gray-800\",children:[/*#__PURE__*/_jsx(BarChart3,{className:\"w-8 h-8 text-blue-600\"}),\"Reportes RRHH\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mt-2\",children:\"Genera reportes personalizados para recursos humanos\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowModal(true),className:\"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2 shadow-lg\",children:[/*#__PURE__*/_jsx(Plus,{className:\"w-5 h-5\"}),\"Nuevo Reporte\"]})]}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-4 h-4 bg-red-500 rounded-full\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-red-700\",children:error})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setError(null),className:\"text-red-500 hover:text-red-700\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 border-b border-gray-200\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold flex items-center gap-2 text-gray-800\",children:[/*#__PURE__*/_jsx(Users,{className:\"w-5 h-5 text-blue-600\"}),\"Plantillas R\\xE1pidas\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mt-1\",children:\"Reportes predefinidos m\\xE1s utilizados\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-6\",children:/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\",children:PLANTILLAS_RRHH.map(plantilla=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>ejecutarPlantilla(plantilla.id),disabled:loading,className:\"p-4 border-2 border-gray-200 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-all disabled:opacity-50 text-left group\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-2\",children:[/*#__PURE__*/_jsx(Building,{className:\"w-4 h-4 text-blue-600 group-hover:text-blue-700\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-gray-800 group-hover:text-blue-700\",children:plantilla.nombre})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 group-hover:text-gray-700\",children:plantilla.descripcion})]},plantilla.id))})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 border-b border-gray-200\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold flex items-center gap-2 text-gray-800\",children:[/*#__PURE__*/_jsx(Database,{className:\"w-5 h-5 text-green-600\"}),\"Editor de Consultas\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mt-1\",children:\"Escribe tu consulta SQL personalizada\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:sqlQuery,onChange:e=>setSqlQuery(e.target.value),className:\"w-full border border-gray-300 rounded-lg p-4 font-mono text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\",rows:8,placeholder:\"SELECT e.Nombre, e.Apellido, d.Nombre as Departamento \\r\\nFROM Empleados e \\r\\nLEFT JOIN Departamentos d ON e.DepartamentoID = d.DepartamentoID \\r\\nWHERE e.Estado = 1\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mt-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>ejecutarConsulta(),disabled:loading||!sqlQuery.trim(),className:\"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Play,{className:\"w-4 h-4\"}),loading?\"Ejecutando...\":\"Ejecutar Consulta\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSqlQuery(\"\"),className:\"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors\",children:\"Limpiar\"})]}),data.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>exportarDatos('excel'),disabled:exportLoading,className:\"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Download,{className:\"w-4 h-4\"}),\"Excel\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>exportarDatos('csv'),disabled:exportLoading,className:\"bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 disabled:opacity-50 transition-colors flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Download,{className:\"w-4 h-4\"}),\"CSV\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>exportarDatos('pdf'),disabled:exportLoading,className:\"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 disabled:opacity-50 transition-colors flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Download,{className:\"w-4 h-4\"}),\"PDF\"]})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-6 border-b border-gray-200\",children:/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold flex items-center gap-2 text-gray-800\",children:[/*#__PURE__*/_jsx(FileText,{className:\"w-5 h-5 text-purple-600\"}),\"Reportes Guardados (\",reportes.length,\")\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-sm font-medium text-gray-700\",children:\"Nombre\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-sm font-medium text-gray-700\",children:\"Descripci\\xF3n\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-sm font-medium text-gray-700\",children:\"Fecha Creaci\\xF3n\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-sm font-medium text-gray-700\",children:\"Acciones\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y divide-gray-200\",children:reportes.length===0?/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"4\",className:\"px-6 py-8 text-center text-gray-500\",children:\"No hay reportes guardados. Crea tu primer reporte personalizado.\"})}):reportes.map(reporte=>/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50 transition-colors\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 font-medium text-gray-900\",children:reporte.nombre}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-gray-600\",children:reporte.descripcion||\"-\"}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-gray-600\",children:reporte.fechaCreacion?new Date(reporte.fechaCreacion).toLocaleDateString('es-DO'):\"-\"}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>cargarReporte(reporte),className:\"text-blue-600 hover:text-blue-800 hover:underline text-sm font-medium flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Play,{className:\"w-3 h-3\"}),\"Ejecutar\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleEditReport(reporte),className:\"text-green-600 hover:text-green-800 hover:underline text-sm font-medium flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Edit3,{className:\"w-3 h-3\"}),\"Editar\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleDeleteReport(reporte),className:\"text-red-600 hover:text-red-800 hover:underline text-sm font-medium flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Trash2,{className:\"w-3 h-3\"}),\"Eliminar\"]})]})})]},reporte.id))})]})})]}),data.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-6 border-b border-gray-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-gray-800\",children:[\"Resultados (\",data.length,\" registros)\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Consulta ejecutada exitosamente\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsx(ChartTypeSelector,{currentType:chartType,onTypeChange:setChartType,data:data}),data.length>0&&Object.keys(data[0]).length>=2&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsx(ChartRenderer,{type:chartType,data:data,height:300})}),/*#__PURE__*/_jsxs(\"div\",{className:\"overflow-x-auto\",children:[/*#__PURE__*/_jsxs(\"table\",{className:\"w-full border border-gray-200 rounded-lg\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsx(\"tr\",{children:Object.keys(data[0]||{}).map(key=>/*#__PURE__*/_jsx(\"th\",{className:\"border-b border-gray-200 px-4 py-3 text-left font-medium text-sm text-gray-700\",children:key},key))})}),/*#__PURE__*/_jsx(\"tbody\",{children:data.slice(0,100).map((row,index)=>/*#__PURE__*/_jsx(\"tr\",{className:\"hover:bg-gray-50 transition-colors\",children:Object.values(row).map((value,cellIndex)=>/*#__PURE__*/_jsx(\"td\",{className:\"border-b border-gray-100 px-4 py-3 text-sm text-gray-900\",children:typeof value==='number'?value.toLocaleString('es-DO'):value},cellIndex))},index))})]}),data.length>100&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500 mt-3 text-center\",children:[\"Mostrando primeros 100 de \",data.length,\" registros\"]})]})]})]}),/*#__PURE__*/_jsx(ReporteModal,{show:showModal,onClose:()=>{setShowModal(false);setEditingReport(null);},onSave:guardarReporte,editingReport:editingReport}),/*#__PURE__*/_jsx(ConfirmDeleteModal,{show:showDeleteModal,onClose:()=>{setShowDeleteModal(false);setDeletingReport(null);},onConfirm:()=>eliminarReporte(deletingReport===null||deletingReport===void 0?void 0:deletingReport.id),reporteName:deletingReport===null||deletingReport===void 0?void 0:deletingReport.nombre})]});};export default ReportesModule;","map":{"version":3,"names":["React","useState","useEffect","BarChart","Bar","XAxis","YAxis","Tooltip","Legend","ResponsiveContainer","LineChart","Line","PieChart","Pie","Cell","AreaChart","Area","Play","Save","Plus","Database","Download","FileText","BarChart3","X","Users","Building","Edit3","Trash2","TrendingUp","useAuth","jsx","_jsx","jsxs","_jsxs","API_URL","process","env","REACT_APP_API_URL","CHART_COLORS","PLANTILLAS_RRHH","id","nombre","descripcion","sql","ConfirmDeleteModal","_ref","show","onClose","onConfirm","reporteName","className","children","onClick","ReporteModal","_ref2","onSave","editingReport","formData","setFormData","plantilla","sqlPersonalizado","usarPlantilla","setUsarPlantilla","_editingReport$config","_editingReport$config2","_editingReport$config3","configuracion","plantillaId","sqlQuery","tipo","resetForm","handleSave","trim","alert","sqlFinal","find","p","reporte","origen","handleClose","type","value","onChange","e","prev","target","placeholder","rows","checked","map","ChartTypeSelector","_ref3","currentType","onTypeChange","data","chartTypes","name","icon","length","Object","keys","Icon","ChartRenderer","_ref4","height","xKey","yKey","chartData","slice","renderPieChart","width","dataKey","nameKey","cx","cy","outerRadius","label","_ref5","percent","toFixed","entry","index","fill","stroke","strokeWidth","fillOpacity","ReportesModule","getStoredToken","reportes","setReportes","showModal","setShowModal","showDeleteModal","setShowDeleteModal","setEditingReport","deletingReport","setDeletingReport","setSqlQuery","setData","loading","setLoading","exportLoading","setExportLoading","error","setError","chartType","setChartType","cargarReportes","token","response","fetch","headers","Authorization","ok","json","Array","isArray","status","console","warn","err","message","ejecutarConsulta","arguments","undefined","queryToExecute","method","body","JSON","stringify","result","errorData","Error","details","guardarReporte","reporteData","isEdit","endpoint","saved","r","eliminarReporte","reporteId","filter","ejecutarPlantilla","exportarDatos","formato","Date","toISOString","split","blob","url","window","URL","createObjectURL","link","document","createElement","href","extensions","excel","csv","pdf","download","appendChild","click","removeChild","revokeObjectURL","cargarReporte","handleEditReport","handleDeleteReport","disabled","colSpan","fechaCreacion","toLocaleDateString","key","row","values","cellIndex","toLocaleString"],"sources":["C:/Users/josemontedeoca/rrhh-system/frontend/src/components/modules/Reportes/ReportesModule.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { BarChart, Bar, XAxis, YAxis, Tooltip, Legend, ResponsiveContainer, LineChart, Line, PieChart, Pie, Cell, AreaChart, Area } from \"recharts\";\r\nimport { Play, Save, Plus, Database, Download, FileText, BarChart3, X, Users, Building, Edit3, Trash2, TrendingUp } from \"lucide-react\";\r\nimport { useAuth } from \"../../../context/AuthContext\";\r\n\r\nconst API_URL = process.env.REACT_APP_API_URL || \"http://192.168.0.239:5000/api\";\r\n\r\n// Colores para gráficos\r\nconst CHART_COLORS = ['#3B82F6', '#EF4444', '#10B981', '#F59E0B', '#8B5CF6', '#EC4899', '#14B8A6', '#F97316'];\r\n\r\n// Plantillas predefinidas para RRHH\r\nconst PLANTILLAS_RRHH = [\r\n  {\r\n    id: \"empleados_activos\",\r\n    nombre: \"Empleados Activos\",\r\n    descripcion: \"Lista de todos los empleados activos\",\r\n    sql: \"SELECT e.Nombre, e.Apellido, e.Email, e.Cargo as Puesto, d.Nombre as Departamento FROM Empleados e LEFT JOIN Departamentos d ON e.DepartamentoID = d.DepartamentoID WHERE e.Estado = 1\"\r\n  },\r\n  {\r\n    id: \"empleados_por_departamento\", \r\n    nombre: \"Empleados por Departamento\",\r\n    descripcion: \"Cantidad de empleados por departamento\",\r\n    sql: \"SELECT d.Nombre as Departamento, COUNT(e.EmpleadoID) as Total_Empleados FROM Departamentos d LEFT JOIN Empleados e ON d.DepartamentoID = e.DepartamentoID WHERE e.Estado = 1 GROUP BY d.Nombre ORDER BY Total_Empleados DESC\"\r\n  },\r\n  {\r\n    id: \"contrataciones_recientes\",\r\n    nombre: \"Contrataciones Recientes\", \r\n    descripcion: \"Empleados contratados en los últimos 90 días\",\r\n    sql: \"SELECT e.Nombre, e.Apellido, e.Email, e.Cargo as Puesto, e.FechaIngreso, d.Nombre as Departamento FROM Empleados e LEFT JOIN Departamentos d ON e.DepartamentoID = d.DepartamentoID WHERE e.FechaIngreso >= DATEADD(day, -90, GETDATE()) ORDER BY e.FechaIngreso DESC\"\r\n  },\r\n  {\r\n    id: \"salarios_promedio\",\r\n    nombre: \"Salarios Promedio por Departamento\",\r\n    descripcion: \"Salario promedio por departamento\",\r\n    sql: \"SELECT d.Nombre as Departamento, AVG(CAST(e.Salario AS FLOAT)) as Salario_Promedio, COUNT(e.EmpleadoID) as Cantidad_Empleados FROM Departamentos d LEFT JOIN Empleados e ON d.DepartamentoID = e.DepartamentoID WHERE e.Estado = 1 GROUP BY d.Nombre ORDER BY Salario_Promedio DESC\"\r\n  },\r\n  {\r\n    id: \"Severance\",\r\n    nombre: \"Reporte Severance\",\r\n    descripcion: \"Detalle de Preaviso, Cesantía, Vacaciones, Regalía y Total por empleado\",\r\n    sql: `\r\n      SELECT \r\n          ROW_NUMBER() OVER (ORDER BY e.Cedula) AS No,\r\n          e.Nombre + ' ' + e.Apellido AS [Colaborador (a)],\r\n          e.Cedula,\r\n          e.Cargo AS Puesto, \r\n          FORMAT(e.FechaIngreso, 'dd-MMM-yy', 'es-DO') AS [Fecha de Ingreso],\r\n          e.Salario,\r\n          CASE \r\n              WHEN DATEDIFF(MONTH, e.FechaIngreso, GETDATE()) < 3 THEN 0\r\n              WHEN DATEDIFF(MONTH, e.FechaIngreso, GETDATE()) < 6 THEN ROUND((e.Salario / 30) * 7, 2)\r\n              WHEN DATEDIFF(MONTH, e.FechaIngreso, GETDATE()) < 12 THEN ROUND((e.Salario / 30) * 14, 2)\r\n              ELSE ROUND((e.Salario / 30) * 28, 2)\r\n          END AS Preaviso,\r\n          CASE \r\n              WHEN DATEDIFF(MONTH, e.FechaIngreso, GETDATE()) < 3 THEN 0\r\n              WHEN DATEDIFF(MONTH, e.FechaIngreso, GETDATE()) BETWEEN 3 AND 5 \r\n                  THEN ROUND((e.Salario / 30) * 6 * DATEDIFF(YEAR, e.FechaIngreso, GETDATE()), 2)\r\n              WHEN DATEDIFF(YEAR, e.FechaIngreso, GETDATE()) < 1 \r\n                  THEN ROUND((e.Salario / 30) * 13, 2)\r\n              WHEN DATEDIFF(YEAR, e.FechaIngreso, GETDATE()) BETWEEN 1 AND 5 \r\n                  THEN ROUND((e.Salario / 30) * 21 * DATEDIFF(YEAR, e.FechaIngreso, GETDATE()), 2)\r\n              ELSE ROUND((e.Salario / 30) * 23 * DATEDIFF(YEAR, e.FechaIngreso, GETDATE()), 2)\r\n          END AS Cesantia,\r\n          ROUND((e.Salario / 30) * 14, 2) AS Vacaciones,\r\n          ROUND(e.Salario * 0.6667, 2) AS Regalia,\r\n          (\r\n              CASE \r\n                  WHEN DATEDIFF(MONTH, e.FechaIngreso, GETDATE()) < 3 THEN 0\r\n                  WHEN DATEDIFF(MONTH, e.FechaIngreso, GETDATE()) < 6 THEN ROUND((e.Salario / 30) * 7, 2)\r\n                  WHEN DATEDIFF(MONTH, e.FechaIngreso, GETDATE()) < 12 THEN ROUND((e.Salario / 30) * 14, 2)\r\n                  ELSE ROUND((e.Salario / 30) * 28, 2)\r\n              END \r\n              +\r\n              CASE \r\n                  WHEN DATEDIFF(MONTH, e.FechaIngreso, GETDATE()) < 3 THEN 0\r\n                  WHEN DATEDIFF(MONTH, e.FechaIngreso, GETDATE()) BETWEEN 3 AND 5 \r\n                      THEN ROUND((e.Salario / 30) * 6 * DATEDIFF(YEAR, e.FechaIngreso, GETDATE()), 2)\r\n                  WHEN DATEDIFF(YEAR, e.FechaIngreso, GETDATE()) < 1 \r\n                      THEN ROUND((e.Salario / 30) * 13, 2)\r\n                  WHEN DATEDIFF(YEAR, e.FechaIngreso, GETDATE()) BETWEEN 1 AND 5 \r\n                      THEN ROUND((e.Salario / 30) * 21 * DATEDIFF(YEAR, e.FechaIngreso, GETDATE()), 2)\r\n                  ELSE ROUND((e.Salario / 30) * 23 * DATEDIFF(YEAR, e.FechaIngreso, GETDATE()), 2)\r\n              END \r\n              + ROUND((e.Salario / 30) * 14, 2)\r\n              + ROUND(e.Salario * 0.6667, 2)\r\n          ) AS Total\r\n      FROM dbo.Empleados e\r\n      WHERE e.Estado = 1\r\n      ORDER BY e.Cedula;\r\n    `\r\n  }\r\n];\r\n\r\n// Modal de confirmación para eliminar\r\nconst ConfirmDeleteModal = ({ show, onClose, onConfirm, reporteName }) => {\r\n  if (!show) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50\">\r\n      <div className=\"bg-white p-6 rounded-lg shadow-xl w-96\">\r\n        <div className=\"flex items-center gap-3 mb-4\">\r\n          <div className=\"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center\">\r\n            <Trash2 className=\"w-6 h-6 text-red-600\" />\r\n          </div>\r\n          <div>\r\n            <h3 className=\"text-lg font-semibold text-gray-900\">Eliminar Reporte</h3>\r\n            <p className=\"text-sm text-gray-600\">Esta acción no se puede deshacer</p>\r\n          </div>\r\n        </div>\r\n        \r\n        <p className=\"text-gray-700 mb-6\">\r\n          ¿Estás seguro de que deseas eliminar el reporte <strong>\"{reporteName}\"</strong>?\r\n        </p>\r\n        \r\n        <div className=\"flex justify-end gap-3\">\r\n          <button\r\n            onClick={onClose}\r\n            className=\"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors\"\r\n          >\r\n            Cancelar\r\n          </button>\r\n          <button\r\n            onClick={onConfirm}\r\n            className=\"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors\"\r\n          >\r\n            Eliminar\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Modal para crear/editar reporte\r\nconst ReporteModal = ({ show, onClose, onSave, editingReport = null }) => {\r\n  const [formData, setFormData] = React.useState({\r\n    nombre: \"\",\r\n    descripcion: \"\",\r\n    plantilla: \"\",\r\n    sqlPersonalizado: \"\"\r\n  });\r\n\r\n  const [usarPlantilla, setUsarPlantilla] = React.useState(true);\r\n\r\n  // Cargar datos del reporte si estamos editando\r\n  useEffect(() => {\r\n    if (editingReport) {\r\n      setFormData({\r\n        nombre: editingReport.nombre || \"\",\r\n        descripcion: editingReport.descripcion || \"\",\r\n        plantilla: editingReport.configuracion?.plantillaId || \"\",\r\n        sqlPersonalizado: editingReport.configuracion?.sqlQuery || \"\"\r\n      });\r\n      setUsarPlantilla(editingReport.configuracion?.tipo === \"plantilla\");\r\n    } else {\r\n      resetForm();\r\n    }\r\n  }, [editingReport]);\r\n\r\n  const handleSave = () => {\r\n    if (!formData.nombre.trim()) {\r\n      alert(\"El nombre del reporte es obligatorio\");\r\n      return;\r\n    }\r\n\r\n    let sqlFinal = \"\";\r\n    if (usarPlantilla && formData.plantilla) {\r\n      const plantilla = PLANTILLAS_RRHH.find(p => p.id === formData.plantilla);\r\n      sqlFinal = plantilla ? plantilla.sql : \"\";\r\n    } else {\r\n      sqlFinal = formData.sqlPersonalizado;\r\n    }\r\n\r\n    if (!sqlFinal.trim()) {\r\n      alert(\"Debe seleccionar una plantilla o escribir SQL personalizado\");\r\n      return;\r\n    }\r\n\r\n    const reporte = {\r\n      id: editingReport?.id,\r\n      nombre: formData.nombre.trim(),\r\n      descripcion: formData.descripcion.trim(),\r\n      origen: \"personalizado\",\r\n      configuracion: {\r\n        tipo: usarPlantilla ? \"plantilla\" : \"personalizado\",\r\n        plantillaId: formData.plantilla,\r\n        sqlQuery: sqlFinal\r\n      }\r\n    };\r\n\r\n    onSave(reporte);\r\n    resetForm();\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setFormData({\r\n      nombre: \"\",\r\n      descripcion: \"\",\r\n      plantilla: \"\",\r\n      sqlPersonalizado: \"\"\r\n    });\r\n    setUsarPlantilla(true);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    resetForm();\r\n    onClose();\r\n  };\r\n\r\n  if (!show) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50\">\r\n      <div className=\"bg-white p-6 rounded-lg shadow-xl w-[600px] max-h-[90vh] overflow-y-auto\">\r\n        <div className=\"flex justify-between items-center mb-6\">\r\n          <h3 className=\"text-xl font-bold text-gray-800\">\r\n            {editingReport ? \"Editar Reporte\" : \"Crear Nuevo Reporte\"}\r\n          </h3>\r\n          <button onClick={handleClose} className=\"text-gray-500 hover:text-gray-700\">\r\n            <X className=\"w-6 h-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"space-y-4\">\r\n          {/* Información básica */}\r\n          <div>\r\n            <label className=\"block font-medium mb-2 text-gray-700\">Nombre del Reporte *</label>\r\n            <input\r\n              type=\"text\"\r\n              value={formData.nombre}\r\n              onChange={(e) => setFormData(prev => ({ ...prev, nombre: e.target.value }))}\r\n              className=\"w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n              placeholder=\"Ej: Reporte Mensual de Empleados\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block font-medium mb-2 text-gray-700\">Descripción</label>\r\n            <textarea\r\n              value={formData.descripcion}\r\n              onChange={(e) => setFormData(prev => ({ ...prev, descripcion: e.target.value }))}\r\n              className=\"w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n              rows={3}\r\n              placeholder=\"Describe brevemente este reporte...\"\r\n            />\r\n          </div>\r\n\r\n          {/* Selector de tipo */}\r\n          <div className=\"border-t pt-4\">\r\n            <label className=\"block font-medium mb-3 text-gray-700\">Tipo de Reporte</label>\r\n            <div className=\"flex gap-4\">\r\n              <label className=\"flex items-center cursor-pointer\">\r\n                <input\r\n                  type=\"radio\"\r\n                  checked={usarPlantilla}\r\n                  onChange={() => setUsarPlantilla(true)}\r\n                  className=\"mr-2\"\r\n                />\r\n                <span>Usar plantilla predefinida</span>\r\n              </label>\r\n              <label className=\"flex items-center cursor-pointer\">\r\n                <input\r\n                  type=\"radio\"\r\n                  checked={!usarPlantilla}\r\n                  onChange={() => setUsarPlantilla(false)}\r\n                  className=\"mr-2\"\r\n                />\r\n                <span>SQL personalizado</span>\r\n              </label>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Plantillas predefinidas */}\r\n          {usarPlantilla && (\r\n            <div>\r\n              <label className=\"block font-medium mb-2 text-gray-700\">Seleccionar Plantilla *</label>\r\n              <select\r\n                value={formData.plantilla}\r\n                onChange={(e) => setFormData(prev => ({ ...prev, plantilla: e.target.value }))}\r\n                className=\"w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n              >\r\n                <option value=\"\">-- Seleccione una plantilla --</option>\r\n                {PLANTILLAS_RRHH.map(plantilla => (\r\n                  <option key={plantilla.id} value={plantilla.id}>\r\n                    {plantilla.nombre} - {plantilla.descripcion}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n          )}\r\n\r\n          {/* SQL personalizado */}\r\n          {!usarPlantilla && (\r\n            <div>\r\n              <label className=\"block font-medium mb-2 text-gray-700\">Consulta SQL *</label>\r\n              <textarea\r\n                value={formData.sqlPersonalizado}\r\n                onChange={(e) => setFormData(prev => ({ ...prev, sqlPersonalizado: e.target.value }))}\r\n                className=\"w-full border border-gray-300 p-3 rounded-lg font-mono text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n                rows={6}\r\n                placeholder=\"SELECT columna1, columna2 FROM tabla WHERE condicion...\"\r\n              />\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"flex justify-end gap-3 mt-6 pt-4 border-t\">\r\n          <button\r\n            onClick={handleClose}\r\n            className=\"px-6 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors\"\r\n          >\r\n            Cancelar\r\n          </button>\r\n          <button\r\n            onClick={handleSave}\r\n            className=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2\"\r\n          >\r\n            <Save className=\"w-4 h-4\" />\r\n            {editingReport ? \"Actualizar\" : \"Crear\"} Reporte\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Componente para selector de tipo de gráfico\r\nconst ChartTypeSelector = ({ currentType, onTypeChange, data }) => {\r\n  const chartTypes = [\r\n    { id: 'bar', name: 'Barras', icon: BarChart3 },\r\n    { id: 'line', name: 'Líneas', icon: TrendingUp },\r\n    { id: 'pie', name: 'Circular', icon: Users },\r\n    { id: 'area', name: 'Área', icon: Building }\r\n  ];\r\n\r\n  if (!data || data.length === 0 || Object.keys(data[0]).length < 2) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex items-center gap-2 mb-4\">\r\n      <span className=\"text-sm font-medium text-gray-700\">Tipo de gráfico:</span>\r\n      <div className=\"flex gap-1\">\r\n        {chartTypes.map(type => {\r\n          const Icon = type.icon;\r\n          return (\r\n            <button\r\n              key={type.id}\r\n              onClick={() => onTypeChange(type.id)}\r\n              className={`px-3 py-1 rounded-md text-sm font-medium transition-colors flex items-center gap-1 ${\r\n                currentType === type.id \r\n                  ? 'bg-blue-100 text-blue-700 border border-blue-300' \r\n                  : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\r\n              }`}\r\n            >\r\n              <Icon className=\"w-3 h-3\" />\r\n              {type.name}\r\n            </button>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Componente para renderizar gráficos\r\nconst ChartRenderer = ({ type, data, height = 300 }) => {\r\n  if (!data || data.length === 0) return null;\r\n\r\n  const keys = Object.keys(data[0]);\r\n  const xKey = keys[0];\r\n  const yKey = keys[1];\r\n  const chartData = data.slice(0, 10); // Limitar a 10 elementos para mejor visualización\r\n\r\n  const renderPieChart = () => (\r\n    <ResponsiveContainer width=\"100%\" height={height}>\r\n      <PieChart>\r\n        <Pie\r\n          data={chartData}\r\n          dataKey={yKey}\r\n          nameKey={xKey}\r\n          cx=\"50%\"\r\n          cy=\"50%\"\r\n          outerRadius={80}\r\n          label={({name, percent}) => `${name} (${(percent * 100).toFixed(0)}%)`}\r\n        >\r\n          {chartData.map((entry, index) => (\r\n            <Cell key={`cell-${index}`} fill={CHART_COLORS[index % CHART_COLORS.length]} />\r\n          ))}\r\n        </Pie>\r\n        <Tooltip />\r\n        <Legend />\r\n      </PieChart>\r\n    </ResponsiveContainer>\r\n  );\r\n\r\n  switch (type) {\r\n    case 'line':\r\n      return (\r\n        <ResponsiveContainer width=\"100%\" height={height}>\r\n          <LineChart data={chartData}>\r\n            <XAxis dataKey={xKey} />\r\n            <YAxis />\r\n            <Tooltip />\r\n            <Legend />\r\n            <Line type=\"monotone\" dataKey={yKey} stroke=\"#3B82F6\" strokeWidth={2} />\r\n          </LineChart>\r\n        </ResponsiveContainer>\r\n      );\r\n    \r\n    case 'pie':\r\n      return renderPieChart();\r\n    \r\n    case 'area':\r\n      return (\r\n        <ResponsiveContainer width=\"100%\" height={height}>\r\n          <AreaChart data={chartData}>\r\n            <XAxis dataKey={xKey} />\r\n            <YAxis />\r\n            <Tooltip />\r\n            <Legend />\r\n            <Area type=\"monotone\" dataKey={yKey} stroke=\"#3B82F6\" fill=\"#3B82F6\" fillOpacity={0.6} />\r\n          </AreaChart>\r\n        </ResponsiveContainer>\r\n      );\r\n    \r\n    default: // bar\r\n      return (\r\n        <ResponsiveContainer width=\"100%\" height={height}>\r\n          <BarChart data={chartData}>\r\n            <XAxis dataKey={xKey} />\r\n            <YAxis />\r\n            <Tooltip />\r\n            <Legend />\r\n            <Bar dataKey={yKey} fill=\"#3B82F6\" />\r\n          </BarChart>\r\n        </ResponsiveContainer>\r\n      );\r\n  }\r\n};\r\n\r\n// Componente principal\r\nconst ReportesModule = () => {\r\n  const { getStoredToken } = useAuth();\r\n  \r\n  // Estados principales\r\n  const [reportes, setReportes] = useState([]);\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n  const [editingReport, setEditingReport] = useState(null);\r\n  const [deletingReport, setDeletingReport] = useState(null);\r\n  const [sqlQuery, setSqlQuery] = useState(\"\");\r\n  const [data, setData] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [exportLoading, setExportLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [chartType, setChartType] = useState('bar');\r\n\r\n  // Cargar reportes guardados\r\n  useEffect(() => {\r\n    cargarReportes();\r\n  }, []);\r\n\r\n  const cargarReportes = async () => {\r\n    try {\r\n      const token = getStoredToken();\r\n      if (!token) return;\r\n\r\n      const response = await fetch(`${API_URL}/reportes/guardados`, {\r\n        headers: { \r\n          Authorization: `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n      \r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setReportes(Array.isArray(data) ? data : []);\r\n      } else if (response.status !== 403) {\r\n        console.warn(\"Error cargando reportes:\", response.status);\r\n      }\r\n    } catch (err) {\r\n      console.warn(\"Error conectando:\", err.message);\r\n    }\r\n  };\r\n\r\n  // Ejecutar consulta\r\n  const ejecutarConsulta = async (sql = null) => {\r\n    const queryToExecute = sql || sqlQuery;\r\n    \r\n    if (!queryToExecute.trim()) {\r\n      alert(\"Escriba una consulta SQL o seleccione una plantilla\");\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const response = await fetch(`${API_URL}/reportes/custom`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${getStoredToken()}`\r\n        },\r\n        body: JSON.stringify({ sqlQuery: queryToExecute })\r\n      });\r\n\r\n      if (response.ok) {\r\n        const result = await response.json();\r\n        setData(result.data || []);\r\n      } else {\r\n        const errorData = await response.json();\r\n        throw new Error(errorData.details || `Error ${response.status}`);\r\n      }\r\n    } catch (err) {\r\n      setError(err.message);\r\n      console.error(\"Error ejecutando consulta:\", err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Guardar/actualizar reporte\r\n  const guardarReporte = async (reporteData) => {\r\n    try {\r\n      const isEdit = !!reporteData.id;\r\n      const method = isEdit ? \"PUT\" : \"POST\";\r\n      const endpoint = isEdit ? `${API_URL}/reportes/guardados/${reporteData.id}` : `${API_URL}/reportes/guardados`;\r\n\r\n      const response = await fetch(endpoint, {\r\n        method,\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${getStoredToken()}`\r\n        },\r\n        body: JSON.stringify(reporteData)\r\n      });\r\n\r\n      if (response.ok) {\r\n        const saved = await response.json();\r\n        if (isEdit) {\r\n          setReportes(prev => prev.map(r => r.id === saved.id ? saved : r));\r\n          alert(\"Reporte actualizado exitosamente\");\r\n        } else {\r\n          setReportes(prev => [...prev, saved]);\r\n          alert(\"Reporte guardado exitosamente\");\r\n        }\r\n        setShowModal(false);\r\n        setEditingReport(null);\r\n      } else {\r\n        const errorData = await response.json();\r\n        throw new Error(errorData.details || `Error ${response.status}`);\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error guardando reporte:\", err);\r\n      alert(\"Error guardando reporte: \" + err.message);\r\n    }\r\n  };\r\n\r\n  // Eliminar reporte\r\n  const eliminarReporte = async (reporteId) => {\r\n    try {\r\n      const response = await fetch(`${API_URL}/reportes/guardados/${reporteId}`, {\r\n        method: \"DELETE\",\r\n        headers: {\r\n          Authorization: `Bearer ${getStoredToken()}`\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        setReportes(prev => prev.filter(r => r.id !== reporteId));\r\n        alert(\"Reporte eliminado exitosamente\");\r\n        setShowDeleteModal(false);\r\n        setDeletingReport(null);\r\n      } else {\r\n        const errorData = await response.json();\r\n        throw new Error(errorData.details || `Error ${response.status}`);\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error eliminando reporte:\", err);\r\n      alert(\"Error eliminando reporte: \" + err.message);\r\n    }\r\n  };\r\n\r\n  // Ejecutar plantilla rápida\r\n  const ejecutarPlantilla = (plantillaId) => {\r\n    const plantilla = PLANTILLAS_RRHH.find(p => p.id === plantillaId);\r\n    if (plantilla) {\r\n      setSqlQuery(plantilla.sql);\r\n      ejecutarConsulta(plantilla.sql);\r\n    }\r\n  };\r\n\r\n  // Exportar datos (incluyendo PDF)\r\n  const exportarDatos = async (formato) => {\r\n    if (data.length === 0) {\r\n      alert(\"No hay datos para exportar\");\r\n      return;\r\n    }\r\n\r\n    setExportLoading(true);\r\n\r\n    try {\r\n      const response = await fetch(`${API_URL}/reportes/export`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${getStoredToken()}`\r\n        },\r\n        body: JSON.stringify({\r\n          formato,\r\n          data,\r\n          nombre: `reporte_rrhh_${new Date().toISOString().split('T')[0]}`\r\n        })\r\n      });\r\n\r\n      if (response.ok) {\r\n        const blob = await response.blob();\r\n        const url = window.URL.createObjectURL(blob);\r\n        const link = document.createElement('a');\r\n        link.href = url;\r\n        \r\n        const extensions = {\r\n          excel: 'xlsx',\r\n          csv: 'csv',\r\n          pdf: 'pdf',\r\n          json: 'json'\r\n        };\r\n        \r\n        link.download = `reporte_rrhh_${new Date().toISOString().split('T')[0]}.${extensions[formato]}`;\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);\r\n        window.URL.revokeObjectURL(url);\r\n      } else {\r\n        throw new Error(`Error ${response.status}`);\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error exportando:\", err);\r\n      alert(\"Error al exportar: \" + err.message);\r\n    } finally {\r\n      setExportLoading(false);\r\n    }\r\n  };\r\n\r\n  // Cargar reporte guardado\r\n  const cargarReporte = (reporte) => {\r\n    if (reporte.configuracion && reporte.configuracion.sqlQuery) {\r\n      setSqlQuery(reporte.configuracion.sqlQuery);\r\n      ejecutarConsulta(reporte.configuracion.sqlQuery);\r\n    }\r\n  };\r\n\r\n  // Manejar edición\r\n  const handleEditReport = (reporte) => {\r\n    setEditingReport(reporte);\r\n    setShowModal(true);\r\n  };\r\n\r\n  // Manejar eliminación\r\n  const handleDeleteReport = (reporte) => {\r\n    setDeletingReport(reporte);\r\n    setShowDeleteModal(true);\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6 max-w-7xl mx-auto\">\r\n      {/* Header */}\r\n      <div className=\"flex justify-between items-center mb-8\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold flex items-center gap-3 text-gray-800\">\r\n            <BarChart3 className=\"w-8 h-8 text-blue-600\" />\r\n            Reportes RRHH\r\n          </h1>\r\n          <p className=\"text-gray-600 mt-2\">Genera reportes personalizados para recursos humanos</p>\r\n        </div>\r\n        <button\r\n          onClick={() => setShowModal(true)}\r\n          className=\"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2 shadow-lg\"\r\n        >\r\n          <Plus className=\"w-5 h-5\" />\r\n          Nuevo Reporte\r\n        </button>\r\n      </div>\r\n\r\n      {/* Error */}\r\n      {error && (\r\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex justify-between items-center\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <div className=\"w-4 h-4 bg-red-500 rounded-full\"></div>\r\n            <span className=\"text-red-700\">{error}</span>\r\n          </div>\r\n          <button onClick={() => setError(null)} className=\"text-red-500 hover:text-red-700\">\r\n            <X className=\"w-5 h-5\" />\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Plantillas rápidas */}\r\n      <div className=\"bg-white rounded-lg shadow-sm mb-6\">\r\n        <div className=\"p-6 border-b border-gray-200\">\r\n          <h3 className=\"text-lg font-semibold flex items-center gap-2 text-gray-800\">\r\n            <Users className=\"w-5 h-5 text-blue-600\" />\r\n            Plantillas Rápidas\r\n          </h3>\r\n          <p className=\"text-sm text-gray-600 mt-1\">Reportes predefinidos más utilizados</p>\r\n        </div>\r\n        <div className=\"p-6\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n            {PLANTILLAS_RRHH.map(plantilla => (\r\n              <button\r\n                key={plantilla.id}\r\n                onClick={() => ejecutarPlantilla(plantilla.id)}\r\n                disabled={loading}\r\n                className=\"p-4 border-2 border-gray-200 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-all disabled:opacity-50 text-left group\"\r\n              >\r\n                <div className=\"flex items-center gap-2 mb-2\">\r\n                  <Building className=\"w-4 h-4 text-blue-600 group-hover:text-blue-700\" />\r\n                  <h4 className=\"font-medium text-gray-800 group-hover:text-blue-700\">\r\n                    {plantilla.nombre}\r\n                  </h4>\r\n                </div>\r\n                <p className=\"text-sm text-gray-600 group-hover:text-gray-700\">\r\n                  {plantilla.descripcion}\r\n                </p>\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Editor SQL */}\r\n      <div className=\"bg-white rounded-lg shadow-sm mb-6\">\r\n        <div className=\"p-6 border-b border-gray-200\">\r\n          <h3 className=\"text-lg font-semibold flex items-center gap-2 text-gray-800\">\r\n            <Database className=\"w-5 h-5 text-green-600\" />\r\n            Editor de Consultas\r\n          </h3>\r\n          <p className=\"text-sm text-gray-600 mt-1\">Escribe tu consulta SQL personalizada</p>\r\n        </div>\r\n        <div className=\"p-6\">\r\n          <textarea\r\n            value={sqlQuery}\r\n            onChange={(e) => setSqlQuery(e.target.value)}\r\n            className=\"w-full border border-gray-300 rounded-lg p-4 font-mono text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n            rows={8}\r\n            placeholder=\"SELECT e.Nombre, e.Apellido, d.Nombre as Departamento \r\nFROM Empleados e \r\nLEFT JOIN Departamentos d ON e.DepartamentoID = d.DepartamentoID \r\nWHERE e.Estado = 1\"\r\n          />\r\n          \r\n          <div className=\"flex justify-between items-center mt-4\">\r\n            <div className=\"flex gap-2\">\r\n              <button\r\n                onClick={() => ejecutarConsulta()}\r\n                disabled={loading || !sqlQuery.trim()}\r\n                className=\"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors flex items-center gap-2\"\r\n              >\r\n                <Play className=\"w-4 h-4\" />\r\n                {loading ? \"Ejecutando...\" : \"Ejecutar Consulta\"}\r\n              </button>\r\n              \r\n              <button\r\n                onClick={() => setSqlQuery(\"\")}\r\n                className=\"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors\"\r\n              >\r\n                Limpiar\r\n              </button>\r\n            </div>\r\n\r\n            {data.length > 0 && (\r\n              <div className=\"flex gap-2\">\r\n                <button\r\n                  onClick={() => exportarDatos('excel')}\r\n                  disabled={exportLoading}\r\n                  className=\"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors flex items-center gap-1\"\r\n                >\r\n                  <Download className=\"w-4 h-4\" />\r\n                  Excel\r\n                </button>\r\n                <button\r\n                  onClick={() => exportarDatos('csv')}\r\n                  disabled={exportLoading}\r\n                  className=\"bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 disabled:opacity-50 transition-colors flex items-center gap-1\"\r\n                >\r\n                  <Download className=\"w-4 h-4\" />\r\n                  CSV\r\n                </button>\r\n                <button\r\n                  onClick={() => exportarDatos('pdf')}\r\n                  disabled={exportLoading}\r\n                  className=\"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 disabled:opacity-50 transition-colors flex items-center gap-1\"\r\n                >\r\n                  <Download className=\"w-4 h-4\" />\r\n                  PDF\r\n                </button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Reportes guardados */}\r\n      <div className=\"bg-white rounded-lg shadow-sm mb-6\">\r\n        <div className=\"p-6 border-b border-gray-200\">\r\n          <h3 className=\"text-lg font-semibold flex items-center gap-2 text-gray-800\">\r\n            <FileText className=\"w-5 h-5 text-purple-600\" />\r\n            Reportes Guardados ({reportes.length})\r\n          </h3>\r\n        </div>\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"w-full\">\r\n            <thead className=\"bg-gray-50\">\r\n              <tr>\r\n                <th className=\"px-6 py-4 text-left text-sm font-medium text-gray-700\">Nombre</th>\r\n                <th className=\"px-6 py-4 text-left text-sm font-medium text-gray-700\">Descripción</th>\r\n                <th className=\"px-6 py-4 text-left text-sm font-medium text-gray-700\">Fecha Creación</th>\r\n                <th className=\"px-6 py-4 text-left text-sm font-medium text-gray-700\">Acciones</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody className=\"divide-y divide-gray-200\">\r\n              {reportes.length === 0 ? (\r\n                <tr>\r\n                  <td colSpan=\"4\" className=\"px-6 py-8 text-center text-gray-500\">\r\n                    No hay reportes guardados. Crea tu primer reporte personalizado.\r\n                  </td>\r\n                </tr>\r\n              ) : (\r\n                reportes.map((reporte) => (\r\n                  <tr key={reporte.id} className=\"hover:bg-gray-50 transition-colors\">\r\n                    <td className=\"px-6 py-4 font-medium text-gray-900\">{reporte.nombre}</td>\r\n                    <td className=\"px-6 py-4 text-gray-600\">{reporte.descripcion || \"-\"}</td>\r\n                    <td className=\"px-6 py-4 text-gray-600\">\r\n                      {reporte.fechaCreacion ? new Date(reporte.fechaCreacion).toLocaleDateString('es-DO') : \"-\"}\r\n                    </td>\r\n                    <td className=\"px-6 py-4\">\r\n                      <div className=\"flex gap-3\">\r\n                        <button \r\n                          onClick={() => cargarReporte(reporte)}\r\n                          className=\"text-blue-600 hover:text-blue-800 hover:underline text-sm font-medium flex items-center gap-1\"\r\n                        >\r\n                          <Play className=\"w-3 h-3\" />\r\n                          Ejecutar\r\n                        </button>\r\n                        <button \r\n                          onClick={() => handleEditReport(reporte)}\r\n                          className=\"text-green-600 hover:text-green-800 hover:underline text-sm font-medium flex items-center gap-1\"\r\n                        >\r\n                          <Edit3 className=\"w-3 h-3\" />\r\n                          Editar\r\n                        </button>\r\n                        <button \r\n                          onClick={() => handleDeleteReport(reporte)}\r\n                          className=\"text-red-600 hover:text-red-800 hover:underline text-sm font-medium flex items-center gap-1\"\r\n                        >\r\n                          <Trash2 className=\"w-3 h-3\" />\r\n                          Eliminar\r\n                        </button>\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                ))\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Resultados */}\r\n      {data.length > 0 && (\r\n        <div className=\"bg-white rounded-lg shadow-sm\">\r\n          <div className=\"p-6 border-b border-gray-200\">\r\n            <div className=\"flex justify-between items-center\">\r\n              <h3 className=\"text-lg font-semibold text-gray-800\">\r\n                Resultados ({data.length} registros)\r\n              </h3>\r\n              <div className=\"text-sm text-gray-600\">\r\n                Consulta ejecutada exitosamente\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"p-6\">\r\n            {/* Selector de tipo de gráfico */}\r\n            <ChartTypeSelector \r\n              currentType={chartType}\r\n              onTypeChange={setChartType}\r\n              data={data}\r\n            />\r\n\r\n            {/* Gráfico */}\r\n            {data.length > 0 && Object.keys(data[0]).length >= 2 && (\r\n              <div className=\"mb-6\">\r\n                <ChartRenderer \r\n                  type={chartType}\r\n                  data={data}\r\n                  height={300}\r\n                />\r\n              </div>\r\n            )}\r\n\r\n            {/* Tabla de datos */}\r\n            <div className=\"overflow-x-auto\">\r\n              <table className=\"w-full border border-gray-200 rounded-lg\">\r\n                <thead className=\"bg-gray-50\">\r\n                  <tr>\r\n                    {Object.keys(data[0] || {}).map((key) => (\r\n                      <th key={key} className=\"border-b border-gray-200 px-4 py-3 text-left font-medium text-sm text-gray-700\">\r\n                        {key}\r\n                      </th>\r\n                    ))}\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {data.slice(0, 100).map((row, index) => (\r\n                    <tr key={index} className=\"hover:bg-gray-50 transition-colors\">\r\n                      {Object.values(row).map((value, cellIndex) => (\r\n                        <td key={cellIndex} className=\"border-b border-gray-100 px-4 py-3 text-sm text-gray-900\">\r\n                          {typeof value === 'number' ? value.toLocaleString('es-DO') : value}\r\n                        </td>\r\n                      ))}\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n              {data.length > 100 && (\r\n                <p className=\"text-sm text-gray-500 mt-3 text-center\">\r\n                  Mostrando primeros 100 de {data.length} registros\r\n                </p>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modal para crear/editar */}\r\n      <ReporteModal\r\n        show={showModal}\r\n        onClose={() => {\r\n          setShowModal(false);\r\n          setEditingReport(null);\r\n        }}\r\n        onSave={guardarReporte}\r\n        editingReport={editingReport}\r\n      />\r\n\r\n      {/* Modal de confirmación para eliminar */}\r\n      <ConfirmDeleteModal\r\n        show={showDeleteModal}\r\n        onClose={() => {\r\n          setShowDeleteModal(false);\r\n          setDeletingReport(null);\r\n        }}\r\n        onConfirm={() => eliminarReporte(deletingReport?.id)}\r\n        reporteName={deletingReport?.nombre}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ReportesModule;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}